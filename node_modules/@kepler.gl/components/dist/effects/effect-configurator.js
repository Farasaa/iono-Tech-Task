"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = EffectConfiguratorFactory;
exports.StyledColorSelectorWrapper = exports.PanelLabelWrapper = void 0;

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _taggedTemplateLiteral2 = _interopRequireDefault(require("@babel/runtime/helpers/taggedTemplateLiteral"));

var _react = _interopRequireWildcard(require("react"));

var _styledComponents = _interopRequireDefault(require("styled-components"));

var _reactIntl = require("react-intl");

var _constants = require("@kepler.gl/constants");

var _utils = require("@kepler.gl/utils");

var _rangeSlider = _interopRequireDefault(require("../common/range-slider"));

var _icons = require("../common/icons");

var _effectTimeConfigurator = _interopRequireDefault(require("./effect-time-configurator"));

var _compactColorPicker = _interopRequireDefault(require("./compact-color-picker"));

var _templateObject, _templateObject2, _templateObject3, _templateObject4, _templateObject5, _templateObject6, _templateObject7, _templateObject8, _templateObject9, _templateObject10, _templateObject11, _templateObject12;

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2["default"])(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

var StyledEffectConfigurator = _styledComponents["default"].div.attrs({
  className: 'effect-panel__config'
})(_templateObject || (_templateObject = (0, _taggedTemplateLiteral2["default"])(["\n  position: relative;\n  margin: ", ";\n  padding: ", ";\n"])), function (props) {
  return props.theme.effectConfiguratorMargin;
}, function (props) {
  return props.theme.effectConfiguratorPadding;
});

var PanelLabelWrapper = _styledComponents["default"].div.attrs({
  className: 'side-panel-panel__label-wrapper'
})(_templateObject2 || (_templateObject2 = (0, _taggedTemplateLiteral2["default"])(["\n  display: flex;\n  align-items: self-start;\n  margin-bottom: 11px;\n\n  .side-panel-panel__label {\n    margin-top: 2px;\n    margin-bottom: 0px;\n  }\n"])));

exports.PanelLabelWrapper = PanelLabelWrapper;

var StyledColorSelectorWrapper = _styledComponents["default"].div(_templateObject3 || (_templateObject3 = (0, _taggedTemplateLiteral2["default"])(["\n  margin-right: 5px;\n  margin-left: 5px;\n  margin-bottom: 6px;\n  margin-top: 2px;\n"])));

exports.StyledColorSelectorWrapper = StyledColorSelectorWrapper;

var StyledVerticalSeparator = _styledComponents["default"].div(_templateObject4 || (_templateObject4 = (0, _taggedTemplateLiteral2["default"])(["\n  height: 1px;\n  background-color: ", ";\n  margin-top: 20px;\n  margin-bottom: 20px;\n  margin-left: -20px;\n"])), function (props) {
  return props.theme.inputBgd;
});

var StyledWrapper = _styledComponents["default"].div(_templateObject5 || (_templateObject5 = (0, _taggedTemplateLiteral2["default"])(["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: ", "px;\n"])), function (props) {
  var _props$marginBottom;

  return (_props$marginBottom = props.marginBottom) !== null && _props$marginBottom !== void 0 ? _props$marginBottom : 9;
});

var StyledConfigSection = _styledComponents["default"].div(_templateObject6 || (_templateObject6 = (0, _taggedTemplateLiteral2["default"])(["\n  display: flex;\n  flex-direction: column;\n"])));

var SectionTitle = _styledComponents["default"].div(_templateObject7 || (_templateObject7 = (0, _taggedTemplateLiteral2["default"])(["\n  font-size: ", ";\n  color: ", ";\n  margin-bottom: 5px;\n  text-transform: capitalize;\n"])), function (props) {
  return props.theme.inputFontSize;
}, function (props) {
  return props.theme.effectPanelTextSecondary1;
});

var SectionSubTitle = _styledComponents["default"].div(_templateObject8 || (_templateObject8 = (0, _taggedTemplateLiteral2["default"])(["\n  font-size: ", ";\n  color: ", ";\n  margin-bottom: 8px;\n  margin-left: 6px;\n"])), function (props) {
  return props.theme.inputFontSize;
}, function (props) {
  return props.theme.effectPanelTextSecondary2;
});

var StyleSliderWrapper = _styledComponents["default"].div(_templateObject9 || (_templateObject9 = (0, _taggedTemplateLiteral2["default"])(["\n  align-self: flex-start;\n  width: 199px;\n  height: 32px;\n  display: flex;\n  align-items: center;\n  .kg-range-slider__input {\n    height: 32px;\n    text-align: center;\n    padding: 3px 6px;\n  }\n  .kg-slider {\n    padding-left: 6px;\n  }\n  .kg-range-slider {\n    padding: 0px !important;\n  }\n"])));

var RegularOuterWrapper = _styledComponents["default"].div.attrs({
  className: 'effect-configurator__pp-section'
})(_templateObject10 || (_templateObject10 = (0, _taggedTemplateLiteral2["default"])(["\n  margin-bottom: 8px;\n"])));

var RegularSectionTitleWrapper = _styledComponents["default"].div.attrs({
  className: 'effect-configurator__pp-section-title'
})(_templateObject11 || (_templateObject11 = (0, _taggedTemplateLiteral2["default"])(["\n  font-size: ", ";\n  color: ", ";\n  text-transform: capitalize;\n  margin-bottom: -3px;\n"])), function (props) {
  return props.theme.inputFontSize;
}, function (props) {
  return props.theme.effectPanelTextSecondary1;
});

var RegularSliderWrapper = _styledComponents["default"].div.attrs({
  className: 'effect-configurator__pp-section-control'
})(_templateObject12 || (_templateObject12 = (0, _taggedTemplateLiteral2["default"])(["\n  height: 32px;\n  .kg-range-slider__input {\n    height: 32px;\n    text-align: center;\n    padding: 3px 6px;\n  }\n  .kg-slider {\n    padding-left: 6px;\n  }\n  .kg-range-slider {\n    padding: 0px !important;\n  }\n"])));

var COMMON_SLIDER_PROPS = {
  showInput: true,
  isRanged: false,
  step: 0.001,
  label: 'value'
};
EffectConfiguratorFactory.deps = [_rangeSlider["default"], _effectTimeConfigurator["default"]];

function EffectConfiguratorFactory(RangeSlider, EffectTimeConfigurator) {
  var EffectConfigurator = function EffectConfigurator(_ref) {
    var effect = _ref.effect,
        updateEffectConfig = _ref.updateEffectConfig;
    var renderShadowEffectConfigurator = (0, _react.useCallback)(function () {
      var parameters = effect.parameters;
      var sliderProps = (0, _react.useMemo)(function () {
        var propNames = ['shadowIntensity', 'ambientLightIntensity', 'sunLightIntensity'];
        return propNames.map(function (propName) {
          return {
            value1: parameters[propName],
            range: [0, 1],
            value0: 0,
            onChange: function onChange(value, event) {
              updateEffectConfig(event, effect.id, {
                parameters: (0, _defineProperty2["default"])({}, propName, value[1])
              });
            }
          };
        });
      }, [effect.id, parameters, updateEffectConfig]);
      var onTimeParametersChanged = (0, _react.useCallback)(function (parameters) {
        updateEffectConfig(null, effect.id, {
          parameters: _objectSpread(_objectSpread(_objectSpread({}, parameters.timestamp ? {
            timestamp: parameters.timestamp
          } : null), parameters.timezone ? {
            timezone: parameters.timezone
          } : null), parameters.timeMode ? {
            timeMode: parameters.timeMode
          } : null)
        });
      }, [effect.id, updateEffectConfig]);
      var colorPickerProps = (0, _react.useMemo)(function () {
        var propNames = ['ambientLightColor', 'sunLightColor', 'shadowColor'];
        return propNames.map(function (propName) {
          return {
            colorSets: [{
              selectedColor: parameters[propName],
              setColor: function setColor(v) {
                return updateEffectConfig(null, effect.id, {
                  parameters: (0, _defineProperty2["default"])({}, propName, v)
                });
              }
            }]
          };
        });
      }, [effect.id, parameters, updateEffectConfig]);
      return /*#__PURE__*/_react["default"].createElement(StyledEffectConfigurator, {
        key: effect.id
      }, /*#__PURE__*/_react["default"].createElement(PanelLabelWrapper, null, /*#__PURE__*/_react["default"].createElement(SectionTitle, null, 'Date & Time')), /*#__PURE__*/_react["default"].createElement(EffectTimeConfigurator, {
        timestamp: parameters.timestamp,
        timezone: parameters.timezone,
        timeMode: parameters.timeMode,
        onChange: onTimeParametersChanged
      }), /*#__PURE__*/_react["default"].createElement(StyledVerticalSeparator, null), /*#__PURE__*/_react["default"].createElement(StyledWrapper, {
        marginBottom: 0
      }, /*#__PURE__*/_react["default"].createElement(SectionTitle, null, 'Shadow')), /*#__PURE__*/_react["default"].createElement(StyledWrapper, {
        marginBottom: 16
      }, /*#__PURE__*/_react["default"].createElement(_compactColorPicker["default"], {
        label: 'Color',
        color: colorPickerProps[2].colorSets[0].selectedColor,
        onSetColor: colorPickerProps[2].colorSets[0].setColor,
        Icon: _icons.ArrowDownSmall
      }), /*#__PURE__*/_react["default"].createElement(StyledConfigSection, null, /*#__PURE__*/_react["default"].createElement(SectionSubTitle, null, "Intensity"), /*#__PURE__*/_react["default"].createElement(StyleSliderWrapper, null, /*#__PURE__*/_react["default"].createElement(RangeSlider, (0, _extends2["default"])({}, COMMON_SLIDER_PROPS, sliderProps[0]))))), /*#__PURE__*/_react["default"].createElement(StyledWrapper, {
        marginBottom: 0
      }, /*#__PURE__*/_react["default"].createElement(SectionTitle, null, 'Ambient light')), /*#__PURE__*/_react["default"].createElement(StyledWrapper, {
        marginBottom: 16
      }, /*#__PURE__*/_react["default"].createElement(_compactColorPicker["default"], {
        label: 'Color',
        color: colorPickerProps[0].colorSets[0].selectedColor,
        onSetColor: colorPickerProps[0].colorSets[0].setColor,
        Icon: _icons.ArrowDownSmall
      }), /*#__PURE__*/_react["default"].createElement(StyledConfigSection, null, /*#__PURE__*/_react["default"].createElement(SectionSubTitle, null, "Intensity"), /*#__PURE__*/_react["default"].createElement(StyleSliderWrapper, null, /*#__PURE__*/_react["default"].createElement(RangeSlider, (0, _extends2["default"])({}, COMMON_SLIDER_PROPS, sliderProps[1]))))), /*#__PURE__*/_react["default"].createElement(StyledWrapper, {
        marginBottom: 0
      }, /*#__PURE__*/_react["default"].createElement(SectionTitle, null, 'Sun light')), /*#__PURE__*/_react["default"].createElement(StyledWrapper, {
        marginBottom: 0
      }, /*#__PURE__*/_react["default"].createElement(_compactColorPicker["default"], {
        label: 'Color',
        color: colorPickerProps[1].colorSets[0].selectedColor,
        onSetColor: colorPickerProps[1].colorSets[0].setColor,
        Icon: _icons.ArrowDownSmall
      }), /*#__PURE__*/_react["default"].createElement(StyledConfigSection, null, /*#__PURE__*/_react["default"].createElement(SectionSubTitle, null, "Intensity"), /*#__PURE__*/_react["default"].createElement(StyleSliderWrapper, null, /*#__PURE__*/_react["default"].createElement(RangeSlider, (0, _extends2["default"])({}, COMMON_SLIDER_PROPS, sliderProps[2]))))));
    }, [effect, effect.parameters, updateEffectConfig]);
    var renderPostProcessingEffectConfigurator = (0, _react.useCallback)(function () {
      var _effect$deckEffect;

      var uniforms = ((_effect$deckEffect = effect.deckEffect) === null || _effect$deckEffect === void 0 ? void 0 : _effect$deckEffect.module.uniforms) || {};
      var parameterDescriptions = effect.getParameterDescriptions();
      var flatParameterDescriptions = (0, _react.useMemo)(function () {
        return parameterDescriptions.reduce(function (acc, description) {
          if (description.type === 'array') {
            // split arrays of controls into a separate controls for each component
            if (Array.isArray(description.defaultValue)) {
              description.defaultValue.forEach(function (_, index) {
                var _description$label;

                acc.push(_objectSpread(_objectSpread({}, description), {}, {
                  index: index,
                  label: (_description$label = description.label) === null || _description$label === void 0 ? void 0 : _description$label[index]
                }));
              });
            }
          } else {
            acc.push(description);
          }

          return acc;
        }, []);
      }, [parameterDescriptions]);
      var controls = (0, _react.useMemo)(function () {
        return flatParameterDescriptions.map(function (desc) {
          var paramName = desc.name;
          var uniform = uniforms[desc.name];

          if (!uniform && uniform !== 0 || uniform["private"]) {
            return null;
          }

          var prevValue = effect.parameters[paramName];
          var label = desc.label === false ? false : desc.label || desc.name; // the uniform is [number, number] array

          if (uniform.length === 2) {
            return {
              label: label,
              value1: prevValue[desc.index || 0] || 0,
              range: [0, 1],
              value0: 0,
              onChange: function onChange(newValue, event) {
                updateEffectConfig(event, effect.id, {
                  parameters: (0, _defineProperty2["default"])({}, paramName, desc.index === 0 ? [newValue[1], prevValue[1]] : [prevValue[0], newValue[1]])
                });
              }
            };
          } // the uniform is a plain number without any description
          else if ((0, _utils.isNumber)(uniform)) {
              var _desc$min, _desc$max, _desc$min2;

              return {
                label: label,
                value1: prevValue !== null && prevValue !== void 0 ? prevValue : 0,
                range: [(_desc$min = desc.min) !== null && _desc$min !== void 0 ? _desc$min : 0, (_desc$max = desc.max) !== null && _desc$max !== void 0 ? _desc$max : 500],
                value0: (_desc$min2 = desc.min) !== null && _desc$min2 !== void 0 ? _desc$min2 : 0,
                onChange: function onChange(newValue, event) {
                  updateEffectConfig(event, effect.id, {
                    parameters: (0, _defineProperty2["default"])({}, paramName, newValue[1])
                  });
                }
              };
            } // the uniform description is {value: 0, min: 0, max: 1, ...}
            else if ((0, _utils.isNumber)(uniform.value)) {
                var _ref2, _ref3, _desc$min3, _ref4, _ref5, _desc$max2, _ref6, _ref7, _desc$min4;

                return {
                  label: label,
                  value1: prevValue || 0,
                  range: [(_ref2 = (_ref3 = (_desc$min3 = desc.min) !== null && _desc$min3 !== void 0 ? _desc$min3 : uniform.min) !== null && _ref3 !== void 0 ? _ref3 : uniform.softMin) !== null && _ref2 !== void 0 ? _ref2 : 0, (_ref4 = (_ref5 = (_desc$max2 = desc.max) !== null && _desc$max2 !== void 0 ? _desc$max2 : uniform.max) !== null && _ref5 !== void 0 ? _ref5 : uniform.softMax) !== null && _ref4 !== void 0 ? _ref4 : 1],
                  value0: (_ref6 = (_ref7 = (_desc$min4 = desc.min) !== null && _desc$min4 !== void 0 ? _desc$min4 : uniform.min) !== null && _ref7 !== void 0 ? _ref7 : uniform.softMin) !== null && _ref6 !== void 0 ? _ref6 : 0,
                  onChange: function onChange(newValue, event) {
                    updateEffectConfig(event, effect.id, {
                      parameters: (0, _defineProperty2["default"])({}, paramName, newValue[1])
                    });
                  }
                };
              } // ignore everything else for now


          return null;
        });
      }, [flatParameterDescriptions, effect, effect.parameters, updateEffectConfig]);
      return /*#__PURE__*/_react["default"].createElement(StyledEffectConfigurator, {
        key: effect.id
      }, flatParameterDescriptions.map(function (desc, parameterIndex) {
        var control = controls[parameterIndex];

        if (!control) {
          return null;
        }

        return /*#__PURE__*/_react["default"].createElement(RegularOuterWrapper, {
          key: "".concat(effect.id, "-").concat(parameterIndex)
        }, control.label ? /*#__PURE__*/_react["default"].createElement(RegularSectionTitleWrapper, null, control.label) : null, /*#__PURE__*/_react["default"].createElement(RegularSliderWrapper, null, /*#__PURE__*/_react["default"].createElement(RangeSlider, (0, _extends2["default"])({
          key: parameterIndex
        }, COMMON_SLIDER_PROPS, control))));
      }));
    }, [effect, effect.parameters, updateEffectConfig]);
    if (effect.type === _constants.LIGHT_AND_SHADOW_EFFECT.type) return renderShadowEffectConfigurator();
    return renderPostProcessingEffectConfigurator();
  };

  return (0, _reactIntl.injectIntl)(EffectConfigurator);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9lZmZlY3RzL2VmZmVjdC1jb25maWd1cmF0b3IudHN4Il0sIm5hbWVzIjpbIlN0eWxlZEVmZmVjdENvbmZpZ3VyYXRvciIsInN0eWxlZCIsImRpdiIsImF0dHJzIiwiY2xhc3NOYW1lIiwicHJvcHMiLCJ0aGVtZSIsImVmZmVjdENvbmZpZ3VyYXRvck1hcmdpbiIsImVmZmVjdENvbmZpZ3VyYXRvclBhZGRpbmciLCJQYW5lbExhYmVsV3JhcHBlciIsIlN0eWxlZENvbG9yU2VsZWN0b3JXcmFwcGVyIiwiU3R5bGVkVmVydGljYWxTZXBhcmF0b3IiLCJpbnB1dEJnZCIsIlN0eWxlZFdyYXBwZXIiLCJtYXJnaW5Cb3R0b20iLCJTdHlsZWRDb25maWdTZWN0aW9uIiwiU2VjdGlvblRpdGxlIiwiaW5wdXRGb250U2l6ZSIsImVmZmVjdFBhbmVsVGV4dFNlY29uZGFyeTEiLCJTZWN0aW9uU3ViVGl0bGUiLCJlZmZlY3RQYW5lbFRleHRTZWNvbmRhcnkyIiwiU3R5bGVTbGlkZXJXcmFwcGVyIiwiUmVndWxhck91dGVyV3JhcHBlciIsIlJlZ3VsYXJTZWN0aW9uVGl0bGVXcmFwcGVyIiwiUmVndWxhclNsaWRlcldyYXBwZXIiLCJDT01NT05fU0xJREVSX1BST1BTIiwic2hvd0lucHV0IiwiaXNSYW5nZWQiLCJzdGVwIiwibGFiZWwiLCJFZmZlY3RDb25maWd1cmF0b3JGYWN0b3J5IiwiZGVwcyIsIlJhbmdlU2xpZGVyRmFjdG9yeSIsIkVmZmVjdFRpbWVDb25maWd1cmF0b3JGYWN0b3J5IiwiUmFuZ2VTbGlkZXIiLCJFZmZlY3RUaW1lQ29uZmlndXJhdG9yIiwiRWZmZWN0Q29uZmlndXJhdG9yIiwiZWZmZWN0IiwidXBkYXRlRWZmZWN0Q29uZmlnIiwicmVuZGVyU2hhZG93RWZmZWN0Q29uZmlndXJhdG9yIiwicGFyYW1ldGVycyIsInNsaWRlclByb3BzIiwicHJvcE5hbWVzIiwibWFwIiwicHJvcE5hbWUiLCJ2YWx1ZTEiLCJyYW5nZSIsInZhbHVlMCIsIm9uQ2hhbmdlIiwidmFsdWUiLCJldmVudCIsImlkIiwib25UaW1lUGFyYW1ldGVyc0NoYW5nZWQiLCJ0aW1lc3RhbXAiLCJ0aW1lem9uZSIsInRpbWVNb2RlIiwiY29sb3JQaWNrZXJQcm9wcyIsImNvbG9yU2V0cyIsInNlbGVjdGVkQ29sb3IiLCJzZXRDb2xvciIsInYiLCJBcnJvd0Rvd25TbWFsbCIsInJlbmRlclBvc3RQcm9jZXNzaW5nRWZmZWN0Q29uZmlndXJhdG9yIiwidW5pZm9ybXMiLCJkZWNrRWZmZWN0IiwibW9kdWxlIiwicGFyYW1ldGVyRGVzY3JpcHRpb25zIiwiZ2V0UGFyYW1ldGVyRGVzY3JpcHRpb25zIiwiZmxhdFBhcmFtZXRlckRlc2NyaXB0aW9ucyIsInJlZHVjZSIsImFjYyIsImRlc2NyaXB0aW9uIiwidHlwZSIsIkFycmF5IiwiaXNBcnJheSIsImRlZmF1bHRWYWx1ZSIsImZvckVhY2giLCJfIiwiaW5kZXgiLCJwdXNoIiwiY29udHJvbHMiLCJkZXNjIiwicGFyYW1OYW1lIiwibmFtZSIsInVuaWZvcm0iLCJwcmV2VmFsdWUiLCJsZW5ndGgiLCJuZXdWYWx1ZSIsIm1pbiIsIm1heCIsInNvZnRNaW4iLCJzb2Z0TWF4IiwicGFyYW1ldGVySW5kZXgiLCJjb250cm9sIiwiTElHSFRfQU5EX1NIQURPV19FRkZFQ1QiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUdBOztBQUNBOztBQUNBOztBQUVBOztBQUNBOztBQUdBOztBQUNBOztBQUNBOztBQUNBOzs7Ozs7OztBQVdBLElBQU1BLHdCQUF3QixHQUFHQyw2QkFBT0MsR0FBUCxDQUFXQyxLQUFYLENBQWlCO0FBQ2hEQyxFQUFBQSxTQUFTLEVBQUU7QUFEcUMsQ0FBakIsQ0FBSCxtSkFJbEIsVUFBQUMsS0FBSztBQUFBLFNBQUlBLEtBQUssQ0FBQ0MsS0FBTixDQUFZQyx3QkFBaEI7QUFBQSxDQUphLEVBS2pCLFVBQUFGLEtBQUs7QUFBQSxTQUFJQSxLQUFLLENBQUNDLEtBQU4sQ0FBWUUseUJBQWhCO0FB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RCxHQXhPRDs7QUEwT0EsU0FBTywyQkFBVzFCLGtCQUFYLENBQVA7QUFDRCIsInNvdXJjZXNDb250ZW50IjpbIi8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBNSVRcbi8vIENvcHlyaWdodCBjb250cmlidXRvcnMgdG8gdGhlIGtlcGxlci5nbCBwcm9qZWN0XG5cbmltcG9ydCBSZWFjdCwge3VzZUNhbGxiYWNrLCB1c2VNZW1vfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgc3R5bGVkIGZyb20gJ3N0eWxlZC1jb21wb25lbnRzJztcbmltcG9ydCB7aW5qZWN0SW50bCwgSW50bFNoYXBlfSBmcm9tICdyZWFjdC1pbnRsJztcblxuaW1wb3J0IHtMSUdIVF9BTkRfU0hBRE9XX0VGRkVDVH0gZnJvbSAnQGtlcGxlci5nbC9jb25zdGFudHMnO1xuaW1wb3J0IHtpc051bWJlcn0gZnJvbSAnQGtlcGxlci5nbC91dGlscyc7XG5pbXBvcnQge0VmZmVjdCwgRWZmZWN0VXBkYXRlUHJvcHN9IGZyb20gJ0BrZXBsZXIuZ2wvdHlwZXMnO1xuXG5pbXBvcnQgUmFuZ2VTbGlkZXJGYWN0b3J5IGZyb20gJy4uL2NvbW1vbi9yYW5nZS1zbGlkZXInO1xuaW1wb3J0IHtBcnJvd0Rvd25TbWFsbH0gZnJvbSAnLi4vY29tbW9uL2ljb25zJztcbmltcG9ydCBFZmZlY3RUaW1lQ29uZmlndXJhdG9yRmFjdG9yeSBmcm9tICcuL2VmZmVjdC10aW1lLWNvbmZpZ3VyYXRvcic7XG5pbXBvcnQgQ29tcGFjdENvbG9yUGlja2VyIGZyb20gJy4vY29tcGFjdC1jb2xvci1waWNrZXInO1xuXG5leHBvcnQgdHlwZSBFZmZlY3RDb25maWd1cmF0b3JQcm9wcyA9IHtcbiAgZWZmZWN0OiBFZmZlY3Q7XG4gIHVwZGF0ZUVmZmVjdENvbmZpZzogKFxuICAgIGU6IEV2ZW50IHwgbnVsbCB8IHVuZGVmaW5lZCxcbiAgICBpZDogc3RyaW5nLFxuICAgIGNvbmZpZzogUGFydGlhbDxFZmZlY3RVcGRhdGVQcm9wcz5cbiAgKSA9PiB2b2lkO1xufTtcblxuY29uc3QgU3R5bGVkRWZmZWN0Q29uZmlndXJhdG9yID0gc3R5bGVkLmRpdi5hdHRycyh7XG4gIGNsYXNzTmFtZTogJ2VmZmVjdC1wYW5lbF9fY29uZmlnJ1xufSlgXG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgbWFyZ2luOiAke3Byb3BzID0+IHByb3BzLnRoZW1lLmVmZmVjdENvbmZpZ3VyYXRvck1hcmdpbn07XG4gIHBhZGRpbmc6ICR7cHJvcHMgPT4gcHJvcHMudGhlbWUuZWZmZWN0Q29uZmlndXJhdG9yUGFkZGluZ307XG5gO1xuXG5leHBvcnQgY29uc3QgUGFuZWxMYWJlbFdyYXBwZXIgPSBzdHlsZWQuZGl2LmF0dHJzKHtcbiAgY2xhc3NOYW1lOiAnc2lkZS1wYW5lbC1wYW5lbF9fbGFiZWwtd3JhcHBlcidcbn0pYFxuICBkaXNwbGF5OiBmbGV4O1xuICBhbGlnbi1pdGVtczogc2VsZi1zdGFydDtcbiAgbWFyZ2luLWJvdHRvbTogMTFweDtcblxuICAuc2lkZS1wYW5lbC1wYW5lbF9fbGFiZWwge1xuICAgIG1hcmdpbi10b3A6IDJweDtcbiAgICBtYXJnaW4tYm90dG9tOiAwcHg7XG4gIH1cbmA7XG5cbmV4cG9ydCBjb25zdCBTdHlsZWRDb2xvclNlbGVjdG9yV3JhcHBlciA9IHN0eWxlZC5kaXZgXG4gIG1hcmdpbi1yaWdodDogNXB4O1xuICBtYXJnaW4tbGVmdDogNXB4O1xuICBtYXJnaW4tYm90dG9tOiA2cHg7XG4gIG1hcmdpbi10b3A6IDJweDtcbmA7XG5cbmNvbnN0IFN0eWxlZFZlcnRpY2FsU2VwYXJhdG9yID0gc3R5bGVkLmRpdmBcbiAgaGVpZ2h0OiAxcHg7XG4gIGJhY2tncm91bmQtY29sb3I6ICR7cHJvcHMgPT4gcHJvcHMudGhlbWUuaW5wdXRCZ2R9O1xuICBtYXJnaW4tdG9wOiAyMHB4O1xuICBtYXJnaW4tYm90dG9tOiAyMHB4O1xuICBtYXJnaW4tbGVmdDogLTIwcHg7XG5gO1xuXG50eXBlIFN0eWxlZFdyYXBwZXJQcm9wcyA9IHtcbiAgbWFyZ2luQm90dG9tPzogbnVtYmVyO1xufTtcbmNvbnN0IFN0eWxlZFdyYXBwZXIgPSBzdHlsZWQuZGl2PFN0eWxlZFdyYXBwZXJQcm9wcz5gXG4gIGRpc3BsYXk6IGZsZXg7XG4gIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjtcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgbWFyZ2luLWJvdHRvbTogJHtwcm9wcyA9PiBwcm9wcy5tYXJnaW5Cb3R0b20gPz8gOX1weDtcbmA7XG5cbmNvbnN0IFN0eWxlZENvbmZpZ1NlY3Rpb24gPSBzdHlsZWQuZGl2YFxuICBkaXNwbGF5OiBmbGV4O1xuICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuYDtcblxuY29uc3QgU2VjdGlvblRpdGxlID0gc3R5bGVkLmRpdmBcbiAgZm9udC1zaXplOiAke3Byb3BzID0+IHByb3BzLnRoZW1lLmlucHV0Rm9udFNpemV9O1xuICBjb2xvcjogJHtwcm9wcyA9PiBwcm9wcy50aGVtZS5lZmZlY3RQYW5lbFRleHRTZWNvbmRhcnkxfTtcbiAgbWFyZ2luLWJvdHRvbTogNXB4O1xuICB0ZXh0LXRyYW5zZm9ybTogY2FwaXRhbGl6ZTtcbmA7XG5cbmNvbnN0IFNlY3Rpb25TdWJUaXRsZSA9IHN0eWxlZC5kaXZgXG4gIGZvbnQtc2l6ZTogJHtwcm9wcyA9PiBwcm9wcy50aGVtZS5pbnB1dEZvbnRTaXplfTtcbiAgY29sb3I6ICR7cHJvcHMgPT4gcHJvcHMudGhlbWUuZWZmZWN0UGFuZWxUZXh0U2Vjb25kYXJ5Mn07XG4gIG1hcmdpbi1ib3R0b206IDhweDtcbiAgbWFyZ2luLWxlZnQ6IDZweDtcbmA7XG5cbmNvbnN0IFN0eWxlU2xpZGVyV3JhcHBlciA9IHN0eWxlZC5kaXZgXG4gIGFsaWduLXNlbGY6IGZsZXgtc3RhcnQ7XG4gIHdpZHRoOiAxOTlweDtcbiAgaGVpZ2h0OiAzMnB4O1xuICBkaXNwbGF5OiBmbGV4O1xuICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAua2ctcmFuZ2Utc2xpZGVyX19pbnB1dCB7XG4gICAgaGVpZ2h0OiAzMnB4O1xuICAgIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgICBwYWRkaW5nOiAzcHggNnB4O1xuICB9XG4gIC5rZy1zbGlkZXIge1xuICAgIHBhZGRpbmctbGVmdDogNnB4O1xuICB9XG4gIC5rZy1yYW5nZS1zbGlkZXIge1xuICAgIHBhZGRpbmc6IDBweCAhaW1wb3J0YW50O1xuICB9XG5gO1xuXG5jb25zdCBSZWd1bGFyT3V0ZXJXcmFwcGVyID0gc3R5bGVkLmRpdi5hdHRycyh7XG4gIGNsYXNzTmFtZTogJ2VmZmVjdC1jb25maWd1cmF0b3JfX3BwLXNlY3Rpb24nXG59KWBcbiAgbWFyZ2luLWJvdHRvbTogOHB4O1xuYDtcblxuY29uc3QgUmVndWxhclNlY3Rpb25UaXRsZVdyYXBwZXIgPSBzdHlsZWQuZGl2LmF0dHJzKHtcbiAgY2xhc3NOYW1lOiAnZWZmZWN0LWNvbmZpZ3VyYXRvcl9fcHAtc2VjdGlvbi10aXRsZSdcbn0pYFxuICBmb250LXNpemU6ICR7cHJvcHMgPT4gcHJvcHMudGhlbWUuaW5wdXRGb250U2l6ZX07XG4gIGNvbG9yOiAke3Byb3BzID0+IHByb3BzLnRoZW1lLmVmZmVjdFBhbmVsVGV4dFNlY29uZGFyeTF9O1xuICB0ZXh0LXRyYW5zZm9ybTogY2FwaXRhbGl6ZTtcbiAgbWFyZ2luLWJvdHRvbTogLTNweDtcbmA7XG5cbmNvbnN0IFJlZ3VsYXJTbGlkZXJXcmFwcGVyID0gc3R5bGVkLmRpdi5hdHRycyh7XG4gIGNsYXNzTmFtZTogJ2VmZmVjdC1jb25maWd1cmF0b3JfX3BwLXNlY3Rpb24tY29udHJvbCdcbn0pYFxuICBoZWlnaHQ6IDMycHg7XG4gIC5rZy1yYW5nZS1zbGlkZXJfX2lucHV0IHtcbiAgICBoZWlnaHQ6IDMycHg7XG4gICAgdGV4dC1hbGlnbjogY2VudGVyO1xuICAgIHBhZGRpbmc6IDNweCA2cHg7XG4gIH1cbiAgLmtnLXNsaWRlciB7XG4gICAgcGFkZGluZy1sZWZ0OiA2cHg7XG4gIH1cbiAgLmtnLXJhbmdlLXNsaWRlciB7XG4gICAgcGFkZGluZzogMHB4ICFpbXBvcnRhbnQ7XG4gIH1cbmA7XG5cbmNvbnN0IENPTU1PTl9TTElERVJfUFJPUFMgPSB7XG4gIHNob3dJbnB1dDogdHJ1ZSxcbiAgaXNSYW5nZWQ6IGZhbHNlLFxuICBzdGVwOiAwLjAwMSxcbiAgbGFiZWw6ICd2YWx1ZSdcbn07XG5cbnR5cGUgRWZmZWN0UGFyYW1ldGVyRGVzY3JpcHRpb25GbGF0dGVuZWQgPSB7XG4gIG5hbWU6IHN0cmluZztcbiAgbGFiZWw/OiBzdHJpbmcgfCBmYWxzZSB8IChzdHJpbmcgfCBmYWxzZSlbXTtcbiAgbWluOiBudW1iZXI7XG4gIG1heDogbnVtYmVyO1xuICBpbmRleD86IG51bWJlcjtcbn07XG5cbkVmZmVjdENvbmZpZ3VyYXRvckZhY3RvcnkuZGVwcyA9IFtSYW5nZVNsaWRlckZhY3RvcnksIEVmZmVjdFRpbWVDb25maWd1cmF0b3JGYWN0b3J5XTtcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gRWZmZWN0Q29uZmlndXJhdG9yRmFjdG9yeShcbiAgUmFuZ2VTbGlkZXI6IFJldHVyblR5cGU8dHlwZW9mIFJhbmdlU2xpZGVyRmFjdG9yeT4sXG4gIEVmZmVjdFRpbWVDb25maWd1cmF0b3I6IFJldHVyblR5cGU8dHlwZW9mIEVmZmVjdFRpbWVDb25maWd1cmF0b3JGYWN0b3J5PlxuKTogUmVhY3QuRkM8RWZmZWN0Q29uZmlndXJhdG9yUHJvcHM+IHtcbiAgY29uc3QgRWZmZWN0Q29uZmlndXJhdG9yID0gKHtcbiAgICBlZmZlY3QsXG4gICAgdXBkYXRlRWZmZWN0Q29uZmlnXG4gIH06IEVmZmVjdENvbmZpZ3VyYXRvclByb3BzICYge2ludGw6IEludGxTaGFwZX0pID0+IHtcbiAgICBjb25zdCByZW5kZXJTaGFkb3dFZmZlY3RDb25maWd1cmF0b3IgPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgICBjb25zdCB7cGFyYW1ldGVyc30gPSBlZmZlY3Q7XG5cbiAgICAgIGNvbnN0IHNsaWRlclByb3BzID0gdXNlTWVtbygoKSA9PiB7XG4gICAgICAgIGNvbnN0IHByb3BOYW1lcyA9IFsnc2hhZG93SW50ZW5zaXR5JywgJ2FtYmllbnRMaWdodEludGVuc2l0eScsICdzdW5MaWdodEludGVuc2l0eSddO1xuICAgICAgICByZXR1cm4gcHJvcE5hbWVzLm1hcChwcm9wTmFtZSA9PiB7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHZhbHVlMTogcGFyYW1ldGVyc1twcm9wTmFtZV0sXG4gICAgICAgICAgICByYW5nZTogWzAsIDFdLFxuICAgICAgICAgICAgdmFsdWUwOiAwLFxuICAgICAgICAgICAgb25DaGFuZ2U6ICh2YWx1ZTogbnVtYmVyW10sIGV2ZW50PzogRXZlbnQgfCBudWxsKSA9PiB7XG4gICAgICAgICAgICAgIHVwZGF0ZUVmZmVjdENvbmZpZyhldmVudCwgZWZmZWN0LmlkLCB7cGFyYW1ldGVyczoge1twcm9wTmFtZV06IHZhbHVlWzFdfX0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgICAgfSwgW2VmZmVjdC5pZCwgcGFyYW1ldGVycywgdXBkYXRlRWZmZWN0Q29uZmlnXSk7XG5cbiAgICAgIGNvbnN0IG9uVGltZVBhcmFtZXRlcnNDaGFuZ2VkID0gdXNlQ2FsbGJhY2soXG4gICAgICAgIHBhcmFtZXRlcnMgPT4ge1xuICAgICAgICAgIHVwZGF0ZUVmZmVjdENvbmZpZyhudWxsLCBlZmZlY3QuaWQsIHtcbiAgICAgICAgICAgIHBhcmFtZXRlcnM6IHtcbiAgICAgICAgICAgICAgLi4uKHBhcmFtZXRlcnMudGltZXN0YW1wID8ge3RpbWVzdGFtcDogcGFyYW1ldGVycy50aW1lc3RhbXB9IDogbnVsbCksXG4gICAgICAgICAgICAgIC4uLihwYXJhbWV0ZXJzLnRpbWV6b25lID8ge3RpbWV6b25lOiBwYXJhbWV0ZXJzLnRpbWV6b25lfSA6IG51bGwpLFxuICAgICAgICAgICAgICAuLi4ocGFyYW1ldGVycy50aW1lTW9kZSA/IHt0aW1lTW9kZTogcGFyYW1ldGVycy50aW1lTW9kZX0gOiBudWxsKVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBbZWZmZWN0LmlkLCB1cGRhdGVFZmZlY3RDb25maWddXG4gICAgICApO1xuXG4gICAgICBjb25zdCBjb2xvclBpY2tlclByb3BzID0gdXNlTWVtbygoKSA9PiB7XG4gICAgICAgIGNvbnN0IHByb3BOYW1lcyA9IFsnYW1iaWVudExpZ2h0Q29sb3InLCAnc3VuTGlnaHRDb2xvcicsICdzaGFkb3dDb2xvciddO1xuICAgICAgICByZXR1cm4gcHJvcE5hbWVzLm1hcChwcm9wTmFtZSA9PiB7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNvbG9yU2V0czogW1xuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgc2VsZWN0ZWRDb2xvcjogcGFyYW1ldGVyc1twcm9wTmFtZV0sXG4gICAgICAgICAgICAgICAgc2V0Q29sb3I6IHYgPT4gdXBkYXRlRWZmZWN0Q29uZmlnKG51bGwsIGVmZmVjdC5pZCwge3BhcmFtZXRlcnM6IHtbcHJvcE5hbWVdOiB2fX0pXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF1cbiAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICAgIH0sIFtlZmZlY3QuaWQsIHBhcmFtZXRlcnMsIHVwZGF0ZUVmZmVjdENvbmZpZ10pO1xuXG4gICAgICByZXR1cm4gKFxuICAgICAgICA8U3R5bGVkRWZmZWN0Q29uZmlndXJhdG9yIGtleT17ZWZmZWN0LmlkfT5cbiAgICAgICAgICA8UGFuZWxMYWJlbFdyYXBwZXI+XG4gICAgICAgICAgICA8U2VjdGlvblRpdGxlPnsnRGF0ZSAmIFRpbWUnfTwvU2VjdGlvblRpdGxlPlxuICAgICAgICAgIDwvUGFuZWxMYWJlbFdyYXBwZXI+XG4gICAgICAgICAgPEVmZmVjdFRpbWVDb25maWd1cmF0b3JcbiAgICAgICAgICAgIHRpbWVzdGFtcD17cGFyYW1ldGVycy50aW1lc3RhbXB9XG4gICAgICAgICAgICB0aW1lem9uZT17cGFyYW1ldGVycy50aW1lem9uZX1cbiAgICAgICAgICAgIHRpbWVNb2RlPXtwYXJhbWV0ZXJzLnRpbWVNb2RlfVxuICAgICAgICAgICAgb25DaGFuZ2U9e29uVGltZVBhcmFtZXRlcnNDaGFuZ2VkfVxuICAgICAgICAgIC8+XG5cbiAgICAgICAgICA8U3R5bGVkVmVydGljYWxTZXBhcmF0b3IgLz5cblxuICAgICAgICAgIDxTdHlsZWRXcmFwcGVyIG1hcmdpbkJvdHRvbT17MH0+XG4gICAgICAgICAgICA8U2VjdGlvblRpdGxlPnsnU2hhZG93J308L1NlY3Rpb25UaXRsZT5cbiAgICAgICAgICA8L1N0eWxlZFdyYXBwZXI+XG4gICAgICAgICAgPFN0eWxlZFdyYXBwZXIgbWFyZ2luQm90dG9tPXsxNn0+XG4gICAgICAgICAgICA8Q29tcGFjdENvbG9yUGlja2VyXG4gICAgICAgICAgICAgIGxhYmVsPXsnQ29sb3InfVxuICAgICAgICAgICAgICBjb2xvcj17Y29sb3JQaWNrZXJQcm9wc1syXS5jb2xvclNldHNbMF0uc2VsZWN0ZWRDb2xvcn1cbiAgICAgICAgICAgICAgb25TZXRDb2xvcj17Y29sb3JQaWNrZXJQcm9wc1syXS5jb2xvclNldHNbMF0uc2V0Q29sb3J9XG4gICAgICAgICAgICAgIEljb249e0Fycm93RG93blNtYWxsfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDxTdHlsZWRDb25maWdTZWN0aW9uPlxuICAgICAgICAgICAgICA8U2VjdGlvblN1YlRpdGxlPkludGVuc2l0eTwvU2VjdGlvblN1YlRpdGxlPlxuICAgICAgICAgICAgICA8U3R5bGVTbGlkZXJXcmFwcGVyPlxuICAgICAgICAgICAgICAgIDxSYW5nZVNsaWRlciB7Li4uQ09NTU9OX1NMSURFUl9QUk9QU30gey4uLnNsaWRlclByb3BzWzBdfSAvPlxuICAgICAgICAgICAgICA8L1N0eWxlU2xpZGVyV3JhcHBlcj5cbiAgICAgICAgICAgIDwvU3R5bGVkQ29uZmlnU2VjdGlvbj5cbiAgICAgICAgICA8L1N0eWxlZFdyYXBwZXI+XG5cbiAgICAgICAgICA8U3R5bGVkV3JhcHBlciBtYXJnaW5Cb3R0b209ezB9PlxuICAgICAgICAgICAgPFNlY3Rpb25UaXRsZT57J0FtYmllbnQgbGlnaHQnfTwvU2VjdGlvblRpdGxlPlxuICAgICAgICAgIDwvU3R5bGVkV3JhcHBlcj5cbiAgICAgICAgICA8U3R5bGVkV3JhcHBlciBtYXJnaW5Cb3R0b209ezE2fT5cbiAgICAgICAgICAgIDxDb21wYWN0Q29sb3JQaWNrZXJcbiAgICAgICAgICAgICAgbGFiZWw9eydDb2xvcid9XG4gICAgICAgICAgICAgIGNvbG9yPXtjb2xvclBpY2tlclByb3BzWzBdLmNvbG9yU2V0c1swXS5zZWxlY3RlZENvbG9yfVxuICAgICAgICAgICAgICBvblNldENvbG9yPXtjb2xvclBpY2tlclByb3BzWzBdLmNvbG9yU2V0c1swXS5zZXRDb2xvcn1cbiAgICAgICAgICAgICAgSWNvbj17QXJyb3dEb3duU21hbGx9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICAgPFN0eWxlZENvbmZpZ1NlY3Rpb24+XG4gICAgICAgICAgICAgIDxTZWN0aW9uU3ViVGl0bGU+SW50ZW5zaXR5PC9TZWN0aW9uU3ViVGl0bGU+XG4gICAgICAgICAgICAgIDxTdHlsZVNsaWRlcldyYXBwZXI+XG4gICAgICAgICAgICAgICAgPFJhbmdlU2xpZGVyIHsuLi5DT01NT05fU0xJREVSX1BST1BTfSB7Li4uc2xpZGVyUHJvcHNbMV19IC8+XG4gICAgICAgICAgICAgIDwvU3R5bGVTbGlkZXJXcmFwcGVyPlxuICAgICAgICAgICAgPC9TdHlsZWRDb25maWdTZWN0aW9uPlxuICAgICAgICAgIDwvU3R5bGVkV3JhcHBlcj5cblxuICAgICAgICAgIDxTdHlsZWRXcmFwcGVyIG1hcmdpbkJvdHRvbT17MH0+XG4gICAgICAgICAgICA8U2VjdGlvblRpdGxlPnsnU3VuIGxpZ2h0J308L1NlY3Rpb25UaXRsZT5cbiAgICAgICAgICA8L1N0eWxlZFdyYXBwZXI+XG4gICAgICAgICAgPFN0eWxlZFdyYXBwZXIgbWFyZ2luQm90dG9tPXswfT5cbiAgICAgICAgICAgIDxDb21wYWN0Q29sb3JQaWNrZXJcbiAgICAgICAgICAgICAgbGFiZWw9eydDb2xvcid9XG4gICAgICAgICAgICAgIGNvbG9yPXtjb2xvclBpY2tlclByb3BzWzFdLmNvbG9yU2V0c1swXS5zZWxlY3RlZENvbG9yfVxuICAgICAgICAgICAgICBvblNldENvbG9yPXtjb2xvclBpY2tlclByb3BzWzFdLmNvbG9yU2V0c1swXS5zZXRDb2xvcn1cbiAgICAgICAgICAgICAgSWNvbj17QXJyb3dEb3duU21hbGx9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICAgPFN0eWxlZENvbmZpZ1NlY3Rpb24+XG4gICAgICAgICAgICAgIDxTZWN0aW9uU3ViVGl0bGU+SW50ZW5zaXR5PC9TZWN0aW9uU3ViVGl0bGU+XG4gICAgICAgICAgICAgIDxTdHlsZVNsaWRlcldyYXBwZXI+XG4gICAgICAgICAgICAgICAgPFJhbmdlU2xpZGVyIHsuLi5DT01NT05fU0xJREVSX1BST1BTfSB7Li4uc2xpZGVyUHJvcHNbMl19IC8+XG4gICAgICAgICAgICAgIDwvU3R5bGVTbGlkZXJXcmFwcGVyPlxuICAgICAgICAgICAgPC9TdHlsZWRDb25maWdTZWN0aW9uPlxuICAgICAgICAgIDwvU3R5bGVkV3JhcHBlcj5cbiAgICAgICAgPC9TdHlsZWRFZmZlY3RDb25maWd1cmF0b3I+XG4gICAgICApO1xuICAgIH0sIFtlZmZlY3QsIGVmZmVjdC5wYXJhbWV0ZXJzLCB1cGRhdGVFZmZlY3RDb25maWddKTtcblxuICAgIGNvbnN0IHJlbmRlclBvc3RQcm9jZXNzaW5nRWZmZWN0Q29uZmlndXJhdG9yID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgICAgY29uc3QgdW5pZm9ybXMgPSBlZmZlY3QuZGVja0VmZmVjdD8ubW9kdWxlLnVuaWZvcm1zIHx8IHt9O1xuICAgICAgY29uc3QgcGFyYW1ldGVyRGVzY3JpcHRpb25zID0gZWZmZWN0LmdldFBhcmFtZXRlckRlc2NyaXB0aW9ucygpO1xuXG4gICAgICBjb25zdCBmbGF0UGFyYW1ldGVyRGVzY3JpcHRpb25zID0gdXNlTWVtbygoKSA9PiB7XG4gICAgICAgIHJldHVybiBwYXJhbWV0ZXJEZXNjcmlwdGlvbnMucmVkdWNlKChhY2MsIGRlc2NyaXB0aW9uKSA9PiB7XG4gICAgICAgICAgaWYgKGRlc2NyaXB0aW9uLnR5cGUgPT09ICdhcnJheScpIHtcbiAgICAgICAgICAgIC8vIHNwbGl0IGFycmF5cyBvZiBjb250cm9scyBpbnRvIGEgc2VwYXJhdGUgY29udHJvbHMgZm9yIGVhY2ggY29tcG9uZW50XG4gICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShkZXNjcmlwdGlvbi5kZWZhdWx0VmFsdWUpKSB7XG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uLmRlZmF1bHRWYWx1ZS5mb3JFYWNoKChfLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgICAgIGFjYy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgIC4uLmRlc2NyaXB0aW9uLFxuICAgICAgICAgICAgICAgICAgaW5kZXgsXG4gICAgICAgICAgICAgICAgICBsYWJlbDogZGVzY3JpcHRpb24ubGFiZWw/LltpbmRleF1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGFjYy5wdXNoKGRlc2NyaXB0aW9uKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm4gYWNjO1xuICAgICAgICB9LCBbXSBhcyBFZmZlY3RQYXJhbWV0ZXJEZXNjcmlwdGlvbkZsYXR0ZW5lZFtdKTtcbiAgICAgIH0sIFtwYXJhbWV0ZXJEZXNjcmlwdGlvbnNdKTtcblxuICAgICAgY29uc3QgY29udHJvbHMgPSB1c2VNZW1vKCgpID0+IHtcbiAgICAgICAgcmV0dXJuIGZsYXRQYXJhbWV0ZXJEZXNjcmlwdGlvbnMubWFwKGRlc2MgPT4ge1xuICAgICAgICAgIGNvbnN0IHBhcmFtTmFtZSA9IGRlc2MubmFtZTtcblxuICAgICAgICAgIGNvbnN0IHVuaWZvcm0gPSB1bmlmb3Jtc1tkZXNjLm5hbWVdO1xuICAgICAgICAgIGlmICgoIXVuaWZvcm0gJiYgdW5pZm9ybSAhPT0gMCkgfHwgdW5pZm9ybS5wcml2YXRlKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb25zdCBwcmV2VmFsdWUgPSBlZmZlY3QucGFyYW1ldGVyc1twYXJhbU5hbWVdO1xuXG4gICAgICAgICAgY29uc3QgbGFiZWwgPSBkZXNjLmxhYmVsID09PSBmYWxzZSA/IGZhbHNlIDogZGVzYy5sYWJlbCB8fCBkZXNjLm5hbWU7XG5cbiAgICAgICAgICAvLyB0aGUgdW5pZm9ybSBpcyBbbnVtYmVyLCBudW1iZXJdIGFycmF5XG4gICAgICAgICAgaWYgKHVuaWZvcm0ubGVuZ3RoID09PSAyKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICBsYWJlbCxcbiAgICAgICAgICAgICAgdmFsdWUxOiBwcmV2VmFsdWVbZGVzYy5pbmRleCB8fCAwXSB8fCAwLFxuICAgICAgICAgICAgICByYW5nZTogWzAsIDFdLFxuICAgICAgICAgICAgICB2YWx1ZTA6IDAsXG4gICAgICAgICAgICAgIG9uQ2hhbmdlOiAobmV3VmFsdWU6IG51bWJlcltdLCBldmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIHVwZGF0ZUVmZmVjdENvbmZpZyhldmVudCwgZWZmZWN0LmlkLCB7XG4gICAgICAgICAgICAgICAgICBwYXJhbWV0ZXJzOiB7XG4gICAgICAgICAgICAgICAgICAgIFtwYXJhbU5hbWVdOlxuICAgICAgICAgICAgICAgICAgICAgIGRlc2MuaW5kZXggPT09IDAgPyBbbmV3VmFsdWVbMV0sIHByZXZWYWx1ZVsxXV0gOiBbcHJldlZhbHVlWzBdLCBuZXdWYWx1ZVsxXV1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLy8gdGhlIHVuaWZvcm0gaXMgYSBwbGFpbiBudW1iZXIgd2l0aG91dCBhbnkgZGVzY3JpcHRpb25cbiAgICAgICAgICBlbHNlIGlmIChpc051bWJlcih1bmlmb3JtKSkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgbGFiZWwsXG4gICAgICAgICAgICAgIHZhbHVlMTogcHJldlZhbHVlID8/IDAsXG4gICAgICAgICAgICAgIHJhbmdlOiBbZGVzYy5taW4gPz8gMCwgZGVzYy5tYXggPz8gNTAwXSxcbiAgICAgICAgICAgICAgdmFsdWUwOiBkZXNjLm1pbiA/PyAwLFxuICAgICAgICAgICAgICBvbkNoYW5nZTogKG5ld1ZhbHVlOiBudW1iZXJbXSwgZXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICB1cGRhdGVFZmZlY3RDb25maWcoZXZlbnQsIGVmZmVjdC5pZCwge3BhcmFtZXRlcnM6IHtbcGFyYW1OYW1lXTogbmV3VmFsdWVbMV19fSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuICAgICAgICAgIC8vIHRoZSB1bmlmb3JtIGRlc2NyaXB0aW9uIGlzIHt2YWx1ZTogMCwgbWluOiAwLCBtYXg6IDEsIC4uLn1cbiAgICAgICAgICBlbHNlIGlmIChpc051bWJlcih1bmlmb3JtLnZhbHVlKSkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgbGFiZWwsXG4gICAgICAgICAgICAgIHZhbHVlMTogcHJldlZhbHVlIHx8IDAsXG4gICAgICAgICAgICAgIHJhbmdlOiBbXG4gICAgICAgICAgICAgICAgZGVzYy5taW4gPz8gdW5pZm9ybS5taW4gPz8gdW5pZm9ybS5zb2Z0TWluID8/IDAsXG4gICAgICAgICAgICAgICAgZGVzYy5tYXggPz8gdW5pZm9ybS5tYXggPz8gdW5pZm9ybS5zb2Z0TWF4ID8/IDFcbiAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgdmFsdWUwOiBkZXNjLm1pbiA/PyB1bmlmb3JtLm1pbiA/PyB1bmlmb3JtLnNvZnRNaW4gPz8gMCxcbiAgICAgICAgICAgICAgb25DaGFuZ2U6IChuZXdWYWx1ZTogbnVtYmVyW10sIGV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgdXBkYXRlRWZmZWN0Q29uZmlnKGV2ZW50LCBlZmZlY3QuaWQsIHtwYXJhbWV0ZXJzOiB7W3BhcmFtTmFtZV06IG5ld1ZhbHVlWzFdfX0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIGlnbm9yZSBldmVyeXRoaW5nIGVsc2UgZm9yIG5vd1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9KTtcbiAgICAgIH0sIFtmbGF0UGFyYW1ldGVyRGVzY3JpcHRpb25zLCBlZmZlY3QsIGVmZmVjdC5wYXJhbWV0ZXJzLCB1cGRhdGVFZmZlY3RDb25maWddKTtcblxuICAgICAgcmV0dXJuIChcbiAgICAgICAgPFN0eWxlZEVmZmVjdENvbmZpZ3VyYXRvciBrZXk9e2VmZmVjdC5pZH0+XG4gICAgICAgICAge2ZsYXRQYXJhbWV0ZXJEZXNjcmlwdGlvbnMubWFwKChkZXNjLCBwYXJhbWV0ZXJJbmRleCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgY29udHJvbCA9IGNvbnRyb2xzW3BhcmFtZXRlckluZGV4XTtcbiAgICAgICAgICAgIGlmICghY29udHJvbCkge1xuICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgPFJlZ3VsYXJPdXRlcldyYXBwZXIga2V5PXtgJHtlZmZlY3QuaWR9LSR7cGFyYW1ldGVySW5kZXh9YH0+XG4gICAgICAgICAgICAgICAge2NvbnRyb2wubGFiZWwgPyAoXG4gICAgICAgICAgICAgICAgICA8UmVndWxhclNlY3Rpb25UaXRsZVdyYXBwZXI+e2NvbnRyb2wubGFiZWx9PC9SZWd1bGFyU2VjdGlvblRpdGxlV3JhcHBlcj5cbiAgICAgICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgICAgICA8UmVndWxhclNsaWRlcldyYXBwZXI+XG4gICAgICAgICAgICAgICAgICA8UmFuZ2VTbGlkZXIga2V5PXtwYXJhbWV0ZXJJbmRleH0gey4uLkNPTU1PTl9TTElERVJfUFJPUFN9IHsuLi5jb250cm9sfSAvPlxuICAgICAgICAgICAgICAgIDwvUmVndWxhclNsaWRlcldyYXBwZXI+XG4gICAgICAgICAgICAgIDwvUmVndWxhck91dGVyV3JhcHBlcj5cbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfSl9XG4gICAgICAgIDwvU3R5bGVkRWZmZWN0Q29uZmlndXJhdG9yPlxuICAgICAgKTtcbiAgICB9LCBbZWZmZWN0LCBlZmZlY3QucGFyYW1ldGVycywgdXBkYXRlRWZmZWN0Q29uZmlnXSk7XG5cbiAgICBpZiAoZWZmZWN0LnR5cGUgPT09IExJR0hUX0FORF9TSEFET1dfRUZGRUNULnR5cGUpIHJldHVybiByZW5kZXJTaGFkb3dFZmZlY3RDb25maWd1cmF0b3IoKTtcbiAgICByZXR1cm4gcmVuZGVyUG9zdFByb2Nlc3NpbmdFZmZlY3RDb25maWd1cmF0b3IoKTtcbiAgfTtcblxuICByZXR1cm4gaW5qZWN0SW50bChFZmZlY3RDb25maWd1cmF0b3IpO1xufVxuIl19
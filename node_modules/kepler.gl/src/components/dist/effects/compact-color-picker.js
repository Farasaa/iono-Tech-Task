"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = exports.StyledPanelDropdown = void 0;

var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));

var _taggedTemplateLiteral2 = _interopRequireDefault(require("@babel/runtime/helpers/taggedTemplateLiteral"));

var _react = _interopRequireWildcard(require("react"));

var _styledComponents = _interopRequireDefault(require("styled-components"));

var _utils = require("@kepler.gl/utils");

var _components = require("../../../components");

var _styledComponents2 = require("../common/styled-components");

var _templateObject, _templateObject2, _templateObject3, _templateObject4;

var StyledPanelDropdown = _styledComponents["default"].div(_templateObject || (_templateObject = (0, _taggedTemplateLiteral2["default"])(["\n  ", "\n  background-color: ", ";\n  box-shadow: ", ";\n  border-radius: ", ";\n  overflow-y: auto;\n  max-height: 500px;\n  position: relative;\n  z-index: 999;\n  width: 220px;\n"])), function (props) {
  return props.theme.panelDropdownScrollBar;
}, function (props) {
  return props.theme.panelBackground;
}, function (props) {
  return props.theme.panelBoxShadow;
}, function (props) {
  return props.theme.panelBorderRadius;
});

exports.StyledPanelDropdown = StyledPanelDropdown;

var StyledConfigSection = _styledComponents["default"].div(_templateObject2 || (_templateObject2 = (0, _taggedTemplateLiteral2["default"])(["\n  display: flex;\n  flex-direction: column;\n"])));

var SectionTitle = _styledComponents["default"].div(_templateObject3 || (_templateObject3 = (0, _taggedTemplateLiteral2["default"])(["\n  font-size: ", ";\n  color: ", ";\n  margin-bottom: 8px;\n"])), function (props) {
  return props.theme.inputFontSize;
}, function (props) {
  return props.theme.effectPanelTextSecondary2;
});

var StyledDropdownButtonWrapper = _styledComponents["default"].div(_templateObject4 || (_templateObject4 = (0, _taggedTemplateLiteral2["default"])(["\n  align-self: flex-start;\n  .button {\n    color: ", ";\n    display: flex;\n    gap: 5px;\n    border: none;\n    transition: background 0.2s;\n    background-color: ", ";\n    padding: 8px 5px 8px 10px;\n    &:active {\n      color: ", ";\n      background-color: ", ";\n    }\n    &:hover {\n      color: ", ";\n      background-color: ", ";\n    }\n    & > svg {\n      margin-right: 0;\n    }\n  }\n"])), function (props) {
  return props.theme.effectPanelTextSecondary2;
}, function (props) {
  return props.theme.inputBgd;
}, function (props) {
  return props.theme.effectPanelTextMain;
}, function (props) {
  return props.theme.inputBgdHover;
}, function (props) {
  return props.theme.effectPanelTextMain;
}, function (props) {
  return props.theme.inputBgdHover;
});

var DEFAULT_OFFSET = {
  top: 0,
  left: 0
};

var SingleColorPickerDropdown = function SingleColorPickerDropdown(_ref) {
  var isOpened = _ref.isOpened,
      onClose = _ref.onClose,
      selectedColor = _ref.selectedColor,
      onSelectColor = _ref.onSelectColor,
      _ref$offset = _ref.offset,
      offset = _ref$offset === void 0 ? DEFAULT_OFFSET : _ref$offset;
  var onSelectColorCb = (0, _react.useCallback)(function (v) {
    onSelectColor(v);
  }, [onSelectColor]);
  return /*#__PURE__*/_react["default"].createElement(_components.Portaled, {
    top: offset.top,
    left: offset.left,
    isOpened: isOpened,
    onClose: onClose
  }, /*#__PURE__*/_react["default"].createElement(StyledPanelDropdown, null, /*#__PURE__*/_react["default"].createElement(_components.SingleColorPalette, {
    selectedColor: selectedColor,
    onSelectColor: onSelectColorCb
  })));
};

var CompactColorPicker = function CompactColorPicker(_ref2) {
  var color = _ref2.color,
      onSetColor = _ref2.onSetColor,
      Icon = _ref2.Icon,
      label = _ref2.label;

  var _React$useState = _react["default"].useState(false),
      _React$useState2 = (0, _slicedToArray2["default"])(_React$useState, 2),
      isColorPickerOpened = _React$useState2[0],
      setIsColorPickerOpened = _React$useState2[1];

  var hexColor = (0, _react.useMemo)(function () {
    return (0, _utils.rgbToHex)(color);
  }, [color]);
  var colorBlockStyle = (0, _react.useMemo)(function () {
    return {
      width: 16,
      height: 16,
      backgroundColor: hexColor,
      borderRadius: 2
    };
  }, [hexColor]);
  var toggleDropdown = (0, _react.useCallback)(function () {
    setIsColorPickerOpened(!isColorPickerOpened);
  }, [isColorPickerOpened, setIsColorPickerOpened]);
  var closeDropdown = (0, _react.useCallback)(function () {
    setIsColorPickerOpened(false);
  }, [setIsColorPickerOpened]);
  return /*#__PURE__*/_react["default"].createElement(StyledConfigSection, null, /*#__PURE__*/_react["default"].createElement(SectionTitle, null, label), /*#__PURE__*/_react["default"].createElement(StyledDropdownButtonWrapper, null, /*#__PURE__*/_react["default"].createElement(_styledComponents2.Button, {
    onClick: toggleDropdown
  }, /*#__PURE__*/_react["default"].createElement("div", {
    style: colorBlockStyle
  }), /*#__PURE__*/_react["default"].createElement(Icon, null))), /*#__PURE__*/_react["default"].createElement(SingleColorPickerDropdown, {
    isOpened: isColorPickerOpened,
    onClose: closeDropdown,
    selectedColor: hexColor,
    onSelectColor: onSetColor
  }));
};

var _default = CompactColorPicker;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9lZmZlY3RzL2NvbXBhY3QtY29sb3ItcGlja2VyLnRzeCJdLCJuYW1lcyI6WyJTdHlsZWRQYW5lbERyb3Bkb3duIiwic3R5bGVkIiwiZGl2IiwicHJvcHMiLCJ0aGVtZSIsInBhbmVsRHJvcGRvd25TY3JvbGxCYXIiLCJwYW5lbEJhY2tncm91bmQiLCJwYW5lbEJveFNoYWRvdyIsInBhbmVsQm9yZGVyUmFkaXVzIiwiU3R5bGVkQ29uZmlnU2VjdGlvbiIsIlNlY3Rpb25UaXRsZSIsImlucHV0Rm9udFNpemUiLCJlZmZlY3RQYW5lbFRleHRTZWNvbmRhcnkyIiwiU3R5bGVkRHJvcGRvd25CdXR0b25XcmFwcGVyIiwiaW5wdXRCZ2QiLCJlZmZlY3RQYW5lbFRleHRNYWluIiwiaW5wdXRCZ2RIb3ZlciIsIkRFRkFVTFRfT0ZGU0VUIiwidG9wIiwibGVmdCIsIlNpbmdsZUNvbG9yUGlja2VyRHJvcGRvd24iLCJpc09wZW5lZCIsIm9uQ2xvc2UiLCJzZWxlY3RlZENvbG9yIiwib25TZWxlY3RDb2xvciIsIm9mZnNldCIsIm9uU2VsZWN0Q29sb3JDYiIsInYiLCJDb21wYWN0Q29sb3JQaWNrZXIiLCJjb2xvciIsIm9uU2V0Q29sb3IiLCJJY29uIiwibGFiZWwiLCJSZWFjdCIsInVzZVN0YXRlIiwiaXNDb2xvclBpY2tlck9wZW5lZCIsInNldElzQ29sb3JQaWNrZXJPcGVuZWQiLCJoZXhDb2xvciIsImNvbG9yQmxvY2tTdHlsZSIsIndpZHRoIiwiaGVpZ2h0IiwiYmFja2dyb3VuZENvbG9yIiwiYm9yZGVyUmFkaXVzIiwidG9nZ2xlRHJvcGRvd24iLCJjbG9zZURyb3Bkb3duIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFHQTs7QUFDQTs7QUFFQTs7QUFFQTs7QUFDQTs7OztBQVNPLElBQU1BLG1CQUFtQixHQUFHQyw2QkFBT0MsR0FBViw2UUFDNUIsVUFBQUMsS0FBSztBQUFBLFNBQUlBLEtBQUssQ0FBQ0MsS0FBTixDQUFZQyxzQkFB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IFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBNSVRcbi8vIENvcHlyaWdodCBjb250cmlidXRvcnMgdG8gdGhlIGtlcGxlci5nbCBwcm9qZWN0XG5cbmltcG9ydCBSZWFjdCwge3VzZUNhbGxiYWNrLCB1c2VNZW1vfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgc3R5bGVkIGZyb20gJ3N0eWxlZC1jb21wb25lbnRzJztcblxuaW1wb3J0IHtyZ2JUb0hleH0gZnJvbSAnQGtlcGxlci5nbC91dGlscyc7XG5cbmltcG9ydCB7UG9ydGFsZWQsIFNpbmdsZUNvbG9yUGFsZXR0ZX0gZnJvbSAnLi4vLi4vLi4vY29tcG9uZW50cyc7XG5pbXBvcnQge0J1dHRvbn0gZnJvbSAnLi4vY29tbW9uL3N0eWxlZC1jb21wb25lbnRzJztcblxuZXhwb3J0IHR5cGUgU2luZ2xlQ29sb3JQaWNrZXJQcm9wcyA9IHtcbiAgY29sb3I6IFtudW1iZXIsIG51bWJlciwgbnVtYmVyXTtcbiAgb25TZXRDb2xvcjogKHZhbHVlOiBbbnVtYmVyLCBudW1iZXIsIG51bWJlcl0pID0+IHZvaWQ7XG4gIGxhYmVsOiBzdHJpbmc7XG4gIEljb246IFJlYWN0LkVsZW1lbnRUeXBlO1xufTtcblxuZXhwb3J0IGNvbnN0IFN0eWxlZFBhbmVsRHJvcGRvd24gPSBzdHlsZWQuZGl2YFxuICAke3Byb3BzID0+IHByb3BzLnRoZW1lLnBhbmVsRHJvcGRvd25TY3JvbGxCYXJ9XG4gIGJhY2tncm91bmQtY29sb3I6ICR7cHJvcHMgPT4gcHJvcHMudGhlbWUucGFuZWxCYWNrZ3JvdW5kfTtcbiAgYm94LXNoYWRvdzogJHtwcm9wcyA9PiBwcm9wcy50aGVtZS5wYW5lbEJveFNoYWRvd307XG4gIGJvcmRlci1yYWRpdXM6ICR7cHJvcHMgPT4gcHJvcHMudGhlbWUucGFuZWxCb3JkZXJSYWRpdXN9O1xuICBvdmVyZmxvdy15OiBhdXRvO1xuICBtYXgtaGVpZ2h0OiA1MDBweDtcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xuICB6LWluZGV4OiA5OTk7XG4gIHdpZHRoOiAyMjBweDtcbmA7XG5cbmNvbnN0IFN0eWxlZENvbmZpZ1NlY3Rpb24gPSBzdHlsZWQuZGl2YFxuICBkaXNwbGF5OiBmbGV4O1xuICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuYDtcblxuY29uc3QgU2VjdGlvblRpdGxlID0gc3R5bGVkLmRpdmBcbiAgZm9udC1zaXplOiAke3Byb3BzID0+IHByb3BzLnRoZW1lLmlucHV0Rm9udFNpemV9O1xuICBjb2xvcjogJHtwcm9wcyA9PiBwcm9wcy50aGVtZS5lZmZlY3RQYW5lbFRleHRTZWNvbmRhcnkyfTtcbiAgbWFyZ2luLWJvdHRvbTogOHB4O1xuYDtcblxuY29uc3QgU3R5bGVkRHJvcGRvd25CdXR0b25XcmFwcGVyID0gc3R5bGVkLmRpdmBcbiAgYWxpZ24tc2VsZjogZmxleC1zdGFydDtcbiAgLmJ1dHRvbiB7XG4gICAgY29sb3I6ICR7cHJvcHMgPT4gcHJvcHMudGhlbWUuZWZmZWN0UGFuZWxUZXh0U2Vjb25kYXJ5Mn07XG4gICAgZGlzcGxheTogZmxleDtcbiAgICBnYXA6IDVweDtcbiAgICBib3JkZXI6IG5vbmU7XG4gICAgdHJhbnNpdGlvbjogYmFja2dyb3VuZCAwLjJzO1xuICAgIGJhY2tncm91bmQtY29sb3I6ICR7cHJvcHMgPT4gcHJvcHMudGhlbWUuaW5wdXRCZ2R9O1xuICAgIHBhZGRpbmc6IDhweCA1cHggOHB4IDEwcHg7XG4gICAgJjphY3RpdmUge1xuICAgICAgY29sb3I6ICR7cHJvcHMgPT4gcHJvcHMudGhlbWUuZWZmZWN0UGFuZWxUZXh0TWFpbn07XG4gICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAke3Byb3BzID0+IHByb3BzLnRoZW1lLmlucHV0QmdkSG92ZXJ9O1xuICAgIH1cbiAgICAmOmhvdmVyIHtcbiAgICAgIGNvbG9yOiAke3Byb3BzID0+IHByb3BzLnRoZW1lLmVmZmVjdFBhbmVsVGV4dE1haW59O1xuICAgICAgYmFja2dyb3VuZC1jb2xvcjogJHtwcm9wcyA9PiBwcm9wcy50aGVtZS5pbnB1dEJnZEhvdmVyfTtcbiAgICB9XG4gICAgJiA+IHN2ZyB7XG4gICAgICBtYXJnaW4tcmlnaHQ6IDA7XG4gICAgfVxuICB9XG5gO1xuXG5jb25zdCBERUZBVUxUX09GRlNFVCA9IHtcbiAgdG9wOiAwLFxuICBsZWZ0OiAwXG59O1xuXG5jb25zdCBTaW5nbGVDb2xvclBpY2tlckRyb3Bkb3duID0gKHtcbiAgaXNPcGVuZWQsXG4gIG9uQ2xvc2UsXG4gIHNlbGVjdGVkQ29sb3IsXG4gIG9uU2VsZWN0Q29sb3IsXG4gIG9mZnNldCA9IERFRkFVTFRfT0ZGU0VUXG59KSA9PiB7XG4gIGNvbnN0IG9uU2VsZWN0Q29sb3JDYiA9IHVzZUNhbGxiYWNrKFxuICAgIHYgPT4ge1xuICAgICAgb25TZWxlY3RDb2xvcih2KTtcbiAgICB9LFxuICAgIFtvblNlbGVjdENvbG9yXVxuICApO1xuICByZXR1cm4gKFxuICAgIDxQb3J0YWxlZCB0b3A9e29mZnNldC50b3B9IGxlZnQ9e29mZnNldC5sZWZ0fSBpc09wZW5lZD17aXNPcGVuZWR9IG9uQ2xvc2U9e29uQ2xvc2V9PlxuICAgICAgPFN0eWxlZFBhbmVsRHJvcGRvd24+XG4gICAgICAgIDxTaW5nbGVDb2xvclBhbGV0dGUgc2VsZWN0ZWRDb2xvcj17c2VsZWN0ZWRDb2xvcn0gb25TZWxlY3RDb2xvcj17b25TZWxlY3RDb2xvckNifSAvPlxuICAgICAgPC9TdHlsZWRQYW5lbERyb3Bkb3duPlxuICAgIDwvUG9ydGFsZWQ+XG4gICk7XG59O1xuXG5jb25zdCBDb21wYWN0Q29sb3JQaWNrZXI6IFJlYWN0LkZDPFNpbmdsZUNvbG9yUGlja2VyUHJvcHM+ID0gKHtcbiAgY29sb3IsXG4gIG9uU2V0Q29sb3IsXG4gIEljb24sXG4gIGxhYmVsXG59OiBTaW5nbGVDb2xvclBpY2tlclByb3BzKSA9PiB7XG4gIGNvbnN0IFtpc0NvbG9yUGlja2VyT3BlbmVkLCBzZXRJc0NvbG9yUGlja2VyT3BlbmVkXSA9IFJlYWN0LnVzZVN0YXRlKGZhbHNlKTtcblxuICBjb25zdCBoZXhDb2xvciA9IHVzZU1lbW8oKCkgPT4ge1xuICAgIHJldHVybiByZ2JUb0hleChjb2xvcik7XG4gIH0sIFtjb2xvcl0pO1xuXG4gIGNvbnN0IGNvbG9yQmxvY2tTdHlsZSA9IHVzZU1lbW8oXG4gICAgKCkgPT4gKHtcbiAgICAgIHdpZHRoOiAxNixcbiAgICAgIGhlaWdodDogMTYsXG4gICAgICBiYWNrZ3JvdW5kQ29sb3I6IGhleENvbG9yLFxuICAgICAgYm9yZGVyUmFkaXVzOiAyXG4gICAgfSksXG4gICAgW2hleENvbG9yXVxuICApO1xuXG4gIGNvbnN0IHRvZ2dsZURyb3Bkb3duID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIHNldElzQ29sb3JQaWNrZXJPcGVuZWQoIWlzQ29sb3JQaWNrZXJPcGVuZWQpO1xuICB9LCBbaXNDb2xvclBpY2tlck9wZW5lZCwgc2V0SXNDb2xvclBpY2tlck9wZW5lZF0pO1xuXG4gIGNvbnN0IGNsb3NlRHJvcGRvd24gPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgc2V0SXNDb2xvclBpY2tlck9wZW5lZChmYWxzZSk7XG4gIH0sIFtzZXRJc0NvbG9yUGlja2VyT3BlbmVkXSk7XG5cbiAgcmV0dXJuIChcbiAgICA8U3R5bGVkQ29uZmlnU2VjdGlvbj5cbiAgICAgIDxTZWN0aW9uVGl0bGU+e2xhYmVsfTwvU2VjdGlvblRpdGxlPlxuICAgICAgPFN0eWxlZERyb3Bkb3duQnV0dG9uV3JhcHBlcj5cbiAgICAgICAgPEJ1dHRvbiBvbkNsaWNrPXt0b2dnbGVEcm9wZG93bn0+XG4gICAgICAgICAgPGRpdiBzdHlsZT17Y29sb3JCbG9ja1N0eWxlfSAvPlxuICAgICAgICAgIDxJY29uIC8+XG4gICAgICAgIDwvQnV0dG9uPlxuICAgICAgPC9TdHlsZWREcm9wZG93bkJ1dHRvbldyYXBwZXI+XG4gICAgICA8U2luZ2xlQ29sb3JQaWNrZXJEcm9wZG93blxuICAgICAgICBpc09wZW5lZD17aXNDb2xvclBpY2tlck9wZW5lZH1cbiAgICAgICAgb25DbG9zZT17Y2xvc2VEcm9wZG93bn1cbiAgICAgICAgc2VsZWN0ZWRDb2xvcj17aGV4Q29sb3J9XG4gICAgICAgIG9uU2VsZWN0Q29sb3I9e29uU2V0Q29sb3J9XG4gICAgICAvPlxuICAgIDwvU3R5bGVkQ29uZmlnU2VjdGlvbj5cbiAgKTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IENvbXBhY3RDb2xvclBpY2tlcjtcbiJdfQ==
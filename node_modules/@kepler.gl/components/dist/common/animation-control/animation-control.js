"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _taggedTemplateLiteral2 = _interopRequireDefault(require("@babel/runtime/helpers/taggedTemplateLiteral"));

var _react = _interopRequireDefault(require("react"));

var _styledComponents = _interopRequireDefault(require("styled-components"));

var _classnames = _interopRequireDefault(require("classnames"));

var _styles = require("@kepler.gl/styles");

var _timelineSlider = _interopRequireDefault(require("../timeline-slider"));

var _playbackControls = _interopRequireDefault(require("./playback-controls"));

var _floatingTimeDisplay = _interopRequireDefault(require("./floating-time-display"));

var _templateObject, _templateObject2, _templateObject3, _templateObject4;

var SLIDER_MARGIN_PALM = 6;

var AnimationControlContainer = _styledComponents["default"].div(_templateObject || (_templateObject = (0, _taggedTemplateLiteral2["default"])(["\n  padding: ", ";\n  position: relative;\n  margin-top: ", "px;\n\n  ", "\n"])), function (props) {
  return "".concat(props.theme.bottomInnerPdVert, "px ").concat(props.theme.bottomInnerPdSide, "px");
}, function (props) {
  return props.theme.bottomPanelGap;
}, _styles.media.portable(_templateObject2 || (_templateObject2 = (0, _taggedTemplateLiteral2["default"])(["\n    border-top: 1px solid ", ";\n    border-left: 1px solid ", ";\n    padding: 12px 12px;\n    margin-top: 0;\n  "])), function (props) {
  return props.theme.panelBorderColor;
}, function (props) {
  return props.theme.panelBorderColor;
}));

var AnimationWidgetInner = _styledComponents["default"].div(_templateObject3 || (_templateObject3 = (0, _taggedTemplateLiteral2["default"])(["\n  position: relative;\n  display: flex;\n  align-items: center;\n\n  .animation-control__time-slider {\n    display: flex;\n    align-items: center;\n    height: 32px;\n    width: 100%;\n  }\n  .playback-controls {\n    margin-left: 16px;\n  }\n\n  ", ";\n"])), _styles.media.palm(_templateObject4 || (_templateObject4 = (0, _taggedTemplateLiteral2["default"])(["\n    flex-direction: column;\n    .playback-controls {\n      margin: 0;\n    }\n    .animation-control__time-slider {\n      width: 100%;\n      position: relative;\n    }\n    .animation-control__time-domain {\n      position: absolute;\n      top: -24px;\n\n      &.domain-start {\n        left: ", "px;\n      }\n      &.domain-end {\n        right: ", "px;\n      }\n    }\n  "])), SLIDER_MARGIN_PALM, SLIDER_MARGIN_PALM));

var TIMELINE_PLAYBACK_STYLE = {
  flex: 1
};
AnimationControlFactory.deps = [_playbackControls["default"], _floatingTimeDisplay["default"], _timelineSlider["default"]];

function AnimationControlFactory(PlaybackControls, FloatingTimeDisplay, TimelineSlider) {
  var AnimationControl = function AnimationControl(_ref) {
    var className = _ref.className,
        style = _ref.style,
        isAnimatable = _ref.isAnimatable,
        isAnimating = _ref.isAnimating,
        resetAnimation = _ref.resetAnimation,
        toggleAnimation = _ref.toggleAnimation,
        updateAnimationSpeed = _ref.updateAnimationSpeed,
        setTimelineValue = _ref.setTimelineValue,
        setAnimationWindow = _ref.setAnimationWindow,
        timeline = _ref.timeline,
        _ref$showTimeline = _ref.showTimeline,
        showTimeline = _ref$showTimeline === void 0 ? true : _ref$showTimeline,
        _ref$showControls = _ref.showControls,
        showControls = _ref$showControls === void 0 ? true : _ref$showControls,
        _ref$showTimeDisplay = _ref.showTimeDisplay,
        showTimeDisplay = _ref$showTimeDisplay === void 0 ? true : _ref$showTimeDisplay;

    if (!timeline) {
      return null;
    }

    var animationWindow = timeline.animationWindow,
        value = timeline.value,
        speed = timeline.speed,
        defaultTimeFormat = timeline.defaultTimeFormat,
        timeFormat = timeline.timeFormat,
        timezone = timeline.timezone;
    return /*#__PURE__*/_react["default"].createElement(AnimationControlContainer, {
      style: style,
      className: (0, _classnames["default"])('animation-control-container', className)
    }, /*#__PURE__*/_react["default"].createElement(AnimationWidgetInner, {
      className: "animation-widget--inner"
    }, showTimeline ? /*#__PURE__*/_react["default"].createElement(TimelineSlider, {
      style: TIMELINE_PLAYBACK_STYLE,
      timeline: timeline,
      setTimelineValue: setTimelineValue
    }) : null, showControls ? /*#__PURE__*/_react["default"].createElement(PlaybackControls, {
      className: "animation-control-playpause",
      isAnimatable: isAnimatable,
      startAnimation: toggleAnimation,
      isAnimating: isAnimating,
      pauseAnimation: toggleAnimation,
      resetAnimation: resetAnimation,
      speed: speed,
      updateAnimationSpeed: updateAnimationSpeed,
      setFilterAnimationWindow: setAnimationWindow,
      animationWindow: animationWindow
    }) : null), showTimeDisplay ? /*#__PURE__*/_react["default"].createElement(FloatingTimeDisplay, {
      currentTime: value,
      defaultTimeFormat: defaultTimeFormat,
      timeFormat: timeFormat,
      timezone: timezone
    }) : null);
  };

  AnimationControl.defaultProps = {
    toggleAnimation: function toggleAnimation() {},
    updateAnimationSpeed: function updateAnimationSpeed() {}
  };
  return AnimationControl;
}

var _default = AnimationControlFactory;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb21tb24vYW5pbWF0aW9uLWNvbnRyb2wvYW5pbWF0aW9uLWNvbnRyb2wudHN4Il0sIm5hbWVzIjpbIlNMSURFUl9NQVJHSU5fUEFMTSIsIkFuaW1hdGlvbkNvbnRyb2xDb250YWluZXIiLCJzdHlsZWQiLCJkaXYiLCJwcm9wcyIsInRoZW1lIiwiYm90dG9tSW5uZXJQZFZlcnQiLCJib3R0b21Jbm5lclBkU2lkZSIsImJvdHRvbVBhbmVsR2FwIiwibWVkaWEiLCJwb3J0YWJsZSIsInBhbmVsQm9yZGVyQ29sb3IiLCJBbmltYXRpb25XaWRnZXRJbm5lciIsInBhbG0iLCJUSU1FTElORV9QTEFZQkFDS19TVFlMRSIsImZsZXgiLCJBbmltYXRpb25Db250cm9sRmFjdG9yeSIsImRlcHMiLCJQbGF5YmFja0NvbnRyb2xzRmFjdG9yeSIsIkZsb2F0aW5nVGltZURpc3BsYXlGYWN0b3J5IiwiVGltZWxpbmVTbGlkZXJGYWN0b3J5IiwiUGxheWJhY2tDb250cm9scyIsIkZsb2F0aW5nVGltZURpc3BsYXkiLCJUaW1lbGluZVNsaWRlciIsIkFuaW1hdGlvbkNvbnRyb2wiLCJjbGFzc05hbWUiLCJzdHlsZSIsImlzQW5pbWF0YWJsZSIsImlzQW5pbWF0aW5nIiwicmVzZXRBbmltYXRpb24iLCJ0b2dnbGVBbmltYXRpb24iLCJ1cGRhdGVBbmltYXRpb25TcGVlZCIsInNldFRpbWVsaW5lVmFsdWUiLCJzZXRBbmltYXRpb25XaW5kb3ciLCJ0aW1lbGluZSIsInNob3dUaW1lbGluZSIsInNob3dDb250cm9scyIsInNob3dUaW1lRGlzcGxheSIsImFuaW1hdGlvbldpbmRvdyIsInZhbHVlIiwic3BlZWQiLCJkZWZhdWx0VGltZUZvcm1hdCIsInRpbWVGb3JtYXQiLCJ0aW1lem9uZSIsImRlZmF1bHRQcm9wcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFHQTs7QUFDQTs7QUFDQTs7QUFFQTs7QUFHQTs7QUFDQTs7QUFDQTs7OztBQUVBLElBQU1B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QWMsRUFBRUcsZUFIbEI7QUFJRSxNQUFBLFdBQVcsRUFBRUYsV0FKZjtBQUtFLE1BQUEsY0FBYyxFQUFFRSxlQUxsQjtBQU1FLE1BQUEsY0FBYyxFQUFFRCxjQU5sQjtBQU9FLE1BQUEsS0FBSyxFQUFFVyxLQVBUO0FBUUUsTUFBQSxvQkFBb0IsRUFBRVQsb0JBUnhCO0FBU0UsTUFBQSx3QkFBd0IsRUFBRUUsa0JBVDVCO0FBVUUsTUFBQSxlQUFlLEVBQUVLO0FBVm5CLE1BRFcsR0FhVCxJQXJCTixDQUpGLEVBMkJHRCxlQUFlLGdCQUNkLGdDQUFDLG1CQUFEO0FBQ0UsTUFBQSxXQUFXLEVBQUVFLEtBRGY7QUFFRSxNQUFBLGlCQUFpQixFQUFFRSxpQkFGckI7QUFHRSxNQUFBLFVBQVUsRUFBRUMsVUFIZDtBQUlFLE1BQUEsUUFBUSxFQUFFQztBQUpaLE1BRGMsR0FPWixJQWxDTixDQURGO0FBc0NELEdBM0REOztBQTZEQW5CLEVBQUFBLGdCQUFnQixDQUFDb0IsWUFBakIsR0FBZ0M7QUFDOUJkLElBQUFBLGVBQWUsRUFBRSwyQkFBTSxDQUFFLENBREs7QUFFOUJDLElBQUFBLG9CQUFvQixFQUFFLGdDQUFNLENBQUU7QUFGQSxHQUFoQztBQUtBLFNBQU9QLGdCQUFQO0FBQ0Q7O2VBRWNSLHVCIiwic291cmNlc0NvbnRlbnQiOlsiLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVFxuLy8gQ29weXJpZ2h0IGNvbnRyaWJ1dG9ycyB0byB0aGUga2VwbGVyLmdsIHByb2plY3RcblxuaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCBzdHlsZWQgZnJvbSAnc3R5bGVkLWNvbXBvbmVudHMnO1xuaW1wb3J0IGNsYXNzbmFtZXMgZnJvbSAnY2xhc3NuYW1lcyc7XG5cbmltcG9ydCB7bWVkaWF9IGZyb20gJ0BrZXBsZXIuZ2wvc3R5bGVzJztcbmltcG9ydCB7VGltZWxpbmV9IGZyb20gJ0BrZXBsZXIuZ2wvdHlwZXMnO1xuXG5pbXBvcnQgVGltZWxpbmVTbGlkZXJGYWN0b3J5IGZyb20gJy4uL3RpbWVsaW5lLXNsaWRlcic7XG5pbXBvcnQgUGxheWJhY2tDb250cm9sc0ZhY3RvcnkgZnJvbSAnLi9wbGF5YmFjay1jb250cm9scyc7XG5pbXBvcnQgRmxvYXRpbmdUaW1lRGlzcGxheUZhY3RvcnkgZnJvbSAnLi9mbG9hdGluZy10aW1lLWRpc3BsYXknO1xuXG5jb25zdCBTTElERVJfTUFSR0lOX1BBTE0gPSA2O1xuXG5jb25zdCBBbmltYXRpb25Db250cm9sQ29udGFpbmVyID0gc3R5bGVkLmRpdmBcbiAgcGFkZGluZzogJHtwcm9wcyA9PiBgJHtwcm9wcy50aGVtZS5ib3R0b21Jbm5lclBkVmVydH1weCAke3Byb3BzLnRoZW1lLmJvdHRvbUlubmVyUGRTaWRlfXB4YH07XG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgbWFyZ2luLXRvcDogJHtwcm9wcyA9PiBwcm9wcy50aGVtZS5ib3R0b21QYW5lbEdhcH1weDtcblxuICAke21lZGlhLnBvcnRhYmxlYFxuICAgIGJvcmRlci10b3A6IDFweCBzb2xpZCAke3Byb3BzID0+IHByb3BzLnRoZW1lLnBhbmVsQm9yZGVyQ29sb3J9O1xuICAgIGJvcmRlci1sZWZ0OiAxcHggc29saWQgJHtwcm9wcyA9PiBwcm9wcy50aGVtZS5wYW5lbEJvcmRlckNvbG9yfTtcbiAgICBwYWRkaW5nOiAxMnB4IDEycHg7XG4gICAgbWFyZ2luLXRvcDogMDtcbiAgYH1cbmA7XG5cbmNvbnN0IEFuaW1hdGlvbldpZGdldElubmVyID0gc3R5bGVkLmRpdmBcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xuICBkaXNwbGF5OiBmbGV4O1xuICBhbGlnbi1pdGVtczogY2VudGVyO1xuXG4gIC5hbmltYXRpb24tY29udHJvbF9fdGltZS1zbGlkZXIge1xuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICBoZWlnaHQ6IDMycHg7XG4gICAgd2lkdGg6IDEwMCU7XG4gIH1cbiAgLnBsYXliYWNrLWNvbnRyb2xzIHtcbiAgICBtYXJnaW4tbGVmdDogMTZweDtcbiAgfVxuXG4gICR7bWVkaWEucGFsbWBcbiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICAgIC5wbGF5YmFjay1jb250cm9scyB7XG4gICAgICBtYXJnaW46IDA7XG4gICAgfVxuICAgIC5hbmltYXRpb24tY29udHJvbF9fdGltZS1zbGlkZXIge1xuICAgICAgd2lkdGg6IDEwMCU7XG4gICAgICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gICAgfVxuICAgIC5hbmltYXRpb24tY29udHJvbF9fdGltZS1kb21haW4ge1xuICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgdG9wOiAtMjRweDtcblxuICAgICAgJi5kb21haW4tc3RhcnQge1xuICAgICAgICBsZWZ0OiAke1NMSURFUl9NQVJHSU5fUEFMTX1weDtcbiAgICAgIH1cbiAgICAgICYuZG9tYWluLWVuZCB7XG4gICAgICAgIHJpZ2h0OiAke1NMSURFUl9NQVJHSU5fUEFMTX1weDtcbiAgICAgIH1cbiAgICB9XG4gIGB9O1xuYDtcblxuY29uc3QgVElNRUxJTkVfUExBWUJBQ0tfU1RZTEUgPSB7ZmxleDogMX07XG5cbmV4cG9ydCB0eXBlIEFuaW1hdGlvbkNvbnRyb2xQcm9wcyA9IHtcbiAgdGltZWxpbmU/OiBUaW1lbGluZTtcbiAgaXNBbmltYXRhYmxlPzogYm9vbGVhbjtcbiAgaXNBbmltYXRpbmc/OiBib29sZWFuO1xuICB1cGRhdGVBbmltYXRpb25TcGVlZD86ICh2YWw6IG51bWJlcikgPT4gdm9pZDtcbiAgc2V0QW5pbWF0aW9uV2luZG93PzogKGlkOiBzdHJpbmcpID0+IHZvaWQ7XG4gIHRvZ2dsZUFuaW1hdGlvbjogKCkgPT4gdm9pZDtcbiAgcmVzZXRBbmltYXRpb24/OiAoKSA9PiB2b2lkO1xuICBzZXRUaW1lbGluZVZhbHVlOiAodmFsdWU6IG51bWJlcltdKSA9PiB2b2lkO1xuICBzaG93VGltZURpc3BsYXk/OiBib29sZWFuO1xuICBzaG93VGltZWxpbmU/OiBib29sZWFuO1xuICBzaG93Q29udHJvbHM/OiBib29sZWFuO1xuICBjbGFzc05hbWU/OiBzdHJpbmc7XG4gIHN0eWxlPzogb2JqZWN0O1xufTtcblxuQW5pbWF0aW9uQ29udHJvbEZhY3RvcnkuZGVwcyA9IFtcbiAgUGxheWJhY2tDb250cm9sc0ZhY3RvcnksXG4gIEZsb2F0aW5nVGltZURpc3BsYXlGYWN0b3J5LFxuICBUaW1lbGluZVNsaWRlckZhY3Rvcnlcbl07XG5cbmZ1bmN0aW9uIEFuaW1hdGlvbkNvbnRyb2xGYWN0b3J5KFxuICBQbGF5YmFja0NvbnRyb2xzOiBSZXR1cm5UeXBlPHR5cGVvZiBQbGF5YmFja0NvbnRyb2xzRmFjdG9yeT4sXG4gIEZsb2F0aW5nVGltZURpc3BsYXk6IFJldHVyblR5cGU8dHlwZW9mIEZsb2F0aW5nVGltZURpc3BsYXlGYWN0b3J5PixcbiAgVGltZWxpbmVTbGlkZXI6IFJldHVyblR5cGU8dHlwZW9mIFRpbWVsaW5lU2xpZGVyRmFjdG9yeT5cbikge1xuICBjb25zdCBBbmltYXRpb25Db250cm9sOiBSZWFjdC5GQzxBbmltYXRpb25Db250cm9sUHJvcHM+ID0gKHtcbiAgICBjbGFzc05hbWUsXG4gICAgc3R5bGUsXG4gICAgaXNBbmltYXRhYmxlLFxuICAgIGlzQW5pbWF0aW5nLFxuICAgIHJlc2V0QW5pbWF0aW9uLFxuICAgIHRvZ2dsZUFuaW1hdGlvbixcbiAgICB1cGRhdGVBbmltYXRpb25TcGVlZCxcbiAgICBzZXRUaW1lbGluZVZhbHVlLFxuICAgIHNldEFuaW1hdGlvbldpbmRvdyxcbiAgICB0aW1lbGluZSxcbiAgICBzaG93VGltZWxpbmUgPSB0cnVlLFxuICAgIHNob3dDb250cm9scyA9IHRydWUsXG4gICAgc2hvd1RpbWVEaXNwbGF5ID0gdHJ1ZVxuICB9KSA9PiB7XG4gICAgaWYgKCF0aW1lbGluZSkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgY29uc3Qge2FuaW1hdGlvbldpbmRvdywgdmFsdWUsIHNwZWVkLCBkZWZhdWx0VGltZUZvcm1hdCwgdGltZUZvcm1hdCwgdGltZXpvbmV9ID0gdGltZWxpbmU7XG5cbiAgICByZXR1cm4gKFxuICAgICAgPEFuaW1hdGlvbkNvbnRyb2xDb250YWluZXJcbiAgICAgICAgc3R5bGU9e3N0eWxlfVxuICAgICAgICBjbGFzc05hbWU9e2NsYXNzbmFtZXMoJ2FuaW1hdGlvbi1jb250cm9sLWNvbnRhaW5lcicsIGNsYXNzTmFtZSl9XG4gICAgICA+XG4gICAgICAgIDxBbmltYXRpb25XaWRnZXRJbm5lciBjbGFzc05hbWU9XCJhbmltYXRpb24td2lkZ2V0LS1pbm5lclwiPlxuICAgICAgICAgIHtzaG93VGltZWxpbmUgPyAoXG4gICAgICAgICAgICA8VGltZWxpbmVTbGlkZXJcbiAgICAgICAgICAgICAgc3R5bGU9e1RJTUVMSU5FX1BMQVlCQUNLX1NUWUxFfVxuICAgICAgICAgICAgICB0aW1lbGluZT17dGltZWxpbmV9XG4gICAgICAgICAgICAgIHNldFRpbWVsaW5lVmFsdWU9e3NldFRpbWVsaW5lVmFsdWV9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgIHtzaG93Q29udHJvbHMgPyAoXG4gICAgICAgICAgICA8UGxheWJhY2tDb250cm9sc1xuICAgICAgICAgICAgICBjbGFzc05hbWU9XCJhbmltYXRpb24tY29udHJvbC1wbGF5cGF1c2VcIlxuICAgICAgICAgICAgICBpc0FuaW1hdGFibGU9e2lzQW5pbWF0YWJsZX1cbiAgICAgICAgICAgICAgc3RhcnRBbmltYXRpb249e3RvZ2dsZUFuaW1hdGlvbn1cbiAgICAgICAgICAgICAgaXNBbmltYXRpbmc9e2lzQW5pbWF0aW5nfVxuICAgICAgICAgICAgICBwYXVzZUFuaW1hdGlvbj17dG9nZ2xlQW5pbWF0aW9ufVxuICAgICAgICAgICAgICByZXNldEFuaW1hdGlvbj17cmVzZXRBbmltYXRpb259XG4gICAgICAgICAgICAgIHNwZWVkPXtzcGVlZH1cbiAgICAgICAgICAgICAgdXBkYXRlQW5pbWF0aW9uU3BlZWQ9e3VwZGF0ZUFuaW1hdGlvblNwZWVkfVxuICAgICAgICAgICAgICBzZXRGaWx0ZXJBbmltYXRpb25XaW5kb3c9e3NldEFuaW1hdGlvbldpbmRvd31cbiAgICAgICAgICAgICAgYW5pbWF0aW9uV2luZG93PXthbmltYXRpb25XaW5kb3d9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICA8L0FuaW1hdGlvbldpZGdldElubmVyPlxuICAgICAgICB7c2hvd1RpbWVEaXNwbGF5ID8gKFxuICAgICAgICAgIDxGbG9hdGluZ1RpbWVEaXNwbGF5XG4gICAgICAgICAgICBjdXJyZW50VGltZT17dmFsdWV9XG4gICAgICAgICAgICBkZWZhdWx0VGltZUZvcm1hdD17ZGVmYXVsdFRpbWVGb3JtYXR9XG4gICAgICAgICAgICB0aW1lRm9ybWF0PXt0aW1lRm9ybWF0fVxuICAgICAgICAgICAgdGltZXpvbmU9e3RpbWV6b25lfVxuICAgICAgICAgIC8+XG4gICAgICAgICkgOiBudWxsfVxuICAgICAgPC9BbmltYXRpb25Db250cm9sQ29udGFpbmVyPlxuICAgICk7XG4gIH07XG5cbiAgQW5pbWF0aW9uQ29udHJvbC5kZWZhdWx0UHJvcHMgPSB7XG4gICAgdG9nZ2xlQW5pbWF0aW9uOiAoKSA9PiB7fSxcbiAgICB1cGRhdGVBbmltYXRpb25TcGVlZDogKCkgPT4ge31cbiAgfTtcblxuICByZXR1cm4gQW5pbWF0aW9uQ29udHJvbDtcbn1cblxuZXhwb3J0IGRlZmF1bHQgQW5pbWF0aW9uQ29udHJvbEZhY3Rvcnk7XG4iXX0=
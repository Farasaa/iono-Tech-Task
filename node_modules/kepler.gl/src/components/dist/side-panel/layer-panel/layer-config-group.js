"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.LayerConfigGroupLabelFactory = LayerConfigGroupLabelFactory;
exports["default"] = exports.StyledConfigGroupHeader = exports.StyledLayerConfigGroup = exports.ConfigGroupCollapsibleHeader = exports.ConfigGroupCollapsibleContent = exports.StyledLayerConfigGroupAction = void 0;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));

var _taggedTemplateLiteral2 = _interopRequireDefault(require("@babel/runtime/helpers/taggedTemplateLiteral"));

var _react = _interopRequireWildcard(require("react"));

var _styledComponents = _interopRequireDefault(require("styled-components"));

var _classnames = _interopRequireDefault(require("classnames"));

var _reactIntl = require("react-intl");

var _switch = _interopRequireDefault(require("../../common/switch"));

var _infoHelper = _interopRequireDefault(require("../../common/info-helper"));

var _icons = require("../../common/icons");

var _templateObject, _templateObject2, _templateObject3, _templateObject4, _templateObject5, _templateObject6, _templateObject7;

var StyledLayerConfigGroupAction = _styledComponents["default"].div(_templateObject || (_templateObject = (0, _taggedTemplateLiteral2["default"])(["\n  display: flex;\n  align-items: center;\n  color: ", ";\n"])), function (props) {
  return props.theme.textColor;
});

exports.StyledLayerConfigGroupAction = StyledLayerConfigGroupAction;

var ConfigGroupCollapsibleContent = _styledComponents["default"].div.attrs({
  className: 'layer-config-group__content__collapsible'
})(_templateObject2 || (_templateObject2 = (0, _taggedTemplateLiteral2["default"])(["\n  transition: max-height 0.3s ease-out;\n  height: max-content;\n  max-height: 1200px;\n  overflow: auto;\n"])));

exports.ConfigGroupCollapsibleContent = ConfigGroupCollapsibleContent;

var ConfigGroupCollapsibleHeader = _styledComponents["default"].div.attrs({
  className: 'layer-config-group__header__collapsible'
})(_templateObject3 || (_templateObject3 = (0, _taggedTemplateLiteral2["default"])(["\n  overflow: visible;\n  overflow: hidden;\n  max-height: 0;\n"])));

exports.ConfigGroupCollapsibleHeader = ConfigGroupCollapsibleHeader;

var StyledLayerConfigGroup = _styledComponents["default"].div(_templateObject4 || (_templateObject4 = (0, _taggedTemplateLiteral2["default"])(["\n  padding-left: ", "px;\n  margin-bottom: ", "px;\n\n  &.disabled {\n    opacity: 0.3;\n    pointer-events: none;\n  }\n  &.collapsed {\n    .layer-config-group__header__collapsible {\n      overflow: visible;\n      max-height: 600px;\n    }\n    .layer-config-group__content {\n      .layer-config-group__content__collapsible {\n        overflow: hidden;\n        max-height: 0;\n      }\n    }\n  }\n"])), function (props) {
  return props.theme.layerConfigGroupPaddingLeft;
}, function (props) {
  return props.theme.layerConfigGroupMarginBottom;
});

exports.StyledLayerConfigGroup = StyledLayerConfigGroup;

var StyledConfigGroupHeader = _styledComponents["default"].div.attrs({
  className: 'layer-config-group__header'
})(_templateObject5 || (_templateObject5 = (0, _taggedTemplateLiteral2["default"])(["\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  margin-bottom: 12px;\n  cursor: default;\n\n  :hover {\n    ", "\n    .layer-config-group__label {\n      color: ", ";\n    }\n\n    .layer-config-group__action {\n      color: ", ";\n    }\n  }\n"])), function (props) {
  return props.collapsible && 'cursor: pointer;';
}, function (props) {
  return props.theme.textColorHl;
}, function (props) {
  return props.theme.textColorHl;
});

exports.StyledConfigGroupHeader = StyledConfigGroupHeader;

var ConfigGroupContent = _styledComponents["default"].div(_templateObject6 || (_templateObject6 = (0, _taggedTemplateLiteral2["default"])(["\n  &.disabled {\n    opacity: 0.3;\n    pointer-events: none;\n    * {\n      pointer-events: none;\n    }\n  }\n"])));

LayerConfigGroupLabelFactory.deps = [_infoHelper["default"]];

function LayerConfigGroupLabelFactory(InfoHelper) {
  var StyledLayerConfigGroupLabel = _styledComponents["default"].div(_templateObject7 || (_templateObject7 = (0, _taggedTemplateLiteral2["default"])(["\n    border-left: ", " solid\n      ", ";\n    line-height: 12px;\n    margin-left: ", ";\n    padding-left: ", ";\n\n    display: flex;\n    align-items: center;\n\n    span {\n      color: ", ";\n      font-weight: 500;\n      letter-spacing: 0.2px;\n      text-transform: capitalize;\n      margin-left: ", ";\n      font-size: ", ";\n    }\n  "])), function (props) {
    return props.theme.layerConfigGroupLabelBorderLeft;
  }, function (props) {
    return props.theme.labelColor;
  }, function (props) {
    return props.theme.layerConfigGroupLabelMargin;
  }, function (props) {
    return props.theme.layerConfigGroupLabelPadding;
  }, function (props) {
    return props.theme.textColor;
  }, function (props) {
    return props.theme.layerConfigGroupLabelLabelMargin;
  }, function (props) {
    return props.theme.layerConfigGroupLabelLabelFontSize;
  });

  var LayerConfigGroupLabel = function LayerConfigGroupLabel(_ref) {
    var label = _ref.label,
        description = _ref.description;
    return /*#__PURE__*/_react["default"].createElement(StyledLayerConfigGroupLabel, {
      className: "layer-config-group__label"
    }, /*#__PURE__*/_react["default"].createElement("span", null, /*#__PURE__*/_react["default"].createElement(_reactIntl.FormattedMessage, {
      id: label || 'misc.empty',
      defaultMessage: label
    })), description && /*#__PURE__*/_react["default"].createElement(InfoHelper, {
      description: description,
      id: label
    }));
  };

  return LayerConfigGroupLabel;
}

LayerConfigGroupFactory.deps = [LayerConfigGroupLabelFactory];

function LayerConfigGroupFactory(LayerConfigGroupLabel) {
  var LayerConfigGroup = function LayerConfigGroup(_ref2) {
    var label = _ref2.label,
        children = _ref2.children,
        property = _ref2.property,
        layer = _ref2.layer,
        _onChange2 = _ref2.onChange,
        collapsible = _ref2.collapsible,
        description = _ref2.description,
        disabled = _ref2.disabled,
        expanded = _ref2.expanded,
        _ref2$IconComponent = _ref2.IconComponent,
        IconComponent = _ref2$IconComponent === void 0 ? _icons.VertThreeDots : _ref2$IconComponent;

    var _useState = (0, _react.useState)(!expanded),
        _useState2 = (0, _slicedToArray2["default"])(_useState, 2),
        collapsed = _useState2[0],
        toggleCollapsed = _useState2[1];

    var onToggleCollapsed = (0, _react.useCallback)(function () {
      collapsible && toggleCollapsed(!collapsed);
    }, [collapsed, toggleCollapsed, collapsible]);
    return /*#__PURE__*/_react["default"].createElement(StyledLayerConfigGroup, {
      className: (0, _classnames["default"])('layer-config-group', {
        collapsed: collapsed,
        disabled: disabled
      })
    }, /*#__PURE__*/_react["default"].createElement(StyledConfigGroupHeader, {
      onClick: onToggleCollapsed,
      collapsible: collapsible
    }, /*#__PURE__*/_react["default"].createElement(LayerConfigGroupLabel, {
      label: label,
      description: description,
      collapsed: collapsed
    }), /*#__PURE__*/_react["default"].createElement(StyledLayerConfigGroupAction, {
      className: "layer-config-group__action"
    }, property ? /*#__PURE__*/_react["default"].createElement(_switch["default"], {
      checked: layer === null || layer === void 0 ? void 0 : layer.config.visConfig[property],
      id: "".concat(layer === null || layer === void 0 ? void 0 : layer.id, "-").concat(property),
      onChange: function onChange() {
        return _onChange2 === null || _onChange2 === void 0 ? void 0 : _onChange2((0, _defineProperty2["default"])({}, property, !(layer !== null && layer !== void 0 && layer.config.visConfig[property])));
      }
    }) : null, collapsible ? /*#__PURE__*/_react["default"].createElement(IconComponent, {
      height: "18px"
    }) : null)), /*#__PURE__*/_react["default"].createElement(ConfigGroupContent, {
      className: (0, _classnames["default"])('layer-config-group__content', {
        disabled: property && !(layer !== null && layer !== void 0 && layer.config.visConfig[property])
      })
    }, children));
  };

  LayerConfigGroup.defaultProps = {
    collapsible: false,
    expanded: false,
    onChange: function onChange() {},
    description: '',
    disabled: false
  };
  return LayerConfigGroup;
}

var _default = LayerConfigGroupFactory;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9zaWRlLXBhbmVsL2xheWVyLXBhbmVsL2xheWVyLWNvbmZpZy1ncm91cC50c3giXSwibmFtZXMiOlsiU3R5bGVkTGF5ZXJDb25maWdHcm91cEFjdGlvbiIsInN0eWxlZCIsImRpdiIsInByb3BzIiwidGhlbWUiLCJ0ZXh0Q29sb3IiLCJDb25maWdHcm91cENvbGxhcHNpYmxlQ29udGVudCIsImF0dHJzIiwiY2xhc3NOYW1lIiwiQ29uZmlnR3JvdXBDb2xsYXBzaWJsZUhlYWRlciIsIlN0eWxlZExheWVyQ29uZmlnR3JvdXAiLCJsYXllckNvbmZpZ0dyb3VwUGFkZGluZ0xlZnQiLCJsYXllckNvbmZpZ0dyb3VwTWFyZ2luQm90dG9tIiwiU3R5bGVkQ29uZmlnR3JvdXBIZWFkZXIiLCJjb2xsYXBzaWJsZSIsInRleHRDb2xvckhsIiwiQ29uZmlnR3JvdXBDb250ZW50IiwiTGF5ZXJDb25maWdHcm91cExhYmVsRmFjdG9yeSIsImRlcHMiLCJJbmZvSGVscGVyRmFjdG9yeSIsIkluZm9IZWxwZXIiLCJTdHlsZWRMYXllckNvbmZpZ0dyb3VwTGFiZWwiLCJsYXllckNvbmZpZ0dyb3VwTGFiZWxCb3JkZXJMZWZ0IiwibGFiZWxDb2xvciIsImxheWVyQ29uZmlnR3JvdXBMYWJlbE1hcmdpbiIsImxheWVyQ29uZmlnR3JvdXBMYWJlbFBhZGRpbmciLCJsYXllckNvbmZpZ0dyb3VwTGFiZWxMYWJlbE1hcmdpbiIsImxheWVyQ29uZmlnR3JvdXBMYWJlbExhYmVsRm9udFNpemUiLCJMYXllckNvbmZpZ0dyb3VwTGFiZWwiLCJsYWJlbCIsImRlc2NyaXB0aW9uIiwiTGF5ZXJDb25maWdHcm91cEZhY3RvcnkiLCJMYXllckNvbmZpZ0dyb3VwIiwiY2hpbGRyZW4iLCJwcm9wZXJ0eSIsImxheWVyIiwib25DaGFuZ2UiLCJkaXNhYmxlZCIsImV4cGFuZGVkIiwiSWNvbkNvbXBvbmVudCIsIlZlcnRUaHJlZURvdHMiLCJjb2xsYXBzZWQiLCJ0b2dnbGVDb2xsYXBzZWQiLCJvblRvZ2dsZUNvbGxhcHNlZCIsImNvbmZpZyIsInZpc0NvbmZpZyIsImlkIiwiZGVmYXVsdFByb3BzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFHQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7OztBQXVCTyxJQUFNQSw0QkFBNEIsR0FBR0MsNkJBQU9DLEdBQVYsbUpBRzlCLFVBQUFDLEtBQUs7QUFBQSxTQUFJQSxLQUFLLENBQUNDLEtBQU4sQ0FBWUMsU0FBaEI7QUFBQSxDQUh5QixDQUFsQzs7OztBQU1BLElBQU1DLDZCQUE2QixHQUFHTCw2QkFBT0MsR0FBUCxDQUFXSyxLQUFYLENBQWlCO0FBQzVEQyxFQUFBQSxTQUFTLEVBQUU7QUFEaUQsQ0FBakIsQ0FBSCxxTUFBbkM7Ozs7QUFTQSxJQUFNQyw0QkFBNEIsR0FBR1IsNkJBQU9DLEdBQVAsQ0FBV0ssS0FBWCxDQUFpQjtBQUMzREMsRUFBQUEsU0FBUyxFQUFFO0FBRGdELENBQWpCLENBQUgsdUpBQWxDOzs7O0FBUUEsSUFBTUUsc0JBQXNCLEdBQUdULDZCQUFPQyxHQUFWLDhlQUNqQixVQUFBQyxLQUFLO0FBQUEsU0FBSUEsS0FBSyxDQUFDQyxLQUFOLENBQVlPLDJCQUFoQjtBQUFBLENBRFksRUFFaEIsVUFBQVIsS0FBSztBQUFBLFNBQUlBLEtBQUssQ0FBQ0MsS0FBTixDQUFZUSw0QkFBaEI7QUFBQSxDQUZXLENBQTVCOzs7O0FBMEJBLElBQU1DLHVCQUF1QixHQUFHWiw2QkFBT0MsR0FBUCxDQUFXSyxLQUFYLENBQWlCO0FBQ3REQyxFQUFBQSxTQUFTLEVBQUU7QUFEMkMsQ0FBakIsQ0FBSCw4V0FVOUIsVUFBQUwsS0FBSztBQUFBLFNBQUlBLEtBQUssQ0FBQ1csV0FBTixJQUFxQixrQkFBekI7QUFBQSxDQVZ5QixFQVlyQixVQUFBWCxLQUFLO0FBQUEsU0FBSUEsS0FBSyxDQUFDQyxLQUFOLENBQVlXLFdBQWhCO0FBQUEsQ0FaZ0IsRUFnQnJCLFVBQUFaLEtBQUs7QUFBQSxT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LFFBQXhCLENBQUQ7QUFENkIsT0FBMUM7QUFEYixPQUtHRCxRQUxILENBZEYsQ0FERjtBQXdCRCxHQXpDRDs7QUEyQ0FELEVBQUFBLGdCQUFnQixDQUFDZSxZQUFqQixHQUFnQztBQUM5QmpDLElBQUFBLFdBQVcsRUFBRSxLQURpQjtBQUU5QndCLElBQUFBLFFBQVEsRUFBRSxLQUZvQjtBQUc5QkYsSUFBQUEsUUFBUSxFQUFFLG9CQUFNLENBQUUsQ0FIWTtBQUk5Qk4sSUFBQUEsV0FBVyxFQUFFLEVBSmlCO0FBSzlCTyxJQUFBQSxRQUFRLEVBQUU7QUFMb0IsR0FBaEM7QUFPQSxTQUFPTCxnQkFBUDtBQUNEOztlQUVjRCx1QiIsInNvdXJjZXNDb250ZW50IjpbIi8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBNSVRcbi8vIENvcHlyaWdodCBjb250cmlidXRvcnMgdG8gdGhlIGtlcGxlci5nbCBwcm9qZWN0XG5cbmltcG9ydCBSZWFjdCwge3VzZUNhbGxiYWNrLCB1c2VTdGF0ZX0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHN0eWxlZCBmcm9tICdzdHlsZWQtY29tcG9uZW50cyc7XG5pbXBvcnQgY2xhc3NuYW1lcyBmcm9tICdjbGFzc25hbWVzJztcbmltcG9ydCB7Rm9ybWF0dGVkTWVzc2FnZX0gZnJvbSAncmVhY3QtaW50bCc7XG5pbXBvcnQgU3dpdGNoIGZyb20gJy4uLy4uL2NvbW1vbi9zd2l0Y2gnO1xuaW1wb3J0IEluZm9IZWxwZXJGYWN0b3J5IGZyb20gJy4uLy4uL2NvbW1vbi9pbmZvLWhlbHBlcic7XG5pbXBvcnQge1ZlcnRUaHJlZURvdHN9IGZyb20gJy4uLy4uL2NvbW1vbi9pY29ucyc7XG5pbXBvcnQge0xheWVyfSBmcm9tICdAa2VwbGVyLmdsL2xheWVycyc7XG5pbXBvcnQge0xheWVyVmlzQ29uZmlnfSBmcm9tICdAa2VwbGVyLmdsL3R5cGVzJztcblxuZXhwb3J0IHR5cGUgTGF5ZXJDb25maWdHcm91cExhYmVsUHJvcHMgPSB7XG4gIGxhYmVsPzogc3RyaW5nO1xuICBkZXNjcmlwdGlvbj86IHN0cmluZztcbiAgY29sbGFwc2VkPzogYm9vbGVhbjtcbn07XG5cbmV4cG9ydCB0eXBlIExheWVyQ29uZmlnR3JvdXBQcm9wcyA9IHtcbiAgbGF5ZXI/OiBMYXllcjtcbiAgbGFiZWw6IHN0cmluZztcbiAgcHJvcGVydHk/OiBzdHJpbmc7XG4gIGRlc2NyaXB0aW9uPzogc3RyaW5nO1xuICBjb2xsYXBzaWJsZT86IGJvb2xlYW47XG4gIGV4cGFuZGVkPzogYm9vbGVhbjtcbiAgZGlzYWJsZWQ/OiBib29sZWFuO1xuICBvbkNoYW5nZT86IChuZXdWaXNDb25maWc6IFBhcnRpYWw8TGF5ZXJWaXNDb25maWc+KSA9PiB2b2lkO1xuICBJY29uQ29tcG9uZW50PzogUmVhY3QuRWxlbWVudFR5cGU7XG4gIGNoaWxkcmVuPzogUmVhY3QuUmVhY3ROb2RlO1xufTtcblxuZXhwb3J0IGNvbnN0IFN0eWxlZExheWVyQ29uZmlnR3JvdXBBY3Rpb24gPSBzdHlsZWQuZGl2YFxuICBkaXNwbGF5OiBmbGV4O1xuICBhbGlnbi1pdGVtczogY2VudGVyO1xuICBjb2xvcjogJHtwcm9wcyA9PiBwcm9wcy50aGVtZS50ZXh0Q29sb3J9O1xuYDtcblxuZXhwb3J0IGNvbnN0IENvbmZpZ0dyb3VwQ29sbGFwc2libGVDb250ZW50ID0gc3R5bGVkLmRpdi5hdHRycyh7XG4gIGNsYXNzTmFtZTogJ2xheWVyLWNvbmZpZy1ncm91cF9fY29udGVudF9fY29sbGFwc2libGUnXG59KWBcbiAgdHJhbnNpdGlvbjogbWF4LWhlaWdodCAwLjNzIGVhc2Utb3V0O1xuICBoZWlnaHQ6IG1heC1jb250ZW50O1xuICBtYXgtaGVpZ2h0OiAxMjAwcHg7XG4gIG92ZXJmbG93OiBhdXRvO1xuYDtcblxuZXhwb3J0IGNvbnN0IENvbmZpZ0dyb3VwQ29sbGFwc2libGVIZWFkZXIgPSBzdHlsZWQuZGl2LmF0dHJzKHtcbiAgY2xhc3NOYW1lOiAnbGF5ZXItY29uZmlnLWdyb3VwX19oZWFkZXJfX2NvbGxhcHNpYmxlJ1xufSlgXG4gIG92ZXJmbG93OiB2aXNpYmxlO1xuICBvdmVyZmxvdzogaGlkZGVuO1xuICBtYXgtaGVpZ2h0OiAwO1xuYDtcblxuZXhwb3J0IGNvbnN0IFN0eWxlZExheWVyQ29uZmlnR3JvdXAgPSBzdHlsZWQuZGl2YFxuICBwYWRkaW5nLWxlZnQ6ICR7cHJvcHMgPT4gcHJvcHMudGhlbWUubGF5ZXJDb25maWdHcm91cFBhZGRpbmdMZWZ0fXB4O1xuICBtYXJnaW4tYm90dG9tOiAke3Byb3BzID0+IHByb3BzLnRoZW1lLmxheWVyQ29uZmlnR3JvdXBNYXJnaW5Cb3R0b219cHg7XG5cbiAgJi5kaXNhYmxlZCB7XG4gICAgb3BhY2l0eTogMC4zO1xuICAgIHBvaW50ZXItZXZlbnRzOiBub25lO1xuICB9XG4gICYuY29sbGFwc2VkIHtcbiAgICAubGF5ZXItY29uZmlnLWdyb3VwX19oZWFkZXJfX2NvbGxhcHNpYmxlIHtcbiAgICAgIG92ZXJmbG93OiB2aXNpYmxlO1xuICAgICAgbWF4LWhlaWdodDogNjAwcHg7XG4gICAgfVxuICAgIC5sYXllci1jb25maWctZ3JvdXBfX2NvbnRlbnQge1xuICAgICAgLmxheWVyLWNvbmZpZy1ncm91cF9fY29udGVudF9fY29sbGFwc2libGUge1xuICAgICAgICBvdmVyZmxvdzogaGlkZGVuO1xuICAgICAgICBtYXgtaGVpZ2h0OiAwO1xuICAgICAgfVxuICAgIH1cbiAgfVxuYDtcblxuaW50ZXJmYWNlIFN0eWxlZENvbmZpZ0dyb3VwSGVhZGVyUHJvcHMge1xuICBjb2xsYXBzaWJsZT86IGJvb2xlYW47XG59XG5cbmV4cG9ydCBjb25zdCBTdHlsZWRDb25maWdHcm91cEhlYWRlciA9IHN0eWxlZC5kaXYuYXR0cnMoe1xuICBjbGFzc05hbWU6ICdsYXllci1jb25maWctZ3JvdXBfX2hlYWRlcidcbn0pPFN0eWxlZENvbmZpZ0dyb3VwSGVhZGVyUHJvcHM+YFxuICBkaXNwbGF5OiBmbGV4O1xuICBhbGlnbi1pdGVtczogY2VudGVyO1xuICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XG4gIG1hcmdpbi1ib3R0b206IDEycHg7XG4gIGN1cnNvcjogZGVmYXVsdDtcblxuICA6aG92ZXIge1xuICAgICR7cHJvcHMgPT4gcHJvcHMuY29sbGFwc2libGUgJiYgJ2N1cnNvcjogcG9pbnRlcjsnfVxuICAgIC5sYXllci1jb25maWctZ3JvdXBfX2xhYmVsIHtcbiAgICAgIGNvbG9yOiAke3Byb3BzID0+IHByb3BzLnRoZW1lLnRleHRDb2xvckhsfTtcbiAgICB9XG5cbiAgICAubGF5ZXItY29uZmlnLWdyb3VwX19hY3Rpb24ge1xuICAgICAgY29sb3I6ICR7cHJvcHMgPT4gcHJvcHMudGhlbWUudGV4dENvbG9ySGx9O1xuICAgIH1cbiAgfVxuYDtcblxuY29uc3QgQ29uZmlnR3JvdXBDb250ZW50ID0gc3R5bGVkLmRpdmBcbiAgJi5kaXNhYmxlZCB7XG4gICAgb3BhY2l0eTogMC4zO1xuICAgIHBvaW50ZXItZXZlbnRzOiBub25lO1xuICAgICoge1xuICAgICAgcG9pbnRlci1ldmVudHM6IG5vbmU7XG4gICAgfVxuICB9XG5gO1xuXG5MYXllckNvbmZpZ0dyb3VwTGFiZWxGYWN0b3J5LmRlcHMgPSBbSW5mb0hlbHBlckZhY3RvcnldO1xuXG5leHBvcnQgZnVuY3Rpb24gTGF5ZXJDb25maWdHcm91cExhYmVsRmFjdG9yeShJbmZvSGVscGVyOiBSZXR1cm5UeXBlPHR5cGVvZiBJbmZvSGVscGVyRmFjdG9yeT4pIHtcbiAgY29uc3QgU3R5bGVkTGF5ZXJDb25maWdHcm91cExhYmVsID0gc3R5bGVkLmRpdmBcbiAgICBib3JkZXItbGVmdDogJHtwcm9wcyA9PiBwcm9wcy50aGVtZS5sYXllckNvbmZpZ0dyb3VwTGFiZWxCb3JkZXJMZWZ0fSBzb2xpZFxuICAgICAgJHtwcm9wcyA9PiBwcm9wcy50aGVtZS5sYWJlbENvbG9yfTtcbiAgICBsaW5lLWhlaWdodDogMTJweDtcbiAgICBtYXJnaW4tbGVmdDogJHtwcm9wcyA9PiBwcm9wcy50aGVtZS5sYXllckNvbmZpZ0dyb3VwTGFiZWxNYXJnaW59O1xuICAgIHBhZGRpbmctbGVmdDogJHtwcm9wcyA9PiBwcm9wcy50aGVtZS5sYXllckNvbmZpZ0dyb3VwTGFiZWxQYWRkaW5nfTtcblxuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcblxuICAgIHNwYW4ge1xuICAgICAgY29sb3I6ICR7cHJvcHMgPT4gcHJvcHMudGhlbWUudGV4dENvbG9yfTtcbiAgICAgIGZvbnQtd2VpZ2h0OiA1MDA7XG4gICAgICBsZXR0ZXItc3BhY2luZzogMC4ycHg7XG4gICAgICB0ZXh0LXRyYW5zZm9ybTogY2FwaXRhbGl6ZTtcbiAgICAgIG1hcmdpbi1sZWZ0OiAke3Byb3BzID0+IHByb3BzLnRoZW1lLmxheWVyQ29uZmlnR3JvdXBMYWJlbExhYmVsTWFyZ2lufTtcbiAgICAgIGZvbnQtc2l6ZTogJHtwcm9wcyA9PiBwcm9wcy50aGVtZS5sYXllckNvbmZpZ0dyb3VwTGFiZWxMYWJlbEZvbnRTaXplfTtcbiAgICB9XG4gIGA7XG5cbiAgY29uc3QgTGF5ZXJDb25maWdHcm91cExhYmVsOiBSZWFjdC5GQzxMYXllckNvbmZpZ0dyb3VwTGFiZWxQcm9wcz4gPSAoe2xhYmVsLCBkZXNjcmlwdGlvbn0pID0+IChcbiAgICA8U3R5bGVkTGF5ZXJDb25maWdHcm91cExhYmVsIGNsYXNzTmFtZT1cImxheWVyLWNvbmZpZy1ncm91cF9fbGFiZWxcIj5cbiAgICAgIDxzcGFuPlxuICAgICAgICA8Rm9ybWF0dGVkTWVzc2FnZSBpZD17bGFiZWwgfHwgJ21pc2MuZW1wdHknfSBkZWZhdWx0TWVzc2FnZT17bGFiZWx9IC8+XG4gICAgICA8L3NwYW4+XG4gICAgICB7ZGVzY3JpcHRpb24gJiYgPEluZm9IZWxwZXIgZGVzY3JpcHRpb249e2Rlc2NyaXB0aW9ufSBpZD17bGFiZWx9IC8+fVxuICAgIDwvU3R5bGVkTGF5ZXJDb25maWdHcm91cExhYmVsPlxuICApO1xuXG4gIHJldHVybiBMYXllckNvbmZpZ0dyb3VwTGFiZWw7XG59XG5cbkxheWVyQ29uZmlnR3JvdXBGYWN0b3J5LmRlcHMgPSBbTGF5ZXJDb25maWdHcm91cExhYmVsRmFjdG9yeV07XG5cbmZ1bmN0aW9uIExheWVyQ29uZmlnR3JvdXBGYWN0b3J5KFxuICBMYXllckNvbmZpZ0dyb3VwTGFiZWw6IFJldHVyblR5cGU8dHlwZW9mIExheWVyQ29uZmlnR3JvdXBMYWJlbEZhY3Rvcnk+XG4pIHtcbiAgY29uc3QgTGF5ZXJDb25maWdHcm91cDogUmVhY3QuRkM8TGF5ZXJDb25maWdHcm91cFByb3BzPiA9ICh7XG4gICAgbGFiZWwsXG4gICAgY2hpbGRyZW4sXG4gICAgcHJvcGVydHksXG4gICAgbGF5ZXIsXG4gICAgb25DaGFuZ2UsXG4gICAgY29sbGFwc2libGUsXG4gICAgZGVzY3JpcHRpb24sXG4gICAgZGlzYWJsZWQsXG4gICAgZXhwYW5kZWQsXG4gICAgSWNvbkNvbXBvbmVudCA9IFZlcnRUaHJlZURvdHNcbiAgfSkgPT4ge1xuICAgIGNvbnN0IFtjb2xsYXBzZWQsIHRvZ2dsZUNvbGxhcHNlZF0gPSB1c2VTdGF0ZSghZXhwYW5kZWQpO1xuICAgIGNvbnN0IG9uVG9nZ2xlQ29sbGFwc2VkID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgICAgY29sbGFwc2libGUgJiYgdG9nZ2xlQ29sbGFwc2VkKCFjb2xsYXBzZWQpO1xuICAgIH0sIFtjb2xsYXBzZWQsIHRvZ2dsZUNvbGxhcHNlZCwgY29sbGFwc2libGVdKTtcblxuICAgIHJldHVybiAoXG4gICAgICA8U3R5bGVkTGF5ZXJDb25maWdHcm91cCBjbGFzc05hbWU9e2NsYXNzbmFtZXMoJ2xheWVyLWNvbmZpZy1ncm91cCcsIHtjb2xsYXBzZWQsIGRpc2FibGVkfSl9PlxuICAgICAgICA8U3R5bGVkQ29uZmlnR3JvdXBIZWFkZXIgb25DbGljaz17b25Ub2dnbGVDb2xsYXBzZWR9IGNvbGxhcHNpYmxlPXtjb2xsYXBzaWJsZX0+XG4gICAgICAgICAgPExheWVyQ29uZmlnR3JvdXBMYWJlbCBsYWJlbD17bGFiZWx9IGRlc2NyaXB0aW9uPXtkZXNjcmlwdGlvbn0gY29sbGFwc2VkPXtjb2xsYXBzZWR9IC8+XG4gICAgICAgICAgPFN0eWxlZExheWVyQ29uZmlnR3JvdXBBY3Rpb24gY2xhc3NOYW1lPVwibGF5ZXItY29uZmlnLWdyb3VwX19hY3Rpb25cIj5cbiAgICAgICAgICAgIHtwcm9wZXJ0eSA/IChcbiAgICAgICAgICAgICAgPFN3aXRjaFxuICAgICAgICAgICAgICAgIGNoZWNrZWQ9e2xheWVyPy5jb25maWcudmlzQ29uZmlnW3Byb3BlcnR5XX1cbiAgICAgICAgICAgICAgICBpZD17YCR7bGF5ZXI/LmlkfS0ke3Byb3BlcnR5fWB9XG4gICAgICAgICAgICAgICAgb25DaGFuZ2U9eygpID0+IG9uQ2hhbmdlPy4oe1twcm9wZXJ0eV06ICFsYXllcj8uY29uZmlnLnZpc0NvbmZpZ1twcm9wZXJ0eV19KX1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAge2NvbGxhcHNpYmxlID8gPEljb25Db21wb25lbnQgaGVpZ2h0PVwiMThweFwiIC8+IDogbnVsbH1cbiAgICAgICAgICA8L1N0eWxlZExheWVyQ29uZmlnR3JvdXBBY3Rpb24+XG4gICAgICAgIDwvU3R5bGVkQ29uZmlnR3JvdXBIZWFkZXI+XG4gICAgICAgIDxDb25maWdHcm91cENvbnRlbnRcbiAgICAgICAgICBjbGFzc05hbWU9e2NsYXNzbmFtZXMoJ2xheWVyLWNvbmZpZy1ncm91cF9fY29udGVudCcsIHtcbiAgICAgICAgICAgIGRpc2FibGVkOiBwcm9wZXJ0eSAmJiAhbGF5ZXI/LmNvbmZpZy52aXNDb25maWdbcHJvcGVydHldXG4gICAgICAgICAgfSl9XG4gICAgICAgID5cbiAgICAgICAgICB7Y2hpbGRyZW59XG4gICAgICAgIDwvQ29uZmlnR3JvdXBDb250ZW50PlxuICAgICAgPC9TdHlsZWRMYXllckNvbmZpZ0dyb3VwPlxuICAgICk7XG4gIH07XG5cbiAgTGF5ZXJDb25maWdHcm91cC5kZWZhdWx0UHJvcHMgPSB7XG4gICAgY29sbGFwc2libGU6IGZhbHNlLFxuICAgIGV4cGFuZGVkOiBmYWxzZSxcbiAgICBvbkNoYW5nZTogKCkgPT4ge30sXG4gICAgZGVzY3JpcHRpb246ICcnLFxuICAgIGRpc2FibGVkOiBmYWxzZVxuICB9O1xuICByZXR1cm4gTGF5ZXJDb25maWdHcm91cDtcbn1cblxuZXhwb3J0IGRlZmF1bHQgTGF5ZXJDb25maWdHcm91cEZhY3Rvcnk7XG4iXX0=
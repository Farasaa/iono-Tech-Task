{"version":3,"sources":["../../../../src/components/export-video/export-video-modal.js"],"names":["React","Component","createRef","Modal","styled","ThemeProvider","createSelector","SIDEPANEL_WIDTH","ModalContainer","div","ExportVideoModal","showSettingsSelector","showSettings","theme","defaultSettingsPos","bottomBuffer","settingsHeight","props","root","current","sidePanelInnerPadding","sidePanel","sidePanelScrollBarWidth","sidePanelLeft","margin","left","offsetX","bounding","getBoundingClientRect","x","y","width","top","window","innerHeight","themeSelector","settingsPosSelector","settingsPos","content","right","bottom","transform","padding","border","backgroundColor","sidePanelBg","borderRadius","panelBorderRadius","overlay","zIndex","modalOverLayZ","render","isOpen","children","modalStyles","modalStylesSelector","removeChild","appendChild"],"mappings":"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","sourcesContent":["// Copyright (c) 2020 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\n/* eslint-disable no-invalid-this */\nimport React, {Component, createRef} from 'react';\nimport Modal from 'react-modal';\nimport styled, {ThemeProvider} from 'styled-components';\nimport {createSelector} from 'reselect';\nimport {SIDEPANEL_WIDTH} from './constants';\n\nconst ModalContainer = styled.div`\n  position: relative;\n`;\n\nclass ExportVideoModal extends Component {\n  static defaultProps = {\n    defaultSettingsPos: {top: '320px', left: '320px'},\n    bottomBuffer: 212\n  };\n\n  root = createRef();\n\n  // derive settings position based on root component\n  showSettingsSelector(props) {\n    return props.showSettings;\n  }\n  themeSelector(props) {\n    return props.theme;\n  }\n  settingsPosSelector = createSelector(this.showSettingsSelector, (showSettings, theme = {}) => {\n    const {defaultSettingsPos, bottomBuffer, settingsHeight} = this.props;\n    if (showSettings === false || !this.root || !this.root.current) return defaultSettingsPos;\n    const {sidePanelInnerPadding = 16, sidePanel = {}, sidePanelScrollBarWidth = 10} = theme;\n    const sidePanelLeft = (sidePanel.margin || {}).left || 20;\n    const offsetX = sidePanelInnerPadding + sidePanelLeft + sidePanelScrollBarWidth;\n    // find component Root position\n    const bounding = this.root.current.getBoundingClientRect();\n    const {x, y, width} = bounding;\n\n    // set the top so it won't collide with bottom widget\n    const top =\n      y + settingsHeight <= window.innerHeight - bottomBuffer\n        ? y\n        : window.innerHeight - bottomBuffer - settingsHeight;\n\n    return {top: `${top}px`, left: `${x + width + offsetX}px`};\n  });\n\n  modalStylesSelector = createSelector(\n    this.themeSelector,\n    this.settingsPosSelector,\n    (theme, settingsPos) => ({\n      content: {\n        top: 'auto',\n        left: 'auto',\n        right: `calc(50% - ${SIDEPANEL_WIDTH / 2}px)`,\n        bottom: '50%',\n        transform: 'translate(50%, 50%)',\n        padding: '0px 0px 0px 0px',\n        border: 0,\n        backgroundColor: theme.sidePanelBg,\n        borderRadius: theme.panelBorderRadius || '2px'\n      },\n      overlay: {\n        backgroundColor: 'rgba(0, 0, 0, .5)',\n        zIndex: (this.props.theme && this.props.theme.modalOverLayZ) || 1000\n      }\n    })\n  );\n\n  render() {\n    const {isOpen, theme, children} = this.props;\n\n    const modalStyles = this.modalStylesSelector(this.props);\n    return (\n      <ThemeProvider theme={theme}>\n        <ModalContainer className=\"export-video-modal\" ref={this.root}>\n          {this.root.current ? (\n            <Modal\n              isOpen={isOpen}\n              style={modalStyles}\n              ariaHideApp={false}\n              parentSelector={() => {\n                return (\n                  this.root.current || {\n                    removeChild: () => {},\n                    appendChild: () => {}\n                  }\n                );\n              }}\n            >\n              {children}\n            </Modal>\n          ) : null}\n        </ModalContainer>\n      </ThemeProvider>\n    );\n  }\n}\n\nexport default ExportVideoModal;\n"],"file":"export-video-modal.js"}
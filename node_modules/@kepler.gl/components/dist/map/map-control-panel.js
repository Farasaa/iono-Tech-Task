"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _taggedTemplateLiteral2 = _interopRequireDefault(require("@babel/runtime/helpers/taggedTemplateLiteral"));

var _react = _interopRequireWildcard(require("react"));

var _styledComponents = _interopRequireDefault(require("styled-components"));

var _localization = require("@kepler.gl/localization");

var _styledComponents2 = require("../common/styled-components");

var _icons = require("../common/icons");

var _switch = _interopRequireDefault(require("../common/switch"));

var _templateObject, _templateObject2, _templateObject3, _templateObject4, _templateObject5, _templateObject6, _templateObject7, _templateObject8;

var StyledMapControlPanel = _styledComponents["default"].div(_templateObject || (_templateObject = (0, _taggedTemplateLiteral2["default"])(["\n  background-color: ", ";\n  flex-grow: 1;\n  z-index: 1;\n  p {\n    margin-bottom: 0;\n  }\n"])), function (props) {
  return props.theme.mapPanelBackgroundColor;
});

var StyledMapControlPanelContent = _styledComponents["default"].div.attrs({
  className: 'map-control__panel-content'
})(_templateObject2 || (_templateObject2 = (0, _taggedTemplateLiteral2["default"])(["\n  ", ";\n  max-height: 500px;\n  min-height: 100px;\n  min-width: ", "px;\n  overflow: overlay;\n"])), function (props) {
  return props.theme.dropdownScrollBar;
}, function (props) {
  return props.theme.mapControl.width;
});

var StyledMapControlPanelHeader = _styledComponents["default"].div.attrs({
  className: 'map-control__panel-header'
})(_templateObject3 || (_templateObject3 = (0, _taggedTemplateLiteral2["default"])(["\n  display: flex;\n  justify-content: space-between;\n  background-color: ", ";\n  height: 32px;\n  padding: 6px 12px;\n  font-family: ", ";\n  font-size: 11px;\n  color: ", ";\n  position: relative;\n  box-sizing: border-box;\n\n  button {\n    width: 18px;\n    height: 18px;\n  }\n"])), function (props) {
  return props.theme.mapPanelHeaderBackgroundColor;
}, function (props) {
  return props.theme.fontFamily;
}, function (props) {
  return props.theme.titleTextColor;
});

var StyledMapControlPanelHeaderSplitViewportsTools = (0, _styledComponents["default"])(StyledMapControlPanelHeader).attrs({
  className: 'map-control__panel-split-viewport-tools'
})(_templateObject4 || (_templateObject4 = (0, _taggedTemplateLiteral2["default"])(["\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  align-items: self-start;\n  height: unset;\n"])));
var StyledSBCenterFlexbox = (0, _styledComponents["default"])(_styledComponents2.CenterFlexbox)(_templateObject5 || (_templateObject5 = (0, _taggedTemplateLiteral2["default"])(["\n  width: 100%;\n  justify-content: space-between;\n  flex-direction: row;\n"])));

var StyledDisableableText = _styledComponents["default"].span(_templateObject6 || (_templateObject6 = (0, _taggedTemplateLiteral2["default"])(["\n  opacity: ", ";\n  pointer-events: ", ";\n"])), function (props) {
  return props.disabled ? 0.4 : 1;
}, function (props) {
  return props.disabled ? 'none' : 'all';
});

var StyledDisableableSwitch = (0, _styledComponents["default"])(_switch["default"])(_templateObject7 || (_templateObject7 = (0, _taggedTemplateLiteral2["default"])(["\n  opacity: ", ";\n  pointer-events: ", ";\n"])), function (props) {
  return props.disabled ? 0.4 : 1;
}, function (props) {
  return props.disabled ? 'none' : 'all';
});
var StyledIcon = (0, _styledComponents["default"])(_styledComponents2.IconRoundSmall)(_templateObject8 || (_templateObject8 = (0, _taggedTemplateLiteral2["default"])(["\n  color: ", ";\n  background-color: transparent;\n\n  :hover {\n    cursor: pointer;\n    background-color: transparent;\n    color: ", ";\n  }\n"])), function (props) {
  return props.theme.activeColor;
}, function (props) {
  return props.theme.linkBtnColor;
});

function MapControlPanelFactory() {
  var MapControlPanel = /*#__PURE__*/_react["default"].memo(function (_ref) {
    var children = _ref.children,
        header = _ref.header,
        pinnable = _ref.pinnable,
        disableClose = _ref.disableClose,
        onPinClick = _ref.onPinClick,
        onClick = _ref.onClick,
        _ref$scale = _ref.scale,
        scale = _ref$scale === void 0 ? 1 : _ref$scale,
        isExport = _ref.isExport,
        logoComponent = _ref.logoComponent,
        mapState = _ref.mapState,
        onToggleSplitMapViewport = _ref.onToggleSplitMapViewport,
        isViewportUnsyncAllowed = _ref.isViewportUnsyncAllowed;

    var _ref2 = mapState || {},
        isViewportSynced = _ref2.isViewportSynced,
        isZoomLocked = _ref2.isZoomLocked;

    var onUnlockViewportChange = (0, _react.useCallback)(function () {
      onToggleSplitMapViewport === null || onToggleSplitMapViewport === void 0 ? void 0 : onToggleSplitMapViewport({
        isViewportSynced: !isViewportSynced
      });
    }, [isViewportSynced, onToggleSplitMapViewport]);
    var onSyncZoomChange = (0, _react.useCallback)(function () {
      onToggleSplitMapViewport === null || onToggleSplitMapViewport === void 0 ? void 0 : onToggleSplitMapViewport({
        isZoomLocked: !isZoomLocked
      });
    }, [isZoomLocked, onToggleSplitMapViewport]);
    return /*#__PURE__*/_react["default"].createElement(StyledMapControlPanel, {
      className: "map-control-panel",
      style: {
        transform: "scale(".concat(scale, ")"),
        marginBottom: '8px !important'
      }
    }, mapState !== null && mapState !== void 0 && mapState.isSplit && isViewportUnsyncAllowed ? /*#__PURE__*/_react["default"].createElement(StyledMapControlPanelHeaderSplitViewportsTools, null, /*#__PURE__*/_react["default"].createElement(StyledSBCenterFlexbox, {
      style: {
        paddingBottom: '6px'
      }
    }, /*#__PURE__*/_react["default"].createElement(_localization.FormattedMessage, {
      id: "Unlock Viewport"
    }), /*#__PURE__*/_react["default"].createElement(StyledDisableableSwitch, {
      checked: !(mapState !== null && mapState !== void 0 && mapState.isViewportSynced),
      id: "unlock-viewport-toggle",
      onChange: onUnlockViewportChange
    })), /*#__PURE__*/_react["default"].createElement(StyledSBCenterFlexbox, null, /*#__PURE__*/_react["default"].createElement(StyledDisableableText, {
      disabled: mapState === null || mapState === void 0 ? void 0 : mapState.isViewportSynced
    }, /*#__PURE__*/_react["default"].createElement(_localization.FormattedMessage, {
      id: "Sync Zoom"
    })), /*#__PURE__*/_react["default"].createElement(StyledDisableableSwitch, {
      checked: mapState === null || mapState === void 0 ? void 0 : mapState.isZoomLocked,
      id: "sync-zoom-toggle",
      onChange: onSyncZoomChange,
      disabled: mapState === null || mapState === void 0 ? void 0 : mapState.isViewportSynced
    }))) : null, /*#__PURE__*/_react["default"].createElement(StyledMapControlPanelHeader, null, isExport && logoComponent ? logoComponent : header ? /*#__PURE__*/_react["default"].createElement("span", {
      style: {
        verticalAlign: 'middle'
      }
    }, /*#__PURE__*/_react["default"].createElement(_localization.FormattedMessage, {
      id: header
    })) : null, isExport ? null : /*#__PURE__*/_react["default"].createElement(_react["default"].Fragment, null, pinnable && /*#__PURE__*/_react["default"].createElement(StyledIcon, {
      className: "pin-map-control-item",
      onClick: onPinClick
    }, /*#__PURE__*/_react["default"].createElement(_icons.Pin, {
      height: "16px"
    })), disableClose ? null : /*#__PURE__*/_react["default"].createElement(StyledIcon, {
      className: "close-map-control-item",
      onClick: onClick
    }, /*#__PURE__*/_react["default"].createElement(_icons.Close, {
      height: "16px"
    })))), /*#__PURE__*/_react["default"].createElement(StyledMapControlPanelContent, null, children));
  });

  MapControlPanel.displayName = 'MapControlPanel';
  return MapControlPanel;
}

var _default = MapControlPanelFactory;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9tYXAvbWFwLWNvbnRyb2wtcGFuZWwudHN4Il0sIm5hbWVzIjpbIlN0eWxlZE1hcENvbnRyb2xQYW5lbCIsInN0eWxlZCIsImRpdiIsInByb3BzIiwidGhlbWUiLCJtYXBQYW5lbEJhY2tncm91bmRDb2xvciIsIlN0eWxlZE1hcENvbnRyb2xQYW5lbENvbnRlbnQiLCJhdHRycyIsImNsYXNzTmFtZSIsImRyb3Bkb3duU2Nyb2xsQmFyIiwibWFwQ29udHJvbCIsIndpZHRoIiwiU3R5bGVkTWFwQ29udHJvbFBhbmVsSGVhZGVyIiwibWFwUGFuZWxIZWFkZXJCYWNrZ3JvdW5kQ29sb3IiLCJmb250RmFtaWx5IiwidGl0bGVUZXh0Q29sb3IiLCJTdHlsZWRNYXBDb250cm9sUGFuZWxIZWFkZXJTcGxpdFZpZXdwb3J0c1Rvb2xzIiwiU3R5bGVkU0JDZW50ZXJGbGV4Ym94IiwiQ2VudGVyRmxleGJveCIsIlN0eWxlZERpc2FibGVhYmxlVGV4dCIsInNwYW4iLCJkaXNhYmxlZCIsIlN0eWxlZERpc2FibGVhYmxlU3dpdGNoIiwiU3dpdGNoIiwiU3R5bGVkSWNvbiIsIkljb25Sb3VuZFNtYWxsIiwiYWN0aXZlQ29sb3IiLCJsaW5rQnRuQ29sb3IiLCJNYXBDb250cm9sUGFuZWxGYWN0b3J5IiwiTWFwQ29udHJvbFBhbmVsIiwiUmVhY3QiLCJtZW1vIiwiY2hpbGRyZW4iLCJoZWFkZXIiLCJwaW5uYWJsZSIsImRpc2FibGVDbG9zZSIsIm9uUGluQ2xpY2siLCJvbkNsaWNrIiwic2NhbGUiLCJpc0V4cG9ydCIsImxvZ29Db21wb25lbnQiLCJtYXBTdGF0ZSIsIm9uVG9nZ2xlU3BsaXRNYXBWaWV3cG9ydCIsImlzVmlld3BvcnRVbnN5bmNBbGxvd2VkIiwiaXNWaWV3cG9ydFN5bmNlZCIsImlzWm9vbUxvY2tlZCIsIm9uVW5sb2NrVmlld3BvcnRDaGFuZ2UiLCJvblN5bmNab29tQ2hhbmdlIiwidHJhbnNmb3JtIiwibWFyZ2luQm90dG9tIiwiaXNTcGxp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LE1BQUEsTUFBTSxFQUFDO0FBQVosTUFERixDQUZKLEVBTUdELFlBQVksR0FBRyxJQUFILGdCQUNYLGdDQUFDLFVBQUQ7QUFBWSxNQUFBLFNBQVMsRUFBQyx3QkFBdEI7QUFBK0MsTUFBQSxPQUFPLEVBQUVFO0FBQXhELG9CQUNFLGdDQUFDLFlBQUQ7QUFBTyxNQUFBLE1BQU0sRUFBQztBQUFkLE1BREYsQ0FQSixDQVhKLENBL0JGLGVBd0RFLGdDQUFDLDRCQUFELFFBQStCTCxRQUEvQixDQXhERixDQURGO0FBNERELEdBcEZxRCxDQUF4RDs7QUF1RkFILEVBQUFBLGVBQWUsQ0FBQ3dCLFdBQWhCLEdBQThCLGlCQUE5QjtBQUVBLFNBQU94QixlQUFQO0FBQ0Q7O2VBRWNELHNCIiwic291cmNlc0NvbnRlbnQiOlsiLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVFxuLy8gQ29weXJpZ2h0IGNvbnRyaWJ1dG9ycyB0byB0aGUga2VwbGVyLmdsIHByb2plY3RcblxuaW1wb3J0IFJlYWN0LCB7dXNlQ2FsbGJhY2t9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBzdHlsZWQsIHtTdHlsZWRDb21wb25lbnR9IGZyb20gJ3N0eWxlZC1jb21wb25lbnRzJztcbmltcG9ydCB7Rm9ybWF0dGVkTWVzc2FnZX0gZnJvbSAnQGtlcGxlci5nbC9sb2NhbGl6YXRpb24nO1xuaW1wb3J0IHtDZW50ZXJGbGV4Ym94LCBJY29uUm91bmRTbWFsbH0gZnJvbSAnLi4vY29tbW9uL3N0eWxlZC1jb21wb25lbnRzJztcbmltcG9ydCB7Q2xvc2UsIFBpbn0gZnJvbSAnLi4vY29tbW9uL2ljb25zJztcbmltcG9ydCBTd2l0Y2ggZnJvbSAnLi4vY29tbW9uL3N3aXRjaCc7XG5pbXBvcnQge01hcFN0YXRlfSBmcm9tICdAa2VwbGVyLmdsL3R5cGVzJztcbmltcG9ydCB7QWN0aW9uSGFuZGxlciwgdG9nZ2xlU3BsaXRNYXBWaWV3cG9ydH0gZnJvbSAnQGtlcGxlci5nbC9hY3Rpb25zJztcblxuY29uc3QgU3R5bGVkTWFwQ29udHJvbFBhbmVsID0gc3R5bGVkLmRpdmBcbiAgYmFja2dyb3VuZC1jb2xvcjogJHtwcm9wcyA9PiBwcm9wcy50aGVtZS5tYXBQYW5lbEJhY2tncm91bmRDb2xvcn07XG4gIGZsZXgtZ3JvdzogMTtcbiAgei1pbmRleDogMTtcbiAgcCB7XG4gICAgbWFyZ2luLWJvdHRvbTogMDtcbiAgfVxuYDtcblxuY29uc3QgU3R5bGVkTWFwQ29udHJvbFBhbmVsQ29udGVudCA9IHN0eWxlZC5kaXYuYXR0cnMoe1xuICBjbGFzc05hbWU6ICdtYXAtY29udHJvbF9fcGFuZWwtY29udGVudCdcbn0pYFxuICAke3Byb3BzID0+IHByb3BzLnRoZW1lLmRyb3Bkb3duU2Nyb2xsQmFyfTtcbiAgbWF4LWhlaWdodDogNTAwcHg7XG4gIG1pbi1oZWlnaHQ6IDEwMHB4O1xuICBtaW4td2lkdGg6ICR7cHJvcHMgPT4gcHJvcHMudGhlbWUubWFwQ29udHJvbC53aWR0aH1weDtcbiAgb3ZlcmZsb3c6IG92ZXJsYXk7XG5gO1xuXG50eXBlIE1hcENvbnRyb2xQYW5lbEhlYWRlclByb3BzID0ge1xuICBjaGlsZHJlbj86IFJlYWN0LlJlYWN0Tm9kZVtdO1xufTtcblxuY29uc3QgU3R5bGVkTWFwQ29udHJvbFBhbmVsSGVhZGVyID0gc3R5bGVkLmRpdi5hdHRycyh7XG4gIGNsYXNzTmFtZTogJ21hcC1jb250cm9sX19wYW5lbC1oZWFkZXInXG59KTxNYXBDb250cm9sUGFuZWxIZWFkZXJQcm9wcz5gXG4gIGRpc3BsYXk6IGZsZXg7XG4gIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjtcbiAgYmFja2dyb3VuZC1jb2xvcjogJHtwcm9wcyA9PiBwcm9wcy50aGVtZS5tYXBQYW5lbEhlYWRlckJhY2tncm91bmRDb2xvcn07XG4gIGhlaWdodDogMzJweDtcbiAgcGFkZGluZzogNnB4IDEycHg7XG4gIGZvbnQtZmFtaWx5OiAke3Byb3BzID0+IHByb3BzLnRoZW1lLmZvbnRGYW1pbHl9O1xuICBmb250LXNpemU6IDExcHg7XG4gIGNvbG9yOiAke3Byb3BzID0+IHByb3BzLnRoZW1lLnRpdGxlVGV4dENvbG9yfTtcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xuICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuXG4gIGJ1dHRvbiB7XG4gICAgd2lkdGg6IDE4cHg7XG4gICAgaGVpZ2h0OiAxOHB4O1xuICB9XG5gO1xuXG5jb25zdCBTdHlsZWRNYXBDb250cm9sUGFuZWxIZWFkZXJTcGxpdFZpZXdwb3J0c1Rvb2xzOiBTdHlsZWRDb21wb25lbnQ8XG4gICdkaXYnLFxuICBhbnksXG4gIHtcbiAgICBjbGFzc05hbWU6ICdtYXAtY29udHJvbF9fcGFuZWwtc3BsaXQtdmlld3BvcnQtdG9vbHMnO1xuICB9LFxuICAnY2xhc3NOYW1lJ1xuPiA9IHN0eWxlZChTdHlsZWRNYXBDb250cm9sUGFuZWxIZWFkZXIpLmF0dHJzKHtcbiAgY2xhc3NOYW1lOiAnbWFwLWNvbnRyb2xfX3BhbmVsLXNwbGl0LXZpZXdwb3J0LXRvb2xzJ1xufSlgXG4gIGRpc3BsYXk6IGZsZXg7XG4gIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjtcbiAgYWxpZ24taXRlbXM6IHNlbGYtc3RhcnQ7XG4gIGhlaWdodDogdW5zZXQ7XG5gO1xuXG5jb25zdCBTdHlsZWRTQkNlbnRlckZsZXhib3ggPSBzdHlsZWQoQ2VudGVyRmxleGJveClgXG4gIHdpZHRoOiAxMDAlO1xuICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XG4gIGZsZXgtZGlyZWN0aW9uOiByb3c7XG5gO1xuXG5pbnRlcmZhY2UgU3R5bGVkRGlzYWJsZWFibGVUZXh0UHJvcHMge1xuICBkaXNhYmxlZD86IGJvb2xlYW47XG59XG5cbmNvbnN0IFN0eWxlZERpc2FibGVhYmxlVGV4dCA9IHN0eWxlZC5zcGFuPFN0eWxlZERpc2FibGVhYmxlVGV4dFByb3BzPmBcbiAgb3BhY2l0eTogJHtwcm9wcyA9PiAocHJvcHMuZGlzYWJsZWQgPyAwLjQgOiAxKX07XG4gIHBvaW50ZXItZXZlbnRzOiAke3Byb3BzID0+IChwcm9wcy5kaXNhYmxlZCA/ICdub25lJyA6ICdhbGwnKX07XG5gO1xuXG5jb25zdCBTdHlsZWREaXNhYmxlYWJsZVN3aXRjaCA9IHN0eWxlZChTd2l0Y2gpYFxuICBvcGFjaXR5OiAke3Byb3BzID0+IChwcm9wcy5kaXNhYmxlZCA/IDAuNCA6IDEpfTtcbiAgcG9pbnRlci1ldmVudHM6ICR7cHJvcHMgPT4gKHByb3BzLmRpc2FibGVkID8gJ25vbmUnIDogJ2FsbCcpfTtcbmA7XG5cbmNvbnN0IFN0eWxlZEljb24gPSBzdHlsZWQoSWNvblJvdW5kU21hbGwpYFxuICBjb2xvcjogJHtwcm9wcyA9PiBwcm9wcy50aGVtZS5hY3RpdmVDb2xvcn07XG4gIGJhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50O1xuXG4gIDpob3ZlciB7XG4gICAgY3Vyc29yOiBwb2ludGVyO1xuICAgIGJhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50O1xuICAgIGNvbG9yOiAke3Byb3BzID0+IHByb3BzLnRoZW1lLmxpbmtCdG5Db2xvcn07XG4gIH1cbmA7XG5cbmV4cG9ydCB0eXBlIE1hcENvbnRyb2xQYW5lbFByb3BzID0ge1xuICBoZWFkZXI/OiBzdHJpbmc7XG4gIHNjYWxlPzogbnVtYmVyO1xuICBvbkNsaWNrOiBSZWFjdC5Nb3VzZUV2ZW50SGFuZGxlcjxIVE1MRGl2RWxlbWVudD47XG4gIG9uUGluQ2xpY2s/OiBSZWFjdC5Nb3VzZUV2ZW50SGFuZGxlcjxIVE1MRGl2RWxlbWVudD47XG4gIHBpbm5hYmxlPzogYm9vbGVhbjtcbiAgZGlzYWJsZUNsb3NlPzogYm9vbGVhbjtcbiAgaXNFeHBvcnQ/OiBib29sZWFuO1xuICBsb2dvQ29tcG9uZW50PzogRWxlbWVudDtcbiAgbWFwU3RhdGU/OiBNYXBTdGF0ZTtcbiAgb25Ub2dnbGVTcGxpdE1hcFZpZXdwb3J0PzogQWN0aW9uSGFuZGxlcjx0eXBlb2YgdG9nZ2xlU3BsaXRNYXBWaWV3cG9ydD47XG4gIGlzVmlld3BvcnRVbnN5bmNBbGxvd2VkPzogYm9vbGVhbjtcbiAgY2hpbGRyZW4/OiBSZWFjdC5SZWFjdE5vZGU7XG59O1xuXG5mdW5jdGlvbiBNYXBDb250cm9sUGFuZWxGYWN0b3J5KCkge1xuICBjb25zdCBNYXBDb250cm9sUGFuZWw6IFJlYWN0LkZDPE1hcENvbnRyb2xQYW5lbFByb3BzPiA9IFJlYWN0Lm1lbW8oXG4gICAgKHtcbiAgICAgIGNoaWxkcmVuLFxuICAgICAgaGVhZGVyLFxuICAgICAgcGlubmFibGUsXG4gICAgICBkaXNhYmxlQ2xvc2UsXG4gICAgICBvblBpbkNsaWNrLFxuICAgICAgb25DbGljayxcbiAgICAgIHNjYWxlID0gMSxcbiAgICAgIGlzRXhwb3J0LFxuICAgICAgbG9nb0NvbXBvbmVudCxcbiAgICAgIG1hcFN0YXRlLFxuICAgICAgb25Ub2dnbGVTcGxpdE1hcFZpZXdwb3J0LFxuICAgICAgaXNWaWV3cG9ydFVuc3luY0FsbG93ZWRcbiAgICB9KSA9PiB7XG4gICAgICBjb25zdCB7aXNWaWV3cG9ydFN5bmNlZCwgaXNab29tTG9ja2VkfSA9IG1hcFN0YXRlIHx8IHt9O1xuICAgICAgY29uc3Qgb25VbmxvY2tWaWV3cG9ydENoYW5nZSA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICAgICAgb25Ub2dnbGVTcGxpdE1hcFZpZXdwb3J0Py4oe2lzVmlld3BvcnRTeW5jZWQ6ICFpc1ZpZXdwb3J0U3luY2VkfSk7XG4gICAgICB9LCBbaXNWaWV3cG9ydFN5bmNlZCwgb25Ub2dnbGVTcGxpdE1hcFZpZXdwb3J0XSk7XG5cbiAgICAgIGNvbnN0IG9uU3luY1pvb21DaGFuZ2UgPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgICAgIG9uVG9nZ2xlU3BsaXRNYXBWaWV3cG9ydD8uKHtpc1pvb21Mb2NrZWQ6ICFpc1pvb21Mb2NrZWR9KTtcbiAgICAgIH0sIFtpc1pvb21Mb2NrZWQsIG9uVG9nZ2xlU3BsaXRNYXBWaWV3cG9ydF0pO1xuXG4gICAgICByZXR1cm4gKFxuICAgICAgICA8U3R5bGVkTWFwQ29udHJvbFBhbmVsXG4gICAgICAgICAgY2xhc3NOYW1lPVwibWFwLWNvbnRyb2wtcGFuZWxcIlxuICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICB0cmFuc2Zvcm06IGBzY2FsZSgke3NjYWxlfSlgLFxuICAgICAgICAgICAgbWFyZ2luQm90dG9tOiAnOHB4ICFpbXBvcnRhbnQnXG4gICAgICAgICAgfX1cbiAgICAgICAgPlxuICAgICAgICAgIHttYXBTdGF0ZT8uaXNTcGxpdCAmJiBpc1ZpZXdwb3J0VW5zeW5jQWxsb3dlZCA/IChcbiAgICAgICAgICAgIDxTdHlsZWRNYXBDb250cm9sUGFuZWxIZWFkZXJTcGxpdFZpZXdwb3J0c1Rvb2xzPlxuICAgICAgICAgICAgICA8U3R5bGVkU0JDZW50ZXJGbGV4Ym94IHN0eWxlPXt7cGFkZGluZ0JvdHRvbTogJzZweCd9fT5cbiAgICAgICAgICAgICAgICA8Rm9ybWF0dGVkTWVzc2FnZSBpZD1cIlVubG9jayBWaWV3cG9ydFwiIC8+XG4gICAgICAgICAgICAgICAgPFN0eWxlZERpc2FibGVhYmxlU3dpdGNoXG4gICAgICAgICAgICAgICAgICBjaGVja2VkPXshbWFwU3RhdGU/LmlzVmlld3BvcnRTeW5jZWR9XG4gICAgICAgICAgICAgICAgICBpZD1cInVubG9jay12aWV3cG9ydC10b2dnbGVcIlxuICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e29uVW5sb2NrVmlld3BvcnRDaGFuZ2V9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgPC9TdHlsZWRTQkNlbnRlckZsZXhib3g+XG4gICAgICAgICAgICAgIDxTdHlsZWRTQkNlbnRlckZsZXhib3g+XG4gICAgICAgICAgICAgICAgPFN0eWxlZERpc2FibGVhYmxlVGV4dCBkaXNhYmxlZD17bWFwU3RhdGU/LmlzVmlld3BvcnRTeW5jZWR9PlxuICAgICAgICAgICAgICAgICAgPEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJTeW5jIFpvb21cIiAvPlxuICAgICAgICAgICAgICAgIDwvU3R5bGVkRGlzYWJsZWFibGVUZXh0PlxuICAgICAgICAgICAgICAgIDxTdHlsZWREaXNhYmxlYWJsZVN3aXRjaFxuICAgICAgICAgICAgICAgICAgY2hlY2tlZD17bWFwU3RhdGU/LmlzWm9vbUxvY2tlZH1cbiAgICAgICAgICAgICAgICAgIGlkPVwic3luYy16b29tLXRvZ2dsZVwiXG4gICAgICAgICAgICAgICAgICBvbkNoYW5nZT17b25TeW5jWm9vbUNoYW5nZX1cbiAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXttYXBTdGF0ZT8uaXNWaWV3cG9ydFN5bmNlZH1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICA8L1N0eWxlZFNCQ2VudGVyRmxleGJveD5cbiAgICAgICAgICAgIDwvU3R5bGVkTWFwQ29udHJvbFBhbmVsSGVhZGVyU3BsaXRWaWV3cG9ydHNUb29scz5cbiAgICAgICAgICApIDogbnVsbH1cblxuICAgICAgICAgIDxTdHlsZWRNYXBDb250cm9sUGFuZWxIZWFkZXI+XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIChpc0V4cG9ydCAmJiBsb2dvQ29tcG9uZW50ID8gKFxuICAgICAgICAgICAgICAgIGxvZ29Db21wb25lbnRcbiAgICAgICAgICAgICAgKSA6IGhlYWRlciA/IChcbiAgICAgICAgICAgICAgICA8c3BhbiBzdHlsZT17e3ZlcnRpY2FsQWxpZ246ICdtaWRkbGUnfX0+XG4gICAgICAgICAgICAgICAgICA8Rm9ybWF0dGVkTWVzc2FnZSBpZD17aGVhZGVyfSAvPlxuICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgKSA6IG51bGwpIGFzIFJlYWN0LlJlYWN0Tm9kZVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAge2lzRXhwb3J0ID8gbnVsbCA6IChcbiAgICAgICAgICAgICAgPD5cbiAgICAgICAgICAgICAgICB7cGlubmFibGUgJiYgKFxuICAgICAgICAgICAgICAgICAgPFN0eWxlZEljb24gY2xhc3NOYW1lPVwicGluLW1hcC1jb250cm9sLWl0ZW1cIiBvbkNsaWNrPXtvblBpbkNsaWNrfT5cbiAgICAgICAgICAgICAgICAgICAgPFBpbiBoZWlnaHQ9XCIxNnB4XCIgLz5cbiAgICAgICAgICAgICAgICAgIDwvU3R5bGVkSWNvbj5cbiAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgIHtkaXNhYmxlQ2xvc2UgPyBudWxsIDogKFxuICAgICAgICAgICAgICAgICAgPFN0eWxlZEljb24gY2xhc3NOYW1lPVwiY2xvc2UtbWFwLWNvbnRyb2wtaXRlbVwiIG9uQ2xpY2s9e29uQ2xpY2t9PlxuICAgICAgICAgICAgICAgICAgICA8Q2xvc2UgaGVpZ2h0PVwiMTZweFwiIC8+XG4gICAgICAgICAgICAgICAgICA8L1N0eWxlZEljb24+XG4gICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgPC8+XG4gICAgICAgICAgICApfVxuICAgICAgICAgIDwvU3R5bGVkTWFwQ29udHJvbFBhbmVsSGVhZGVyPlxuICAgICAgICAgIDxTdHlsZWRNYXBDb250cm9sUGFuZWxDb250ZW50PntjaGlsZHJlbn08L1N0eWxlZE1hcENvbnRyb2xQYW5lbENvbnRlbnQ+XG4gICAgICAgIDwvU3R5bGVkTWFwQ29udHJvbFBhbmVsPlxuICAgICAgKTtcbiAgICB9XG4gICk7XG5cbiAgTWFwQ29udHJvbFBhbmVsLmRpc3BsYXlOYW1lID0gJ01hcENvbnRyb2xQYW5lbCc7XG5cbiAgcmV0dXJuIE1hcENvbnRyb2xQYW5lbDtcbn1cblxuZXhwb3J0IGRlZmF1bHQgTWFwQ29udHJvbFBhbmVsRmFjdG9yeTtcbiJdfQ==
"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _taggedTemplateLiteral2 = _interopRequireDefault(require("@babel/runtime/helpers/taggedTemplateLiteral"));

var _react = _interopRequireDefault(require("react"));

var _styledComponents = _interopRequireDefault(require("styled-components"));

var _classnames = _interopRequireDefault(require("classnames"));

var _localization = require("@kepler.gl/localization");

var _constants = require("@kepler.gl/constants");

var _icons = require("../../common/icons");

var _panelHeaderAction = _interopRequireDefault(require("../panel-header-action"));

var _styledComponents2 = require("../../common/styled-components");

var _templateObject;

var StyledMapDropdown = (0, _styledComponents["default"])(_styledComponents2.StyledPanelHeader)(_templateObject || (_templateObject = (0, _taggedTemplateLiteral2["default"])(["\n  height: 48px;\n  margin-bottom: 5px;\n  opacity: 1;\n  position: relative;\n  transition: opacity 0.05s ease-in, height 0.25s ease-out;\n\n  &.collapsed {\n    height: 0;\n    margin-bottom: 0;\n    opacity: 0;\n  }\n\n  :hover {\n    cursor: pointer;\n    background-color: ", ";\n  }\n\n  .map-title-block img {\n    margin-right: 12px;\n  }\n\n  .map-preview {\n    border-radius: 3px;\n    height: 30px;\n    width: 40px;\n  }\n\n  &.selected {\n    outline: 1px solid #caf2f4;\n  }\n\n  /* show callout dot if props.hasCallout and theme provides calloutDot base styles */\n  :after {\n    ", "\n    background-color: #00ACF5;\n    top: 12px;\n    left: 15px;\n    display: ", ";\n  }\n\n  .custom-style-actions {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n  }\n"])), function (props) {
  return props.theme.panelBackgroundHover;
}, function (_ref) {
  var theme = _ref.theme;
  return theme.calloutDot;
}, function (_ref2) {
  var theme = _ref2.theme,
      hasCallout = _ref2.hasCallout;
  return theme.calloutDot && hasCallout ? 'block' : 'none';
});
MapStyleSelectorFactory.deps = [_panelHeaderAction["default"]];

function MapStyleSelectorFactory(PanelHeaderAction) {
  var defaultActionIcons = {
    arrowDown: _icons.ArrowDown
  };

  var MapStyleSelector = function MapStyleSelector(_ref3) {
    var mapStyle = _ref3.mapStyle,
        onChange = _ref3.onChange,
        toggleActive = _ref3.toggleActive,
        isSelecting = _ref3.isSelecting,
        customMapStylesActions = _ref3.customMapStylesActions,
        _ref3$actionIcons = _ref3.actionIcons,
        actionIcons = _ref3$actionIcons === void 0 ? defaultActionIcons : _ref3$actionIcons;
    var mapStyles = mapStyle.mapStyles,
        styleType = mapStyle.styleType;
    return /*#__PURE__*/_react["default"].createElement("div", null, /*#__PURE__*/_react["default"].createElement(_styledComponents2.PanelLabel, null, /*#__PURE__*/_react["default"].createElement(_localization.FormattedMessage, {
      id: 'mapManager.mapStyle'
    })), Object.values(mapStyles).map(function (_ref4) {
      var id = _ref4.id,
          custom = _ref4.custom,
          _ref4$icon = _ref4.icon,
          icon = _ref4$icon === void 0 ? _constants.NO_BASEMAP_ICON : _ref4$icon,
          _ref4$label = _ref4.label,
          label = _ref4$label === void 0 ? 'Untitled' : _ref4$label;
      return /*#__PURE__*/_react["default"].createElement(StyledMapDropdown, {
        className: (0, _classnames["default"])('map-dropdown-option', {
          collapsed: !isSelecting && id !== styleType,
          selected: isSelecting && id === styleType
        }),
        key: id,
        onClick: isSelecting ? function () {
          return onChange(id);
        } : toggleActive,
        hasCallout: Boolean(custom)
      }, /*#__PURE__*/_react["default"].createElement(_styledComponents2.PanelHeaderContent, {
        className: "map-title-block"
      }, /*#__PURE__*/_react["default"].createElement("img", {
        className: "map-preview",
        src: icon
      }), /*#__PURE__*/_react["default"].createElement(_styledComponents2.PanelHeaderTitle, {
        className: "map-preview-name"
      }, label)), !isSelecting ? /*#__PURE__*/_react["default"].createElement(PanelHeaderAction, {
        className: "map-dropdown-option__enable-config",
        id: "map-enable-config",
        IconComponent: actionIcons.arrowDown,
        tooltip: 'tooltip.selectBaseMapStyle',
        onClick: toggleActive
      }) : null, isSelecting && custom ? /*#__PURE__*/_react["default"].createElement("div", {
        className: "custom-style-actions"
      }, ((customMapStylesActions === null || customMapStylesActions === void 0 ? void 0 : customMapStylesActions[id]) || []).map(function (action) {
        return /*#__PURE__*/_react["default"].createElement(PanelHeaderAction, {
          key: action.id,
          className: "map-dropdown-option__enable-config",
          id: action.id,
          IconComponent: action.IconComponent,
          tooltip: action.tooltip,
          onClick: function onClick(e) {
            e.stopPropagation();
            action.onClick();
          }
        });
      })) : null);
    }));
  };

  return MapStyleSelector;
}

var _default = MapStyleSelectorFactory;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9zaWRlLXBhbmVsL21hcC1zdHlsZS1wYW5lbC9tYXAtc3R5bGUtc2VsZWN0b3IudHN4Il0sIm5hbWVzIjpbIlN0eWxlZE1hcERyb3Bkb3duIiwiU3R5bGVkUGFuZWxIZWFkZXIiLCJwcm9wcyIsInRoZW1lIiwicGFuZWxCYWNrZ3JvdW5kSG92ZXIiLCJjYWxsb3V0RG90IiwiaGFzQ2FsbG91dCIsIk1hcFN0eWxlU2VsZWN0b3JGYWN0b3J5IiwiZGVwcyIsIlBhbmVsSGVhZGVyQWN0aW9uRmFjdG9yeSIsIlBhbmVsSGVhZGVyQWN0aW9uIiwiZGVmYXVsdEFjdGlvbkljb25zIiwiYXJyb3dEb3duIiwiQXJyb3dEb3duIiwiTWFwU3R5bGVTZWxlY3RvciIsIm1hcFN0eWxlIiwib25DaGFuZ2UiLCJ0b2dnbGVBY3RpdmUiLCJpc1NlbGVjdGluZyIsImN1c3RvbU1hcFN0eWxlc0FjdGlvbnMiLCJhY3Rpb25JY29ucyIsIm1hcFN0eWxlcyIsInN0eWxlVHlwZSIsIk9iamVjdCIsInZhbHVlcyIsIm1hcCIsImlkIiwiY3VzdG9tIiwiaWNvbiIsIk5PX0JBU0VNQVBfSUNPTiIsImxhYmVsIiwiY29sbGFwc2VkIiwic2VsZWN0ZWQiLCJCb29sZWFuIiwiYWN0aW9uIiwiSWNvbkNvbXBvbmVudCIsInRvb2x0aXAiLCJlIiwic3RvcFByb3BhZ2F0aW9uIiwib25DbGljayJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFHQTs7QUFDQTs7QUFDQTs7QUFFQTs7QUFFQTs7QUFHQTs7QUFDQTs7QUFDQTs7OztBQVlBLElBQU1BLGlCQUFpQixHQUFHLGtDQUFPQyxvQ0FBUCxDQUFILGs0QkFlQyxVQUFBQyxLQUFLO0FBQUEsU0FBSUEsS0FBSyxDQUFDQyxLQUFOLENBQVlDLG9CQUFoQjtBQUFBLENBZk4sRUFrQ2pCO0FBQUEsTUFBRUQsS0FBRixRQUFFQSxLQUFGO0FBQUEsU0FBYUEsS0FBSyxDQUFDRSxVQUFuQjtBQUFBLENBbENpQixFQXNDUjtBQUFB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QUFEO0FBQ0UsVUFBQSxHQUFHLEVBQUVBLE1BQU0sQ0FBQ1IsRUFEZDtBQUVFLFVBQUEsU0FBUyxFQUFDLG9DQUZaO0FBR0UsVUFBQSxFQUFFLEVBQUVRLE1BQU0sQ0FBQ1IsRUFIYjtBQUlFLFVBQUEsYUFBYSxFQUFFUSxNQUFNLENBQUNDLGFBSnhCO0FBS0UsVUFBQSxPQUFPLEVBQUVELE1BQU0sQ0FBQ0UsT0FMbEI7QUFNRSxVQUFBLE9BQU8sRUFBRSxpQkFBQUMsQ0FBQyxFQUFJO0FBQ1pBLFlBQUFBLENBQUMsQ0FBQ0MsZUFBRjtBQUNBSixZQUFBQSxNQUFNLENBQUNLLE9BQVA7QUFDRDtBQVRILFVBRDhDO0FBQUEsT0FBL0MsQ0FESCxDQURELEdBZ0JHLElBdENOLENBREY7QUFBQSxLQURELENBTEgsQ0FERjtBQW9ERCxHQTlERDs7QUFnRUEsU0FBT3pCLGdCQUFQO0FBQ0Q7O2VBRWNQLHVCIiwic291cmNlc0NvbnRlbnQiOlsiLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVFxuLy8gQ29weXJpZ2h0IGNvbnRyaWJ1dG9ycyB0byB0aGUga2VwbGVyLmdsIHByb2plY3RcblxuaW1wb3J0IFJlYWN0LCB7Q29tcG9uZW50VHlwZX0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHN0eWxlZCBmcm9tICdzdHlsZWQtY29tcG9uZW50cyc7XG5pbXBvcnQgY2xhc3NuYW1lcyBmcm9tICdjbGFzc25hbWVzJztcblxuaW1wb3J0IHtGb3JtYXR0ZWRNZXNzYWdlfSBmcm9tICdAa2VwbGVyLmdsL2xvY2FsaXphdGlvbic7XG5pbXBvcnQge01hcFN0eWxlfSBmcm9tICdAa2VwbGVyLmdsL3JlZHVjZXJzJztcbmltcG9ydCB7Tk9fQkFTRU1BUF9JQ09OfSBmcm9tICdAa2VwbGVyLmdsL2NvbnN0YW50cyc7XG5pbXBvcnQge01hcFN0eWxlc30gZnJvbSAnQGtlcGxlci5nbC90eXBlcyc7XG5cbmltcG9ydCB7QXJyb3dEb3dufSBmcm9tICcuLi8uLi9jb21tb24vaWNvbnMnO1xuaW1wb3J0IFBhbmVsSGVhZGVyQWN0aW9uRmFjdG9yeSBmcm9tICcuLi9wYW5lbC1oZWFkZXItYWN0aW9uJztcbmltcG9ydCB7XG4gIFBhbmVsSGVhZGVyQ29udGVudCxcbiAgUGFuZWxIZWFkZXJUaXRsZSxcbiAgUGFuZWxMYWJlbCxcbiAgU3R5bGVkUGFuZWxIZWFkZXIsXG4gIFN0eWxlZFBhbmVsSGVhZGVyUHJvcHNcbn0gZnJvbSAnLi4vLi4vY29tbW9uL3N0eWxlZC1jb21wb25lbnRzJztcbmltcG9ydCB7QmFzZVByb3BzfSBmcm9tICcuLi8uLi9jb21tb24vaWNvbnMnO1xuaW1wb3J0IHtQYW5lbEhlYWRlckFjdGlvbkljb259IGZyb20gJy4uL3BhbmVsLWhlYWRlci1hY3Rpb24nO1xuXG50eXBlIFN0eWxlZE1hcERyb3Bkb3duUHJvcHMgPSBTdHlsZWRQYW5lbEhlYWRlclByb3BzICYge2hhc0NhbGxvdXQ6IGJvb2xlYW59O1xuXG5jb25zdCBTdHlsZWRNYXBEcm9wZG93biA9IHN0eWxlZChTdHlsZWRQYW5lbEhlYWRlcik8U3R5bGVkTWFwRHJvcGRvd25Qcm9wcz5gXG4gIGhlaWdodDogNDhweDtcbiAgbWFyZ2luLWJvdHRvbTogNXB4O1xuICBvcGFjaXR5OiAxO1xuICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gIHRyYW5zaXRpb246IG9wYWNpdHkgMC4wNXMgZWFzZS1pbiwgaGVpZ2h0IDAuMjVzIGVhc2Utb3V0O1xuXG4gICYuY29sbGFwc2VkIHtcbiAgICBoZWlnaHQ6IDA7XG4gICAgbWFyZ2luLWJvdHRvbTogMDtcbiAgICBvcGFjaXR5OiAwO1xuICB9XG5cbiAgOmhvdmVyIHtcbiAgICBjdXJzb3I6IHBvaW50ZXI7XG4gICAgYmFja2dyb3VuZC1jb2xvcjogJHtwcm9wcyA9PiBwcm9wcy50aGVtZS5wYW5lbEJhY2tncm91bmRIb3Zlcn07XG4gIH1cblxuICAubWFwLXRpdGxlLWJsb2NrIGltZyB7XG4gICAgbWFyZ2luLXJpZ2h0OiAxMnB4O1xuICB9XG5cbiAgLm1hcC1wcmV2aWV3IHtcbiAgICBib3JkZXItcmFkaXVzOiAzcHg7XG4gICAgaGVpZ2h0OiAzMHB4O1xuICAgIHdpZHRoOiA0MHB4O1xuICB9XG5cbiAgJi5zZWxlY3RlZCB7XG4gICAgb3V0bGluZTogMXB4IHNvbGlkICNjYWYyZjQ7XG4gIH1cblxuICAvKiBzaG93IGNhbGxvdXQgZG90IGlmIHByb3BzLmhhc0NhbGxvdXQgYW5kIHRoZW1lIHByb3ZpZGVzIGNhbGxvdXREb3QgYmFzZSBzdHlsZXMgKi9cbiAgOmFmdGVyIHtcbiAgICAkeyh7dGhlbWV9KSA9PiB0aGVtZS5jYWxsb3V0RG90fVxuICAgIGJhY2tncm91bmQtY29sb3I6ICMwMEFDRjU7XG4gICAgdG9wOiAxMnB4O1xuICAgIGxlZnQ6IDE1cHg7XG4gICAgZGlzcGxheTogJHsoe3RoZW1lLCBoYXNDYWxsb3V0fSkgPT4gKHRoZW1lLmNhbGxvdXREb3QgJiYgaGFzQ2FsbG91dCA/ICdibG9jaycgOiAnbm9uZScpfTtcbiAgfVxuXG4gIC5jdXN0b20tc3R5bGUtYWN0aW9ucyB7XG4gICAgZGlzcGxheTogZmxleDtcbiAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgfVxuYDtcblxuZXhwb3J0IHR5cGUgTWFwU3R5bGVTZWxlY3RvclByb3BzID0ge1xuICBtYXBTdHlsZTogTWFwU3R5bGU7XG4gIG9uQ2hhbmdlOiAocGF5bG9hZDogc3RyaW5nKSA9PiB2b2lkO1xuICB0b2dnbGVBY3RpdmU6ICgpID0+IHZvaWQ7XG4gIGlzU2VsZWN0aW5nOiBib29sZWFuO1xuICBjdXN0b21NYXBTdHlsZXNBY3Rpb25zPzogUmVjb3JkPFxuICAgIHN0cmluZyxcbiAgICB7XG4gICAgICBpZDogc3RyaW5nO1xuICAgICAgSWNvbkNvbXBvbmVudDogUGFuZWxIZWFkZXJBY3Rpb25JY29uO1xuICAgICAgdG9vbHRpcDogc3RyaW5nO1xuICAgICAgb25DbGljazogKCkgPT4gdm9pZDtcbiAgICB9W11cbiAgPjtcbiAgYWN0aW9uSWNvbnM/OiBSZWNvcmQ8c3RyaW5nLCBDb21wb25lbnRUeXBlPFBhcnRpYWw8QmFzZVByb3BzPj4+O1xufTtcblxuTWFwU3R5bGVTZWxlY3RvckZhY3RvcnkuZGVwcyA9IFtQYW5lbEhlYWRlckFjdGlvbkZhY3RvcnldO1xuXG5mdW5jdGlvbiBNYXBTdHlsZVNlbGVjdG9yRmFjdG9yeShQYW5lbEhlYWRlckFjdGlvbjogUmV0dXJuVHlwZTx0eXBlb2YgUGFuZWxIZWFkZXJBY3Rpb25GYWN0b3J5Pikge1xuICBjb25zdCBkZWZhdWx0QWN0aW9uSWNvbnMgPSB7XG4gICAgYXJyb3dEb3duOiBBcnJvd0Rvd25cbiAgfTtcblxuICBjb25zdCBNYXBTdHlsZVNlbGVjdG9yID0gKHtcbiAgICBtYXBTdHlsZSxcbiAgICBvbkNoYW5nZSxcbiAgICB0b2dnbGVBY3RpdmUsXG4gICAgaXNTZWxlY3RpbmcsXG4gICAgY3VzdG9tTWFwU3R5bGVzQWN0aW9ucyxcbiAgICBhY3Rpb25JY29ucyA9IGRlZmF1bHRBY3Rpb25JY29uc1xuICB9OiBNYXBTdHlsZVNlbGVjdG9yUHJvcHMpID0+IHtcbiAgICBjb25zdCB7bWFwU3R5bGVzLCBzdHlsZVR5cGV9OiB7bWFwU3R5bGVzOiBNYXBTdHlsZXM7IHN0eWxlVHlwZTogc3RyaW5nfSA9IG1hcFN0eWxlO1xuXG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXY+XG4gICAgICAgIDxQYW5lbExhYmVsPlxuICAgICAgICAgIDxGb3JtYXR0ZWRNZXNzYWdlIGlkPXsnbWFwTWFuYWdlci5tYXBTdHlsZSd9IC8+XG4gICAgICAgIDwvUGFuZWxMYWJlbD5cblxuICAgICAgICB7T2JqZWN0LnZhbHVlcyhtYXBTdHlsZXMpLm1hcChcbiAgICAgICAgICAoe2lkLCBjdXN0b20sIGljb24gPSBOT19CQVNFTUFQX0lDT04sIGxhYmVsID0gJ1VudGl0bGVkJ30pID0+IChcbiAgICAgICAgICAgIDxTdHlsZWRNYXBEcm9wZG93blxuICAgICAgICAgICAgICBjbGFzc05hbWU9e2NsYXNzbmFtZXMoJ21hcC1kcm9wZG93bi1vcHRpb24nLCB7XG4gICAgICAgICAgICAgICAgY29sbGFwc2VkOiAhaXNTZWxlY3RpbmcgJiYgaWQgIT09IHN0eWxlVHlwZSxcbiAgICAgICAgICAgICAgICBzZWxlY3RlZDogaXNTZWxlY3RpbmcgJiYgaWQgPT09IHN0eWxlVHlwZVxuICAgICAgICAgICAgICB9KX1cbiAgICAgICAgICAgICAga2V5PXtpZH1cbiAgICAgICAgICAgICAgb25DbGljaz17aXNTZWxlY3RpbmcgPyAoKSA9PiBvbkNoYW5nZShpZCkgOiB0b2dnbGVBY3RpdmV9XG4gICAgICAgICAgICAgIGhhc0NhbGxvdXQ9e0Jvb2xlYW4oY3VzdG9tKX1cbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgPFBhbmVsSGVhZGVyQ29udGVudCBjbGFzc05hbWU9XCJtYXAtdGl0bGUtYmxvY2tcIj5cbiAgICAgICAgICAgICAgICA8aW1nIGNsYXNzTmFtZT1cIm1hcC1wcmV2aWV3XCIgc3JjPXtpY29ufSAvPlxuICAgICAgICAgICAgICAgIDxQYW5lbEhlYWRlclRpdGxlIGNsYXNzTmFtZT1cIm1hcC1wcmV2aWV3LW5hbWVcIj57bGFiZWx9PC9QYW5lbEhlYWRlclRpdGxlPlxuICAgICAgICAgICAgICA8L1BhbmVsSGVhZGVyQ29udGVudD5cbiAgICAgICAgICAgICAgeyFpc1NlbGVjdGluZyA/IChcbiAgICAgICAgICAgICAgICA8UGFuZWxIZWFkZXJBY3Rpb25cbiAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cIm1hcC1kcm9wZG93bi1vcHRpb25fX2VuYWJsZS1jb25maWdcIlxuICAgICAgICAgICAgICAgICAgaWQ9XCJtYXAtZW5hYmxlLWNvbmZpZ1wiXG4gICAgICAgICAgICAgICAgICBJY29uQ29tcG9uZW50PXthY3Rpb25JY29ucy5hcnJvd0Rvd259XG4gICAgICAgICAgICAgICAgICB0b29sdGlwPXsndG9vbHRpcC5zZWxlY3RCYXNlTWFwU3R5bGUnfVxuICAgICAgICAgICAgICAgICAgb25DbGljaz17dG9nZ2xlQWN0aXZlfVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgICB7aXNTZWxlY3RpbmcgJiYgY3VzdG9tID8gKFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY3VzdG9tLXN0eWxlLWFjdGlvbnNcIj5cbiAgICAgICAgICAgICAgICAgIHsoY3VzdG9tTWFwU3R5bGVzQWN0aW9ucz8uW2lkXSB8fCBbXSkubWFwKGFjdGlvbiA9PiAoXG4gICAgICAgICAgICAgICAgICAgIDxQYW5lbEhlYWRlckFjdGlvblxuICAgICAgICAgICAgICAgICAgICAgIGtleT17YWN0aW9uLmlkfVxuICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cIm1hcC1kcm9wZG93bi1vcHRpb25fX2VuYWJsZS1jb25maWdcIlxuICAgICAgICAgICAgICAgICAgICAgIGlkPXthY3Rpb24uaWR9XG4gICAgICAgICAgICAgICAgICAgICAgSWNvbkNvbXBvbmVudD17YWN0aW9uLkljb25Db21wb25lbnR9XG4gICAgICAgICAgICAgICAgICAgICAgdG9vbHRpcD17YWN0aW9uLnRvb2x0aXB9XG4gICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17ZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm9uQ2xpY2soKTtcbiAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgKSl9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgPC9TdHlsZWRNYXBEcm9wZG93bj5cbiAgICAgICAgICApXG4gICAgICAgICl9XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9O1xuXG4gIHJldHVybiBNYXBTdHlsZVNlbGVjdG9yO1xufVxuXG5leHBvcnQgZGVmYXVsdCBNYXBTdHlsZVNlbGVjdG9yRmFjdG9yeTtcbiJdfQ==
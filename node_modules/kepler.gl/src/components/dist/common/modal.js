"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = exports.ModalDialog = exports.ModalFooter = exports.ModalTitle = void 0;

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _objectWithoutProperties2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));

var _taggedTemplateLiteral2 = _interopRequireDefault(require("@babel/runtime/helpers/taggedTemplateLiteral"));

var _react = _interopRequireWildcard(require("react"));

var _localization = require("@kepler.gl/localization");

var _styledComponents = _interopRequireDefault(require("styled-components"));

var _reactModal = _interopRequireDefault(require("react-modal"));

var _icons = require("./icons");

var _styledComponents2 = require("./styled-components");

var _styles = require("@kepler.gl/styles");

var _templateObject, _templateObject2, _templateObject3, _templateObject4, _templateObject5, _templateObject6, _templateObject7, _templateObject8, _templateObject9, _templateObject10, _templateObject11, _templateObject12, _templateObject13;

function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = (0, _getPrototypeOf2["default"])(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2["default"])(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2["default"])(this, result); }; }

function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2["default"])(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

var ModalContentWrapper = _styledComponents["default"].div(_templateObject || (_templateObject = (0, _taggedTemplateLiteral2["default"])(["\n  overflow-y: auto;\n  max-width: 70vw;\n  max-height: 85vh;\n  padding: 24px 72px 40px;\n  position: relative;\n  top: 92px;\n  left: 0;\n  right: 0;\n  margin: 0 auto;\n  background-color: #ffffff;\n  border-radius: 4px;\n  transition: ", ";\n  box-sizing: border-box;\n  font-size: 12px;\n  color: ", ";\n\n  ", "\n\n  ", "\n\n  ", ";\n"])), function (props) {
  return props.theme.transition;
}, function (props) {
  return props.theme.labelColorLT;
}, _styles.media.portable(_templateObject2 || (_templateObject2 = (0, _taggedTemplateLiteral2["default"])(["\n    padding: 12px 36px 24px;\n    max-width: 80vw;\n  "]))), _styles.media.palm(_templateObject3 || (_templateObject3 = (0, _taggedTemplateLiteral2["default"])(["\n    max-width: 100vw;\n  "]))), function (props) {
  return props.cssStyle || '';
});

var ModalContent = _styledComponents["default"].div(_templateObject4 || (_templateObject4 = (0, _taggedTemplateLiteral2["default"])(["\n  position: relative;\n  z-index: ", ";\n"])), function (props) {
  return props.theme.modalContentZ;
});

var ModalTitle = _styledComponents["default"].div(_templateObject5 || (_templateObject5 = (0, _taggedTemplateLiteral2["default"])(["\n  font-size: ", ";\n  color: ", ";\n  margin-bottom: 10px;\n  position: relative;\n  z-index: ", ";\n"])), function (props) {
  return props.theme.modalTitleFontSize;
}, function (props) {
  return props.theme.modalTitleColor;
}, function (props) {
  return props.theme.modalTitleZ;
});

exports.ModalTitle = ModalTitle;

var StyledModalFooter = _styledComponents["default"].div(_templateObject6 || (_templateObject6 = (0, _taggedTemplateLiteral2["default"])(["\n  width: 100%;\n  left: 0;\n  bottom: 0;\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-end;\n  padding-top: 24px;\n  ", ";\n\n  ", ";\n  z-index: ", ";\n"])), _styles.media.portable(_templateObject7 || (_templateObject7 = (0, _taggedTemplateLiteral2["default"])(["\n    padding-top: 24px;\n  "]))), _styles.media.palm(_templateObject8 || (_templateObject8 = (0, _taggedTemplateLiteral2["default"])(["\n    padding-top: 16px;\n  "]))), function (props) {
  return props.theme.modalFooterZ;
});

var CloseButton = _styledComponents["default"].div(_templateObject9 || (_templateObject9 = (0, _taggedTemplateLiteral2["default"])(["\n  color: ", ";\n  display: flex;\n  justify-content: flex-end;\n  z-index: ", ";\n  position: absolute;\n  top: 24px;\n  right: 24px;\n\n  :hover {\n    cursor: pointer;\n  }\n"])), function (props) {
  return props.theme.titleColorLT;
}, function (props) {
  return props.theme.modalButtonZ;
});

var FooterActionWrapper = _styledComponents["default"].div(_templateObject10 || (_templateObject10 = (0, _taggedTemplateLiteral2["default"])(["\n  display: flex;\n  justify-content: flex-end;\n"])));

var defaultCancelButton = {
  link: true,
  large: true,
  children: 'modal.button.defaultCancel'
};
var defaultConfirmButton = {
  cta: true,
  large: true,
  width: '160px',
  children: 'modal.button.defaultConfirm'
};

/**
 * this method removes the `disabled` property from button props when disabled is set to false
 * to avoid issue with the disabled tag
 *
 * @param props
 */
var processDisabledProperty = function processDisabledProperty(props) {
  if (!props.disabled) {
    var disabled = props.disabled,
        newProps = (0, _objectWithoutProperties2["default"])(props, ["disabled"]);
    return newProps;
  }

  return props;
};

var ModalFooter = function ModalFooter(_ref) {
  var _cancelButtonProps$ch, _confirmButtonProps$c;

  var cancel = _ref.cancel,
      confirm = _ref.confirm,
      cancelButton = _ref.cancelButton,
      confirmButton = _ref.confirmButton;
  var cancelButtonProps = processDisabledProperty(_objectSpread(_objectSpread({}, defaultCancelButton), cancelButton));
  var confirmButtonProps = processDisabledProperty(_objectSpread(_objectSpread({}, defaultConfirmButton), confirmButton));
  return /*#__PURE__*/_react["default"].createElement(StyledModalFooter, {
    className: "modal--footer"
  }, /*#__PURE__*/_react["default"].createElement(FooterActionWrapper, null, /*#__PURE__*/_react["default"].createElement(_styledComponents2.Button, (0, _extends2["default"])({
    className: "modal--footer--cancel-button"
  }, cancelButtonProps, {
    onClick: cancel
  }), /*#__PURE__*/_react["default"].createElement(_localization.FormattedMessage, {
    id: (_cancelButtonProps$ch = cancelButtonProps.children) !== null && _cancelButtonProps$ch !== void 0 ? _cancelButtonProps$ch : ''
  })), /*#__PURE__*/_react["default"].createElement(_styledComponents2.Button, (0, _extends2["default"])({
    className: "modal--footer--confirm-button"
  }, confirmButtonProps, {
    onClick: confirm
  }), /*#__PURE__*/_react["default"].createElement(_localization.FormattedMessage, {
    id: (_confirmButtonProps$c = confirmButtonProps.children) !== null && _confirmButtonProps$c !== void 0 ? _confirmButtonProps$c : ''
  }))));
};

exports.ModalFooter = ModalFooter;

var ModalDialog = /*#__PURE__*/function (_Component) {
  (0, _inherits2["default"])(ModalDialog, _Component);

  var _super = _createSuper(ModalDialog);

  function ModalDialog() {
    (0, _classCallCheck2["default"])(this, ModalDialog);
    return _super.apply(this, arguments);
  }

  (0, _createClass2["default"])(ModalDialog, [{
    key: "render",
    value: function render() {
      var props = this.props;
      return /*#__PURE__*/_react["default"].createElement(_reactModal["default"], (0, _extends2["default"])({
        className: this.props.className
      }, props, {
        ariaHideApp: false,
        style: {
          overlay: _objectSpread({
            backgroundColor: props.theme && props.theme.modalOverlayBgd || 'rgba(0, 0, 0, 0.5)',
            zIndex: props.theme && props.theme.modalOverLayZ || 1000
          }, props.style)
        }
      }), /*#__PURE__*/_react["default"].createElement(ModalContentWrapper, {
        className: "modal--wrapper",
        cssStyle: props.cssStyle
      }, props.close && /*#__PURE__*/_react["default"].createElement(CloseButton, {
        className: "modal--close",
        onClick: props.onCancel
      }, /*#__PURE__*/_react["default"].createElement(_icons.Delete, {
        height: "14px"
      })), /*#__PURE__*/_react["default"].createElement("div", null, props.title && /*#__PURE__*/_react["default"].createElement(ModalTitle, {
        className: "modal--title"
      }, /*#__PURE__*/_react["default"].createElement(_localization.FormattedMessage, {
        id: props.title
      })), /*#__PURE__*/_react["default"].createElement(ModalContent, {
        className: "modal--body"
      }, props.children), props.footer && /*#__PURE__*/_react["default"].createElement(ModalFooter, {
        cancel: props.onCancel,
        confirm: props.onConfirm,
        cancelButton: props.cancelButton,
        confirmButton: props.confirmButton
      }))));
    }
  }]);
  return ModalDialog;
}(_react.Component);

exports.ModalDialog = ModalDialog;
(0, _defineProperty2["default"])(ModalDialog, "defaultProps", {
  footer: false,
  close: true,
  onConfirm: function onConfirm() {},
  onCancel: function onCancel() {},
  cancelButton: defaultCancelButton,
  confirmButton: defaultConfirmButton,
  cssStyle: []
});
var StyledModal = (0, _styledComponents["default"])(ModalDialog)(_templateObject11 || (_templateObject11 = (0, _taggedTemplateLiteral2["default"])(["\n  top: 0;\n  left: 0;\n  transition: ", ";\n  padding-left: 40px;\n  padding-right: 40px;\n\n  ", ";\n\n  ", ";\n\n  :focus {\n    outline: 0;\n  }\n"])), function (props) {
  return props.theme.transition;
}, _styles.media.portable(_templateObject12 || (_templateObject12 = (0, _taggedTemplateLiteral2["default"])(["\n    padding-left: 24px;\n    padding-right: 24px;\n  "]))), _styles.media.palm(_templateObject13 || (_templateObject13 = (0, _taggedTemplateLiteral2["default"])(["\n    padding-left: 0;\n    padding-right: 0;\n  "]))));
var _default = StyledModal;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9jb21tb24vbW9kYWwudHN4Il0sIm5hbWVzIjpbIk1vZGFsQ29udGVudFdyYXBwZXIiLCJzdHlsZWQiLCJkaXYiLCJwcm9wcyIsInRoZW1lIiwidHJhbnNpdGlvbiIsImxhYmVsQ29sb3JMVCIsIm1lZGlhIiwicG9ydGFibGUiLCJwYWxtIiwiY3NzU3R5bGUiLCJNb2RhbENvbnRlbnQiLCJtb2RhbENvbnRlbnRaIiwiTW9kYWxUaXRsZSIsIm1vZGFsVGl0bGVGb250U2l6ZSIsIm1vZGFsVGl0bGVDb2xvciIsIm1vZGFsVGl0bGVaIiwiU3R5bGVkTW9kYWxGb290ZXIiLCJtb2RhbEZvb3RlcloiLCJDbG9zZUJ1dHRvbiIsInRpdGxlQ29sb3JMVCIsIm1vZGFsQnV0dG9uWiIsIkZvb3RlckFjdGlvbldyYXBwZXIiLCJkZWZhdWx0Q2FuY2VsQnV0dG9uIiwibGluayIsImxhcmdlIiwiY2hpbGRyZW4iLCJkZWZhdWx0Q29uZmlybUJ1dHRvbiIsImN0YSIsIndpZHRoIiwicHJvY2Vzc0Rpc2FibGVkUHJvcGVydHkiLCJkaXNhYmxlZCIsIm5ld1Byb3BzIiwiTW9kYWxGb290ZXIiLCJjYW5jZWwiLCJjb25maXJtIiwiY2FuY2VsQnV0dG9uIiwiY29uZmlybUJ1dHRvbiIsImNhbmNlbEJ1dHRvblByb3BzIiwiY29uZmlybUJ1dHRvblByb3BzIiwiTW9kYWxEaWFsb2ciLCJjbGFzc05hbWUiLCJvdmVybGF5IiwiYmFja2dyb3VuZENvbG9yIiwibW9kYWxPdmVybGF5QmdkIiwiekluZGV4IiwibW9kYWxPdmVyTGF5WiIsInN0eWxlIiwiY2xvc2UiLCJvbkNhbmNlbCIsInRpdGxlIiwiZm9vdGVyIiwib25Db25maXJtIiwiQ29tcG9uZW50IiwiU3R5bGVkTW9kYWwiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBR0E7O0FBQ0E7O0FBRUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7Ozs7Ozs7Ozs7OztBQU1BLElBQU1B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QUFHLGtDQUFPZCxXQUFQLENBQUgsa1BBR0QsVUFBQXJDLEtBQUs7QUFBQSxTQUFJQSxLQUFLLENBQUNDLEtBQU4sQ0FBWUMsVUFBaEI7QUFBQSxDQUhKLEVBT2JFLGNBQU1DLFFBUE8sbUpBWWJELGNBQU1FLElBWk8sNElBQWpCO2VBc0JlNkMsVyIsInNvdXJjZXNDb250ZW50IjpbIi8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBNSVRcbi8vIENvcHlyaWdodCBjb250cmlidXRvcnMgdG8gdGhlIGtlcGxlci5nbCBwcm9qZWN0XG5cbmltcG9ydCBSZWFjdCwge0NvbXBvbmVudCwgUmVhY3ROb2RlLCBQcm9wc1dpdGhDaGlsZHJlbn0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHtGb3JtYXR0ZWRNZXNzYWdlfSBmcm9tICdAa2VwbGVyLmdsL2xvY2FsaXphdGlvbic7XG5cbmltcG9ydCBzdHlsZWQsIHtGbGF0dGVuU2ltcGxlSW50ZXJwb2xhdGlvbn0gZnJvbSAnc3R5bGVkLWNvbXBvbmVudHMnO1xuaW1wb3J0IE1vZGFsIGZyb20gJ3JlYWN0LW1vZGFsJztcbmltcG9ydCB7RGVsZXRlfSBmcm9tICcuL2ljb25zJztcbmltcG9ydCB7QnV0dG9ufSBmcm9tICcuL3N0eWxlZC1jb21wb25lbnRzJztcbmltcG9ydCB7bWVkaWF9IGZyb20gJ0BrZXBsZXIuZ2wvc3R5bGVzJztcblxuaW50ZXJmYWNlIE1vZGFsQ29udGVudFdyYXBwZXJQcm9wcyB7XG4gIGNzc1N0eWxlPzogRmxhdHRlblNpbXBsZUludGVycG9sYXRpb24gfCBzdHJpbmc7XG59XG5cbmNvbnN0IE1vZGFsQ29udGVudFdyYXBwZXIgPSBzdHlsZWQuZGl2PE1vZGFsQ29udGVudFdyYXBwZXJQcm9wcz5gXG4gIG92ZXJmbG93LXk6IGF1dG87XG4gIG1heC13aWR0aDogNzB2dztcbiAgbWF4LWhlaWdodDogODV2aDtcbiAgcGFkZGluZzogMjRweCA3MnB4IDQwcHg7XG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgdG9wOiA5MnB4O1xuICBsZWZ0OiAwO1xuICByaWdodDogMDtcbiAgbWFyZ2luOiAwIGF1dG87XG4gIGJhY2tncm91bmQtY29sb3I6ICNmZmZmZmY7XG4gIGJvcmRlci1yYWRpdXM6IDRweDtcbiAgdHJhbnNpdGlvbjogJHtwcm9wcyA9PiBwcm9wcy50aGVtZS50cmFuc2l0aW9ufTtcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgZm9udC1zaXplOiAxMnB4O1xuICBjb2xvcjogJHtwcm9wcyA9PiBwcm9wcy50aGVtZS5sYWJlbENvbG9yTFR9O1xuXG4gICR7bWVkaWEucG9ydGFibGVgXG4gICAgcGFkZGluZzogMTJweCAzNnB4IDI0cHg7XG4gICAgbWF4LXdpZHRoOiA4MHZ3O1xuICBgfVxuXG4gICR7bWVkaWEucGFsbWBcbiAgICBtYXgtd2lkdGg6IDEwMHZ3O1xuICBgfVxuXG4gICR7cHJvcHMgPT4gcHJvcHMuY3NzU3R5bGUgfHwgJyd9O1xuYDtcblxuY29uc3QgTW9kYWxDb250ZW50ID0gc3R5bGVkLmRpdmBcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xuICB6LWluZGV4OiAke3Byb3BzID0+IHByb3BzLnRoZW1lLm1vZGFsQ29udGVudFp9O1xuYDtcblxudHlwZSBNb2RhbFRpdGxlUHJvcHMgPSBQcm9wc1dpdGhDaGlsZHJlbjx7XG4gIHN0eWxlPzogUmVhY3QuQ1NTUHJvcGVydGllcztcbiAgY2xhc3NOYW1lPzogc3RyaW5nO1xufT47XG5cbmV4cG9ydCBjb25zdCBNb2RhbFRpdGxlID0gc3R5bGVkLmRpdjxNb2RhbFRpdGxlUHJvcHM+YFxuICBmb250LXNpemU6ICR7cHJvcHMgPT4gcHJvcHMudGhlbWUubW9kYWxUaXRsZUZvbnRTaXplfTtcbiAgY29sb3I6ICR7cHJvcHMgPT4gcHJvcHMudGhlbWUubW9kYWxUaXRsZUNvbG9yfTtcbiAgbWFyZ2luLWJvdHRvbTogMTBweDtcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xuICB6LWluZGV4OiAke3Byb3BzID0+IHByb3BzLnRoZW1lLm1vZGFsVGl0bGVafTtcbmA7XG5cbmNvbnN0IFN0eWxlZE1vZGFsRm9vdGVyID0gc3R5bGVkLmRpdmBcbiAgd2lkdGg6IDEwMCU7XG4gIGxlZnQ6IDA7XG4gIGJvdHRvbTogMDtcbiAgZGlzcGxheTogZmxleDtcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAganVzdGlmeS1jb250ZW50OiBmbGV4LWVuZDtcbiAgcGFkZGluZy10b3A6IDI0cHg7XG4gICR7bWVkaWEucG9ydGFibGVgXG4gICAgcGFkZGluZy10b3A6IDI0cHg7XG4gIGB9O1xuXG4gICR7bWVkaWEucGFsbWBcbiAgICBwYWRkaW5nLXRvcDogMTZweDtcbiAgYH07XG4gIHotaW5kZXg6ICR7cHJvcHMgPT4gcHJvcHMudGhlbWUubW9kYWxGb290ZXJafTtcbmA7XG5cbmNvbnN0IENsb3NlQnV0dG9uID0gc3R5bGVkLmRpdmBcbiAgY29sb3I6ICR7cHJvcHMgPT4gcHJvcHMudGhlbWUudGl0bGVDb2xvckxUfTtcbiAgZGlzcGxheTogZmxleDtcbiAganVzdGlmeS1jb250ZW50OiBmbGV4LWVuZDtcbiAgei1pbmRleDogJHtwcm9wcyA9PiBwcm9wcy50aGVtZS5tb2RhbEJ1dHRvblp9O1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIHRvcDogMjRweDtcbiAgcmlnaHQ6IDI0cHg7XG5cbiAgOmhvdmVyIHtcbiAgICBjdXJzb3I6IHBvaW50ZXI7XG4gIH1cbmA7XG5cbmNvbnN0IEZvb3RlckFjdGlvbldyYXBwZXIgPSBzdHlsZWQuZGl2YFxuICBkaXNwbGF5OiBmbGV4O1xuICBqdXN0aWZ5LWNvbnRlbnQ6IGZsZXgtZW5kO1xuYDtcblxuY29uc3QgZGVmYXVsdENhbmNlbEJ1dHRvbiA9IHtcbiAgbGluazogdHJ1ZSxcbiAgbGFyZ2U6IHRydWUsXG4gIGNoaWxkcmVuOiAnbW9kYWwuYnV0dG9uLmRlZmF1bHRDYW5jZWwnXG59O1xuXG5jb25zdCBkZWZhdWx0Q29uZmlybUJ1dHRvbiA9IHtcbiAgY3RhOiB0cnVlLFxuICBsYXJnZTogdHJ1ZSxcbiAgd2lkdGg6ICcxNjBweCcsXG4gIGNoaWxkcmVuOiAnbW9kYWwuYnV0dG9uLmRlZmF1bHRDb25maXJtJ1xufTtcblxudHlwZSBNb2RhbEJ1dHRvblByb3BzID0ge1xuICBzdHlsZT86IFJlYWN0LkNTU1Byb3BlcnRpZXM7XG4gIGxhcmdlPzogYm9vbGVhbjtcbiAgZGlzYWJsZWQ/OiBib29sZWFuO1xuICBuZWdhdGl2ZT86IGJvb2xlYW47XG4gIGNoaWxkcmVuPzogc3RyaW5nO1xufTtcblxudHlwZSBNb2RhbEZvb3RlclByb3BzID0ge1xuICBjYW5jZWw6ICgpID0+IHZvaWQ7XG4gIGNvbmZpcm06IChkYXRhPzogYW55KSA9PiB2b2lkO1xuICBjYW5jZWxCdXR0b24/OiBNb2RhbEJ1dHRvblByb3BzO1xuICBjb25maXJtQnV0dG9uPzogTW9kYWxCdXR0b25Qcm9wcztcbn07XG5cbi8qKlxuICogdGhpcyBtZXRob2QgcmVtb3ZlcyB0aGUgYGRpc2FibGVkYCBwcm9wZXJ0eSBmcm9tIGJ1dHRvbiBwcm9wcyB3aGVuIGRpc2FibGVkIGlzIHNldCB0byBmYWxzZVxuICogdG8gYXZvaWQgaXNzdWUgd2l0aCB0aGUgZGlzYWJsZWQgdGFnXG4gKlxuICogQHBhcmFtIHByb3BzXG4gKi9cbmNvbnN0IHByb2Nlc3NEaXNhYmxlZFByb3BlcnR5ID0gKHByb3BzOiBNb2RhbEJ1dHRvblByb3BzKTogTW9kYWxCdXR0b25Qcm9wcyA9PiB7XG4gIGlmICghcHJvcHMuZGlzYWJsZWQpIHtcbiAgICBjb25zdCB7ZGlzYWJsZWQsIC4uLm5ld1Byb3BzfSA9IHByb3BzO1xuICAgIHJldHVybiBuZXdQcm9wcztcbiAgfVxuICByZXR1cm4gcHJvcHM7XG59O1xuXG5leHBvcnQgY29uc3QgTW9kYWxGb290ZXI6IFJlYWN0LkZDPE1vZGFsRm9vdGVyUHJvcHM+ID0gKHtcbiAgY2FuY2VsLFxuICBjb25maXJtLFxuICBjYW5jZWxCdXR0b24sXG4gIGNvbmZpcm1CdXR0b25cbn0pID0+IHtcbiAgY29uc3QgY2FuY2VsQnV0dG9uUHJvcHMgPSBwcm9jZXNzRGlzYWJsZWRQcm9wZXJ0eSh7XG4gICAgLi4uZGVmYXVsdENhbmNlbEJ1dHRvbixcbiAgICAuLi5jYW5jZWxCdXR0b25cbiAgfSk7XG4gIGNvbnN0IGNvbmZpcm1CdXR0b25Qcm9wcyA9IHByb2Nlc3NEaXNhYmxlZFByb3BlcnR5KHsuLi5kZWZhdWx0Q29uZmlybUJ1dHRvbiwgLi4uY29uZmlybUJ1dHRvbn0pO1xuICByZXR1cm4gKFxuICAgIDxTdHlsZWRNb2RhbEZvb3RlciBjbGFzc05hbWU9XCJtb2RhbC0tZm9vdGVyXCI+XG4gICAgICA8Rm9vdGVyQWN0aW9uV3JhcHBlcj5cbiAgICAgICAgPEJ1dHRvbiBjbGFzc05hbWU9XCJtb2RhbC0tZm9vdGVyLS1jYW5jZWwtYnV0dG9uXCIgey4uLmNhbmNlbEJ1dHRvblByb3BzfSBvbkNsaWNrPXtjYW5jZWx9PlxuICAgICAgICAgIDxGb3JtYXR0ZWRNZXNzYWdlIGlkPXtjYW5jZWxCdXR0b25Qcm9wcy5jaGlsZHJlbiA/PyAnJ30gLz5cbiAgICAgICAgPC9CdXR0b24+XG4gICAgICAgIDxCdXR0b24gY2xhc3NOYW1lPVwibW9kYWwtLWZvb3Rlci0tY29uZmlybS1idXR0b25cIiB7Li4uY29uZmlybUJ1dHRvblByb3BzfSBvbkNsaWNrPXtjb25maXJtfT5cbiAgICAgICAgICA8Rm9ybWF0dGVkTWVzc2FnZSBpZD17Y29uZmlybUJ1dHRvblByb3BzLmNoaWxkcmVuID8/ICcnfSAvPlxuICAgICAgICA8L0J1dHRvbj5cbiAgICAgIDwvRm9vdGVyQWN0aW9uV3JhcHBlcj5cbiAgICA8L1N0eWxlZE1vZGFsRm9vdGVyPlxuICApO1xufTtcblxuaW50ZXJmYWNlIE1vZGFsRGlhbG9nT3duUHJvcHMge1xuICBmb290ZXI6IGJvb2xlYW47XG4gIGNsb3NlOiBib29sZWFuO1xuICBpc09wZW46IGJvb2xlYW47XG4gIHRpdGxlPzogc3RyaW5nO1xuICBjbGFzc05hbWU/OiBzdHJpbmc7XG4gIG9uQ29uZmlybTogKC4uLmFyZ3M6IGFueSkgPT4gdm9pZDtcbiAgb25DYW5jZWw6ICguLi5hcmdzOiBhbnkpID0+IHZvaWQ7XG4gIGNvbmZpcm1CdXR0b24/OiBNb2RhbEJ1dHRvblByb3BzO1xuICBjb25maXJtQnV0dG9uTGFiZWw/OiBzdHJpbmc7XG4gIGNhbmNlbEJ1dHRvbj86IE1vZGFsQnV0dG9uUHJvcHM7XG4gIGNhbmNlbEJ1dHRvbkxhYmVsPzogc3RyaW5nO1xuICBjc3NTdHlsZT86IEZsYXR0ZW5TaW1wbGVJbnRlcnBvbGF0aW9uIHwgc3RyaW5nO1xuICBzdHlsZT86IFJlYWN0LkNTU1Byb3BlcnRpZXM7XG4gIHRoZW1lOiBhbnk7XG4gIGNoaWxkcmVuPzogUmVhY3ROb2RlO1xufVxuXG5leHBvcnQgdHlwZSBNb2RhbERpYWxvZ1Byb3BzID0gTW9kYWxEaWFsb2dPd25Qcm9wcyAmXG4gIE9taXQ8UmVhY3RNb2RhbC5Qcm9wcywgJ3N0eWxlJyB8ICdhcmlhSGlkZUFwcCcgfCAnY2xhc3NOYW1lJz47XG5cbmV4cG9ydCBjbGFzcyBNb2RhbERpYWxvZyBleHRlbmRzIENvbXBvbmVudDxNb2RhbERpYWxvZ1Byb3BzPiB7XG4gIHN0YXRpYyBkZWZhdWx0UHJvcHMgPSB7XG4gICAgZm9vdGVyOiBmYWxzZSxcbiAgICBjbG9zZTogdHJ1ZSxcbiAgICBvbkNvbmZpcm06ICgpOiB2b2lkID0+IHt9LFxuICAgIG9uQ2FuY2VsOiAoKTogdm9pZCA9PiB7fSxcbiAgICBjYW5jZWxCdXR0b246IGRlZmF1bHRDYW5jZWxCdXR0b24sXG4gICAgY29uZmlybUJ1dHRvbjogZGVmYXVsdENvbmZpcm1CdXR0b24sXG4gICAgY3NzU3R5bGU6IFtdXG4gIH07XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHtwcm9wc30gPSB0aGlzO1xuICAgIHJldHVybiAoXG4gICAgICA8TW9kYWxcbiAgICAgICAgY2xhc3NOYW1lPXt0aGlzLnByb3BzLmNsYXNzTmFtZX1cbiAgICAgICAgey4uLnByb3BzfVxuICAgICAgICBhcmlhSGlkZUFwcD17ZmFsc2V9XG4gICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgb3ZlcmxheToge1xuICAgICAgICAgICAgYmFja2dyb3VuZENvbG9yOiAocHJvcHMudGhlbWUgJiYgcHJvcHMudGhlbWUubW9kYWxPdmVybGF5QmdkKSB8fCAncmdiYSgwLCAwLCAwLCAwLjUpJyxcbiAgICAgICAgICAgIHpJbmRleDogKHByb3BzLnRoZW1lICYmIHByb3BzLnRoZW1lLm1vZGFsT3ZlckxheVopIHx8IDEwMDAsXG4gICAgICAgICAgICAvLyBpbiBjYXNlIHdlIHdhbnQgdG8gb3ZlcnJpZGUgdGhlIG1vZGFsIGRpYWxvZyBzdHlsZVxuICAgICAgICAgICAgLi4ucHJvcHMuc3R5bGVcbiAgICAgICAgICB9XG4gICAgICAgIH19XG4gICAgICA+XG4gICAgICAgIDxNb2RhbENvbnRlbnRXcmFwcGVyIGNsYXNzTmFtZT1cIm1vZGFsLS13cmFwcGVyXCIgY3NzU3R5bGU9e3Byb3BzLmNzc1N0eWxlfT5cbiAgICAgICAgICB7cHJvcHMuY2xvc2UgJiYgKFxuICAgICAgICAgICAgPENsb3NlQnV0dG9uIGNsYXNzTmFtZT1cIm1vZGFsLS1jbG9zZVwiIG9uQ2xpY2s9e3Byb3BzLm9uQ2FuY2VsfT5cbiAgICAgICAgICAgICAgPERlbGV0ZSBoZWlnaHQ9XCIxNHB4XCIgLz5cbiAgICAgICAgICAgIDwvQ2xvc2VCdXR0b24+XG4gICAgICAgICAgKX1cbiAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAge3Byb3BzLnRpdGxlICYmIChcbiAgICAgICAgICAgICAgPE1vZGFsVGl0bGUgY2xhc3NOYW1lPVwibW9kYWwtLXRpdGxlXCI+XG4gICAgICAgICAgICAgICAgPEZvcm1hdHRlZE1lc3NhZ2UgaWQ9e3Byb3BzLnRpdGxlfSAvPlxuICAgICAgICAgICAgICA8L01vZGFsVGl0bGU+XG4gICAgICAgICAgICApfVxuICAgICAgICAgICAgPE1vZGFsQ29udGVudCBjbGFzc05hbWU9XCJtb2RhbC0tYm9keVwiPntwcm9wcy5jaGlsZHJlbn08L01vZGFsQ29udGVudD5cbiAgICAgICAgICAgIHtwcm9wcy5mb290ZXIgJiYgKFxuICAgICAgICAgICAgICA8TW9kYWxGb290ZXJcbiAgICAgICAgICAgICAgICBjYW5jZWw9e3Byb3BzLm9uQ2FuY2VsfVxuICAgICAgICAgICAgICAgIGNvbmZpcm09e3Byb3BzLm9uQ29uZmlybX1cbiAgICAgICAgICAgICAgICBjYW5jZWxCdXR0b249e3Byb3BzLmNhbmNlbEJ1dHRvbn1cbiAgICAgICAgICAgICAgICBjb25maXJtQnV0dG9uPXtwcm9wcy5jb25maXJtQnV0dG9ufVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgKX1cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9Nb2RhbENvbnRlbnRXcmFwcGVyPlxuICAgICAgPC9Nb2RhbD5cbiAgICApO1xuICB9XG59XG5cbmNvbnN0IFN0eWxlZE1vZGFsID0gc3R5bGVkKE1vZGFsRGlhbG9nKWBcbiAgdG9wOiAwO1xuICBsZWZ0OiAwO1xuICB0cmFuc2l0aW9uOiAke3Byb3BzID0+IHByb3BzLnRoZW1lLnRyYW5zaXRpb259O1xuICBwYWRkaW5nLWxlZnQ6IDQwcHg7XG4gIHBhZGRpbmctcmlnaHQ6IDQwcHg7XG5cbiAgJHttZWRpYS5wb3J0YWJsZWBcbiAgICBwYWRkaW5nLWxlZnQ6IDI0cHg7XG4gICAgcGFkZGluZy1yaWdodDogMjRweDtcbiAgYH07XG5cbiAgJHttZWRpYS5wYWxtYFxuICAgIHBhZGRpbmctbGVmdDogMDtcbiAgICBwYWRkaW5nLXJpZ2h0OiAwO1xuICBgfTtcblxuICA6Zm9jdXMge1xuICAgIG91dGxpbmU6IDA7XG4gIH1cbmA7XG5cbmV4cG9ydCBkZWZhdWx0IFN0eWxlZE1vZGFsO1xuIl19
"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = exports.InputBoxContainer = exports.ColorSelectorInput = exports.ColorBlock = void 0;

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _typeof2 = _interopRequireDefault(require("@babel/runtime/helpers/typeof"));

var _toConsumableArray2 = _interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _assertThisInitialized2 = _interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _taggedTemplateLiteral2 = _interopRequireDefault(require("@babel/runtime/helpers/taggedTemplateLiteral"));

var _react = _interopRequireWildcard(require("react"));

var _styledComponents = _interopRequireDefault(require("styled-components"));

var _reactIntl = require("react-intl");

var _utils = require("@kepler.gl/utils");

var _singleColorPalette = _interopRequireDefault(require("./single-color-palette"));

var _colorRangeSelector = _interopRequireDefault(require("./color-range-selector"));

var _colorPalette = _interopRequireDefault(require("./color-palette"));

var _styledComponents2 = require("../../common/styled-components");

var _reactOnclickoutside = _interopRequireDefault(require("react-onclickoutside"));

var _rangeSlider = _interopRequireDefault(require("../../common/range-slider"));

var _templateObject, _templateObject2, _templateObject3, _templateObject4;

function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = (0, _getPrototypeOf2["default"])(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2["default"])(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2["default"])(this, result); }; }

function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }

var OpacitySliderWrapper = _styledComponents["default"].div(_templateObject || (_templateObject = (0, _taggedTemplateLiteral2["default"])(["\n  padding: 0px 12px 12px 12px;\n"])));

var OPACITY_SLIDER_PROPS = {
  type: 'number',
  range: [0, 1],
  value0: 0,
  step: 0.01,
  isRanged: false,
  label: 'Opacity',
  showInput: true
};

var ColorBlock = _styledComponents["default"].div(_templateObject2 || (_templateObject2 = (0, _taggedTemplateLiteral2["default"])(["\n  width: 32px;\n  height: 18px;\n  border-radius: 1px;\n  background-color: ", ";\n"])), function (props) {
  return Array.isArray(props.backgroundcolor) ? "rgb(".concat(props.backgroundcolor.slice(0, 3).join(','), ")") : 'transparent';
});

exports.ColorBlock = ColorBlock;

var ColorSelectorInput = _styledComponents["default"].div(_templateObject3 || (_templateObject3 = (0, _taggedTemplateLiteral2["default"])(["\n  ", ";\n  height: ", ";\n\n  .color-selector__selector__label {\n    text-transform: capitalize;\n    font-size: 12px;\n    text-align: center;\n    color: ", ";\n  }\n"])), function (props) {
  return props.inputTheme === 'secondary' ? props.theme.secondaryInput : props.theme.input;
}, function (props) {
  return props.theme.inputBoxHeight;
}, function (props) {
  return props.theme.inputPlaceholderColor;
});

exports.ColorSelectorInput = ColorSelectorInput;

var InputBoxContainer = _styledComponents["default"].div(_templateObject4 || (_templateObject4 = (0, _taggedTemplateLiteral2["default"])(["\n  display: flex;\n  justify-content: space-between;\n\n  .color-select__input-group {\n    flex-grow: 1;\n  }\n  .color-select__input-group:nth-child(2) {\n    margin-left: 12px;\n  }\n"])));

exports.InputBoxContainer = InputBoxContainer;
ColorSelectorFactory.deps = [_rangeSlider["default"]];

function ColorSelectorFactory(RangeSlider) {
  var ColorSelector = /*#__PURE__*/function (_Component) {
    (0, _inherits2["default"])(ColorSelector, _Component);

    var _super = _createSuper(ColorSelector);

    function ColorSelector() {
      var _this;

      (0, _classCallCheck2["default"])(this, ColorSelector);

      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }

      _this = _super.call.apply(_super, [this].concat(args));
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "state", {
        showDropdown: false
      });
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "node", /*#__PURE__*/(0, _react.createRef)());
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "handleClickOutside", function (e) {
        if (_this.props.colorUI && Number.isInteger(_this.props.colorUI.showSketcher)) {
          // if sketcher is open, let sketch to close itself first
          return;
        }

        _this._closePanelDropdown();
      });
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "_getEditing", function () {
        return _this.props.colorUI ? _this.props.colorUI.showDropdown : _this.state.showDropdown;
      });
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "_closePanelDropdown", function () {
        if (_this._getEditing() === false) {
          return;
        }

        if (_this.props.setColorUI) {
          _this.props.setColorUI({
            showDropdown: false,
            showSketcher: false
          });
        } else {
          _this.setState({
            showDropdown: false
          });
        }
      });
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "_onSelectColor", function (color, e) {
        e.stopPropagation();

        var editing = _this._getEditing();

        var colorSet = typeof editing === 'number' && _this.props.colorSets[editing];

        if (colorSet) {
          _this._setColor(colorSet, color, colorSet.selectedColor[3]);
        }
      });
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "_onSelectOpacity", function (opacity, e) {
        if (e) e.stopPropagation();

        var editing = _this._getEditing();

        var colorSet = typeof editing === 'number' && _this.props.colorSets[editing];

        if (colorSet) {
          _this._setColor(colorSet, colorSet.selectedColor, Math.round(opacity[1] * 255));
        }
      });
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "_setColor", function (colorSet, color, opacity) {
        if (_this.props.useOpacity && Array.isArray(color)) {
          colorSet.setColor([].concat((0, _toConsumableArray2["default"])(color.slice(0, 3)), [opacity]));
        } else {
          colorSet.setColor(color);
        }
      });
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "_showDropdown", function (e, i) {
        e.stopPropagation();
        e.preventDefault();

        if (_this.props.setColorUI) {
          _this.props.setColorUI({
            showDropdown: i
          });
        } else {
          _this.setState({
            showDropdown: i
          });
        }
      });
      return _this;
    }

    (0, _createClass2["default"])(ColorSelector, [{
      key: "render",
      value: function render() {
        var _this2 = this;

        var _this$props = this.props,
            colorSets = _this$props.colorSets,
            useOpacity = _this$props.useOpacity,
            disabled = _this$props.disabled,
            inputTheme = _this$props.inputTheme,
            colorUI = _this$props.colorUI;

        var editing = this._getEditing();

        var currentEditing = typeof editing === 'number' && colorSets[editing] && (0, _typeof2["default"])(colorSets[editing]) === 'object';
        return /*#__PURE__*/_react["default"].createElement("div", {
          className: "color-selector",
          ref: this.node
        }, /*#__PURE__*/_react["default"].createElement(InputBoxContainer, null, colorSets.map(function (cSet, i) {
          return /*#__PURE__*/_react["default"].createElement("div", {
            className: "color-select__input-group",
            key: i
          }, /*#__PURE__*/_react["default"].createElement(ColorSelectorInput, {
            className: "color-selector__selector",
            active: editing === i,
            disabled: disabled,
            inputTheme: inputTheme,
            onMouseDown: function onMouseDown(e) {
              return _this2._showDropdown(e, i);
            }
          }, cSet.isRange ? /*#__PURE__*/_react["default"].createElement(_colorPalette["default"], {
            colors: cSet.selectedColor.colors
          }) : /*#__PURE__*/_react["default"].createElement(ColorBlock, {
            className: "color-selector__selector__block",
            backgroundcolor: cSet.selectedColor
          }), cSet.label ? /*#__PURE__*/_react["default"].createElement("div", {
            className: "color-selector__selector__label"
          }, cSet.label) : null));
        })), currentEditing ? /*#__PURE__*/_react["default"].createElement(_styledComponents2.StyledPanelDropdown, {
          className: "color-selector__dropdown"
        }, colorSets[editing].isRange ? /*#__PURE__*/_react["default"].createElement(_colorRangeSelector["default"], {
          selectedColorRange: colorSets[editing].selectedColor,
          onSelectColorRange: this._onSelectColor,
          setColorPaletteUI: this.props.setColorUI,
          colorPaletteUI: colorUI
        }) : /*#__PURE__*/_react["default"].createElement(_singleColorPalette["default"], {
          selectedColor: (0, _utils.rgbToHex)(colorSets[editing].selectedColor),
          onSelectColor: this._onSelectColor
        }), useOpacity ? /*#__PURE__*/_react["default"].createElement(OpacitySliderWrapper, null, /*#__PURE__*/_react["default"].createElement(_styledComponents2.PanelLabel, null, /*#__PURE__*/_react["default"].createElement(_reactIntl.FormattedMessage, {
          id: "color.opacity"
        })), /*#__PURE__*/_react["default"].createElement(RangeSlider, (0, _extends2["default"])({}, OPACITY_SLIDER_PROPS, {
          value1: colorSets[editing].selectedColor[3] / 255,
          onChange: this._onSelectOpacity
        }))) : null) : null);
      }
    }]);
    return ColorSelector;
  }(_react.Component);

  (0, _defineProperty2["default"])(ColorSelector, "defaultProps", {
    colorSets: []
  });
  return (0, _reactOnclickoutside["default"])(ColorSelector);
}

var _default = ColorSelectorFactory;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9zaWRlLXBhbmVsL2xheWVyLXBhbmVsL2NvbG9yLXNlbGVjdG9yLnRzeCJdLCJuYW1lcyI6WyJPcGFjaXR5U2xpZGVyV3JhcHBlciIsInN0eWxlZCIsImRpdiIsIk9QQUNJVFlfU0xJREVSX1BST1BTIiwidHlwZSIsInJhbmdlIiwidmFsdWUwIiwic3RlcCIsImlzUmFuZ2VkIiwibGFiZWwiLCJzaG93SW5wdXQiLCJDb2xvckJsb2NrIiwicHJvcHMiLCJBcnJheSIsImlzQXJyYXkiLCJiYWNrZ3JvdW5kY29sb3IiLCJzbGljZSIsImpvaW4iLCJDb2xvclNlbGVjdG9ySW5wdXQiLCJpbnB1dFRoZW1lIiwidGhlbWUiLCJzZWNvbmRhcnlJbnB1dCIsImlucHV0IiwiaW5wdXRCb3hIZWlnaHQiLCJpbnB1dFBsYWNlaG9sZGVyQ29sb3IiLCJJbnB1dEJveENvbnRhaW5lciIsIkNvbG9yU2VsZWN0b3JGYWN0b3J5IiwiZGVwcyIsIlJhbmdlU2xpZGVyRmFjdG9yeSIsIlJhbmdlU2xpZGVyIiwiQ29sb3JTZWxlY3RvciIsInNob3dEcm9wZG93biIsImUiLCJjb2xvclVJIiwiTnVtYmVyIiwiaXNJbnRlZ2VyIiwic2hvd1NrZXRjaGVyIiwiX2Nsb3NlUGFuZWxEcm9wZG93biIsInN0YXRlIiwiX2dldEVkaXRpbmciLCJzZXRDb2xvclVJIiwic2V0U3RhdGUiLCJjb2xvciIsInN0b3BQcm9wYWdhdGlvbiIsImVkaXRpbmciLCJjb2xvclNldCIsImNvbG9yU2V0cyIsIl9zZXRDb2xvciIsInNlbGVjdGVkQ29sb3IiLCJvcGFjaXR5IiwiTWF0aCIsInJvdW5kIiwidXNlT3BhY2l0eSIsInNldENvbG9yIiwiaSIsInByZXZlbnREZWZhdWx0IiwiZGlzYWJsZWQiLCJjdXJyZW50RWRpdGluZyIsIm5vZGUiLCJtYXAiLCJjU2V0IiwiX3Nob3dEcm9wZG93biIsImlzUmFuZ2UiLCJjb2xvcnMiLCJfb25TZWxlY3RDb2xvciIsIl9vblNlbGVjdE9wYWNp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QUFBLGlCQUFpQixFQUFFLEtBQUtwRCxLQUFMLENBQVc0QixVQUhoQztBQUlFLFVBQUEsY0FBYyxFQUFFUDtBQUpsQixVQURELGdCQVFDLGdDQUFDLDhCQUFEO0FBQ0UsVUFBQSxhQUFhLEVBQUUscUJBQVNhLFNBQVMsQ0FBQ0YsT0FBRCxDQUFULENBQTZCSSxhQUF0QyxDQURqQjtBQUVFLFVBQUEsYUFBYSxFQUFFLEtBQUtnQjtBQUZ0QixVQVRKLEVBY0daLFVBQVUsZ0JBQ1QsZ0NBQUMsb0JBQUQscUJBQ0UsZ0NBQUMsNkJBQUQscUJBQ0UsZ0NBQUMsMkJBQUQ7QUFBa0IsVUFBQSxFQUFFLEVBQUM7QUFBckIsVUFERixDQURGLGVBSUUsZ0NBQUMsV0FBRCxnQ0FDTWpELG9CQUROO0FBRUUsVUFBQSxNQUFNLEVBQUUyQyxTQUFTLENBQUNGLE9BQUQsQ0FBVCxDQUE2QkksYUFBN0IsQ0FBMkMsQ0FBM0MsSUFBZ0QsR0FGMUQ7QUFHRSxVQUFBLFFBQVEsRUFBRSxLQUFLaUI7QUFIakIsV0FKRixDQURTLEdBV1AsSUF6Qk4sQ0FEYSxHQTRCWCxJQXRETixDQURGO0FBMEREO0FBM0l5RTtBQUFBO0FBQUEsSUFDaERDLGdCQURnRDs7QUFBQSxtQ0FDdEVwQyxhQURzRSxrQkFFcEQ7QUFDcEJnQixJQUFBQSxTQUFTLEVBQUU7QUFEUyxHQUZvRDtBQTZJNUUsU0FBTyxxQ0FBZWhCLGFBQWYsQ0FBUDtBQUNEOztlQUVjSixvQiIsInNvdXJjZXNDb250ZW50IjpbIi8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBNSVRcbi8vIENvcHlyaWdodCBjb250cmlidXRvcnMgdG8gdGhlIGtlcGxlci5nbCBwcm9qZWN0XG5cbmltcG9ydCBSZWFjdCwge0NvbXBvbmVudCwgY3JlYXRlUmVmLCBNb3VzZUV2ZW50LCBDb21wb25lbnRUeXBlfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgc3R5bGVkIGZyb20gJ3N0eWxlZC1jb21wb25lbnRzJztcbmltcG9ydCB7Rm9ybWF0dGVkTWVzc2FnZX0gZnJvbSAncmVhY3QtaW50bCc7XG5pbXBvcnQge3JnYlRvSGV4fSBmcm9tICdAa2VwbGVyLmdsL3V0aWxzJztcbmltcG9ydCBTaW5nbGVDb2xvclBhbGV0dGUgZnJvbSAnLi9zaW5nbGUtY29sb3ItcGFsZXR0ZSc7XG5pbXBvcnQgQ29sb3JSYW5nZVNlbGVjdG9yIGZyb20gJy4vY29sb3ItcmFuZ2Utc2VsZWN0b3InO1xuaW1wb3J0IENvbG9yUGFsZXR0ZSBmcm9tICcuL2NvbG9yLXBhbGV0dGUnO1xuaW1wb3J0IHtTdHlsZWRQYW5lbERyb3Bkb3duLCBQYW5lbExhYmVsfSBmcm9tICcuLi8uLi9jb21tb24vc3R5bGVkLWNvbXBvbmVudHMnO1xuaW1wb3J0IG9uQ2xpY2tPdXRzaWRlIGZyb20gJ3JlYWN0LW9uY2xpY2tvdXRzaWRlJztcbmltcG9ydCB7Q29sb3JSYW5nZX0gZnJvbSAnQGtlcGxlci5nbC9jb25zdGFudHMnO1xuaW1wb3J0IFJhbmdlU2xpZGVyRmFjdG9yeSBmcm9tICcuLi8uLi9jb21tb24vcmFuZ2Utc2xpZGVyJztcbmltcG9ydCB7TmVzdGVkUGFydGlhbCwgUkdCQ29sb3IsIFJHQkFDb2xvciwgQ29sb3JVSX0gZnJvbSAnQGtlcGxlci5nbC90eXBlcyc7XG5cbnR5cGUgQ29sb3JTZWxlY3RvcklucHV0UHJvcHMgPSB7XG4gIGFjdGl2ZTogYm9vbGVhbjtcbiAgZGlzYWJsZWQ/OiBib29sZWFuO1xuICBpbnB1dFRoZW1lPzogc3RyaW5nO1xufTtcblxuZXhwb3J0IHR5cGUgQ29sb3JTZXQgPSB7XG4gIHNlbGVjdGVkQ29sb3I6IFJHQkNvbG9yIHwgUkdCQUNvbG9yIHwgQ29sb3JSYW5nZTtcbiAgc2V0Q29sb3I6ICh2OiBSR0JDb2xvciB8IFJHQkFDb2xvciB8IENvbG9yUmFuZ2UpID0+IHZvaWQ7XG4gIGlzUmFuZ2U/OiBib29sZWFuO1xuICBsYWJlbD86IHN0cmluZztcbn07XG5cbnR5cGUgQ29sb3JTZWxlY3RvclByb3BzID0ge1xuICBjb2xvclNldHM6IENvbG9yU2V0W107XG4gIGNvbG9yVUk/OiBDb2xvclVJO1xuICBpbnB1dFRoZW1lPzogc3RyaW5nO1xuICBkaXNhYmxlZD86IGJvb2xlYW47XG4gIHVzZU9wYWNpdHk/OiBib29sZWFuO1xuICBzZXRDb2xvclVJPzogKG5ld0NvbmZpZzogTmVzdGVkUGFydGlhbDxDb2xvclVJPikgPT4gdm9pZDtcbn07XG5cbmNvbnN0IE9wYWNpdHlTbGlkZXJXcmFwcGVyID0gc3R5bGVkLmRpdmBcbiAgcGFkZGluZzogMHB4IDEycHggMTJweCAxMnB4O1xuYDtcblxuY29uc3QgT1BBQ0lUWV9TTElERVJfUFJPUFMgPSB7XG4gIHR5cGU6ICdudW1iZXInLFxuICByYW5nZTogWzAsIDFdLFxuICB2YWx1ZTA6IDAsXG4gIHN0ZXA6IDAuMDEsXG4gIGlzUmFuZ2VkOiBmYWxzZSxcbiAgbGFiZWw6ICdPcGFjaXR5JyxcbiAgc2hvd0lucHV0OiB0cnVlXG59O1xuXG5leHBvcnQgY29uc3QgQ29sb3JCbG9jayA9IHN0eWxlZC5kaXY8e2JhY2tncm91bmRjb2xvcjogUkdCQ29sb3J9PmBcbiAgd2lkdGg6IDMycHg7XG4gIGhlaWdodDogMThweDtcbiAgYm9yZGVyLXJhZGl1czogMXB4O1xuICBiYWNrZ3JvdW5kLWNvbG9yOiAke3Byb3BzID0+XG4gICAgQXJyYXkuaXNBcnJheShwcm9wcy5iYWNrZ3JvdW5kY29sb3IpXG4gICAgICA/IGByZ2IoJHtwcm9wcy5iYWNrZ3JvdW5kY29sb3Iuc2xpY2UoMCwgMykuam9pbignLCcpfSlgXG4gICAgICA6ICd0cmFuc3BhcmVudCd9O1xuYDtcblxuZXhwb3J0IGNvbnN0IENvbG9yU2VsZWN0b3JJbnB1dCA9IHN0eWxlZC5kaXY8Q29sb3JTZWxlY3RvcklucHV0UHJvcHM+YFxuICAke3Byb3BzID0+IChwcm9wcy5pbnB1dFRoZW1lID09PSAnc2Vjb25kYXJ5JyA/IHByb3BzLnRoZW1lLnNlY29uZGFyeUlucHV0IDogcHJvcHMudGhlbWUuaW5wdXQpfTtcbiAgaGVpZ2h0OiAke3Byb3BzID0+IHByb3BzLnRoZW1lLmlucHV0Qm94SGVpZ2h0fTtcblxuICAuY29sb3Itc2VsZWN0b3JfX3NlbGVjdG9yX19sYWJlbCB7XG4gICAgdGV4dC10cmFuc2Zvcm06IGNhcGl0YWxpemU7XG4gICAgZm9udC1zaXplOiAxMnB4O1xuICAgIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgICBjb2xvcjogJHtwcm9wcyA9PiBwcm9wcy50aGVtZS5pbnB1dFBsYWNlaG9sZGVyQ29sb3J9O1xuICB9XG5gO1xuXG5leHBvcnQgY29uc3QgSW5wdXRCb3hDb250YWluZXIgPSBzdHlsZWQuZGl2YFxuICBkaXNwbGF5OiBmbGV4O1xuICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XG5cbiAgLmNvbG9yLXNlbGVjdF9faW5wdXQtZ3JvdXAge1xuICAgIGZsZXgtZ3JvdzogMTtcbiAgfVxuICAuY29sb3Itc2VsZWN0X19pbnB1dC1ncm91cDpudGgtY2hpbGQoMikge1xuICAgIG1hcmdpbi1sZWZ0OiAxMnB4O1xuICB9XG5gO1xuXG5Db2xvclNlbGVjdG9yRmFjdG9yeS5kZXBzID0gW1JhbmdlU2xpZGVyRmFjdG9yeV07XG5cbmZ1bmN0aW9uIENvbG9yU2VsZWN0b3JGYWN0b3J5KFJhbmdlU2xpZGVyKTogQ29tcG9uZW50VHlwZTxDb2xvclNlbGVjdG9yUHJvcHM+IHtcbiAgY2xhc3MgQ29sb3JTZWxlY3RvciBleHRlbmRzIENvbXBvbmVudDxDb2xvclNlbGVjdG9yUHJvcHM+IHtcbiAgICBzdGF0aWMgZGVmYXVsdFByb3BzID0ge1xuICAgICAgY29sb3JTZXRzOiBbXVxuICAgIH07XG5cbiAgICBzdGF0ZSA9IHtcbiAgICAgIHNob3dEcm9wZG93bjogZmFsc2VcbiAgICB9O1xuXG4gICAgbm9kZSA9IGNyZWF0ZVJlZjxIVE1MRGl2RWxlbWVudD4oKTtcblxuICAgIGhhbmRsZUNsaWNrT3V0c2lkZSA9IGUgPT4ge1xuICAgICAgaWYgKHRoaXMucHJvcHMuY29sb3JVSSAmJiBOdW1iZXIuaXNJbnRlZ2VyKHRoaXMucHJvcHMuY29sb3JVSS5zaG93U2tldGNoZXIpKSB7XG4gICAgICAgIC8vIGlmIHNrZXRjaGVyIGlzIG9wZW4sIGxldCBza2V0Y2ggdG8gY2xvc2UgaXRzZWxmIGZpcnN0XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdGhpcy5fY2xvc2VQYW5lbERyb3Bkb3duKCk7XG4gICAgfTtcblxuICAgIF9nZXRFZGl0aW5nID0gKCkgPT4ge1xuICAgICAgcmV0dXJuIHRoaXMucHJvcHMuY29sb3JVSSA/IHRoaXMucHJvcHMuY29sb3JVSS5zaG93RHJvcGRvd24gOiB0aGlzLnN0YXRlLnNob3dEcm9wZG93bjtcbiAgICB9O1xuXG4gICAgX2Nsb3NlUGFuZWxEcm9wZG93biA9ICgpID0+IHtcbiAgICAgIGlmICh0aGlzLl9nZXRFZGl0aW5nKCkgPT09IGZhbHNlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMucHJvcHMuc2V0Q29sb3JVSSkge1xuICAgICAgICB0aGlzLnByb3BzLnNldENvbG9yVUkoe3Nob3dEcm9wZG93bjogZmFsc2UsIHNob3dTa2V0Y2hlcjogZmFsc2V9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe3Nob3dEcm9wZG93bjogZmFsc2V9KTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgX29uU2VsZWN0Q29sb3IgPSAoY29sb3I6IFJHQkNvbG9yIHwgQ29sb3JSYW5nZSwgZTogTW91c2VFdmVudCkgPT4ge1xuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIGNvbnN0IGVkaXRpbmcgPSB0aGlzLl9nZXRFZGl0aW5nKCk7XG4gICAgICBjb25zdCBjb2xvclNldCA9IHR5cGVvZiBlZGl0aW5nID09PSAnbnVtYmVyJyAmJiB0aGlzLnByb3BzLmNvbG9yU2V0c1tlZGl0aW5nXTtcbiAgICAgIGlmIChjb2xvclNldCkge1xuICAgICAgICB0aGlzLl9zZXRDb2xvcihjb2xvclNldCwgY29sb3IsIGNvbG9yU2V0LnNlbGVjdGVkQ29sb3JbM10pO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBfb25TZWxlY3RPcGFjaXR5ID0gKG9wYWNpdHk6IG51bWJlcltdLCBlOiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICBpZiAoZSkgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIGNvbnN0IGVkaXRpbmcgPSB0aGlzLl9nZXRFZGl0aW5nKCk7XG4gICAgICBjb25zdCBjb2xvclNldCA9IHR5cGVvZiBlZGl0aW5nID09PSAnbnVtYmVyJyAmJiB0aGlzLnByb3BzLmNvbG9yU2V0c1tlZGl0aW5nXTtcbiAgICAgIGlmIChjb2xvclNldCkge1xuICAgICAgICB0aGlzLl9zZXRDb2xvcihjb2xvclNldCwgY29sb3JTZXQuc2VsZWN0ZWRDb2xvciwgTWF0aC5yb3VuZChvcGFjaXR5WzFdICogMjU1KSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIF9zZXRDb2xvciA9IChjb2xvclNldDogQ29sb3JTZXQsIGNvbG9yOiBSR0JDb2xvciB8IFJHQkFDb2xvciB8IENvbG9yUmFuZ2UsIG9wYWNpdHk6IG51bWJlcikgPT4ge1xuICAgICAgaWYgKHRoaXMucHJvcHMudXNlT3BhY2l0eSAmJiBBcnJheS5pc0FycmF5KGNvbG9yKSkge1xuICAgICAgICBjb2xvclNldC5zZXRDb2xvcihbLi4uY29sb3Iuc2xpY2UoMCwgMyksIG9wYWNpdHldIGFzIFJHQkFDb2xvcik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb2xvclNldC5zZXRDb2xvcihjb2xvcik7XG4gICAgICB9XG4gICAgfTtcblxuICAgIF9zaG93RHJvcGRvd24gPSAoZSwgaSkgPT4ge1xuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgaWYgKHRoaXMucHJvcHMuc2V0Q29sb3JVSSkge1xuICAgICAgICB0aGlzLnByb3BzLnNldENvbG9yVUkoe3Nob3dEcm9wZG93bjogaX0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7c2hvd0Ryb3Bkb3duOiBpfSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIHJlbmRlcigpIHtcbiAgICAgIGNvbnN0IHtjb2xvclNldHMsIHVzZU9wYWNpdHksIGRpc2FibGVkLCBpbnB1dFRoZW1lLCBjb2xvclVJfSA9IHRoaXMucHJvcHM7XG5cbiAgICAgIGNvbnN0IGVkaXRpbmcgPSB0aGlzLl9nZXRFZGl0aW5nKCk7XG4gICAgICBjb25zdCBjdXJyZW50RWRpdGluZyA9XG4gICAgICAgIHR5cGVvZiBlZGl0aW5nID09PSAnbnVtYmVyJyAmJiBjb2xvclNldHNbZWRpdGluZ10gJiYgdHlwZW9mIGNvbG9yU2V0c1tlZGl0aW5nXSA9PT0gJ29iamVjdCc7XG5cbiAgICAgIHJldHVybiAoXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29sb3Itc2VsZWN0b3JcIiByZWY9e3RoaXMubm9kZX0+XG4gICAgICAgICAgPElucHV0Qm94Q29udGFpbmVyPlxuICAgICAgICAgICAge2NvbG9yU2V0cy5tYXAoKGNTZXQsIGkpID0+IChcbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb2xvci1zZWxlY3RfX2lucHV0LWdyb3VwXCIga2V5PXtpfT5cbiAgICAgICAgICAgICAgICA8Q29sb3JTZWxlY3RvcklucHV0XG4gICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJjb2xvci1zZWxlY3Rvcl9fc2VsZWN0b3JcIlxuICAgICAgICAgICAgICAgICAgYWN0aXZlPXtlZGl0aW5nID09PSBpfVxuICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ9e2Rpc2FibGVkfVxuICAgICAgICAgICAgICAgICAgaW5wdXRUaGVtZT17aW5wdXRUaGVtZX1cbiAgICAgICAgICAgICAgICAgIG9uTW91c2VEb3duPXtlID0+IHRoaXMuX3Nob3dEcm9wZG93bihlLCBpKX1cbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICB7Y1NldC5pc1JhbmdlID8gKFxuICAgICAgICAgICAgICAgICAgICA8Q29sb3JQYWxldHRlIGNvbG9ycz17KGNTZXQuc2VsZWN0ZWRDb2xvciBhcyBDb2xvclJhbmdlKS5jb2xvcnN9IC8+XG4gICAgICAgICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICAgICAgICA8Q29sb3JCbG9ja1xuICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImNvbG9yLXNlbGVjdG9yX19zZWxlY3Rvcl9fYmxvY2tcIlxuICAgICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmRjb2xvcj17Y1NldC5zZWxlY3RlZENvbG9yIGFzIFJHQkNvbG9yfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgIHtjU2V0LmxhYmVsID8gKFxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbG9yLXNlbGVjdG9yX19zZWxlY3Rvcl9fbGFiZWxcIj57Y1NldC5sYWJlbH08L2Rpdj5cbiAgICAgICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgICAgIDwvQ29sb3JTZWxlY3RvcklucHV0PlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICkpfVxuICAgICAgICAgIDwvSW5wdXRCb3hDb250YWluZXI+XG4gICAgICAgICAge2N1cnJlbnRFZGl0aW5nID8gKFxuICAgICAgICAgICAgPFN0eWxlZFBhbmVsRHJvcGRvd24gY2xhc3NOYW1lPVwiY29sb3Itc2VsZWN0b3JfX2Ryb3Bkb3duXCI+XG4gICAgICAgICAgICAgIHtjb2xvclNldHNbZWRpdGluZyBhcyBudW1iZXJdLmlzUmFuZ2UgPyAoXG4gICAgICAgICAgICAgICAgPENvbG9yUmFuZ2VTZWxlY3RvclxuICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRDb2xvclJhbmdlPXtjb2xvclNldHNbZWRpdGluZyBhcyBudW1iZXJdLnNlbGVjdGVkQ29sb3IgYXMgQ29sb3JSYW5nZX1cbiAgICAgICAgICAgICAgICAgIG9uU2VsZWN0Q29sb3JSYW5nZT17dGhpcy5fb25TZWxlY3RDb2xvcn1cbiAgICAgICAgICAgICAgICAgIHNldENvbG9yUGFsZXR0ZVVJPXt0aGlzLnByb3BzLnNldENvbG9yVUl9XG4gICAgICAgICAgICAgICAgICBjb2xvclBhbGV0dGVVST17Y29sb3JVSSBhcyBDb2xvclVJfVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgICAgPFNpbmdsZUNvbG9yUGFsZXR0ZVxuICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRDb2xvcj17cmdiVG9IZXgoY29sb3JTZXRzW2VkaXRpbmcgYXMgbnVtYmVyXS5zZWxlY3RlZENvbG9yIGFzIFJHQkNvbG9yKX1cbiAgICAgICAgICAgICAgICAgIG9uU2VsZWN0Q29sb3I9e3RoaXMuX29uU2VsZWN0Q29sb3J9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAge3VzZU9wYWNpdHkgPyAoXG4gICAgICAgICAgICAgICAgPE9wYWNpdHlTbGlkZXJXcmFwcGVyPlxuICAgICAgICAgICAgICAgICAgPFBhbmVsTGFiZWw+XG4gICAgICAgICAgICAgICAgICAgIDxGb3JtYXR0ZWRNZXNzYWdlIGlkPVwiY29sb3Iub3BhY2l0eVwiIC8+XG4gICAgICAgICAgICAgICAgICA8L1BhbmVsTGFiZWw+XG4gICAgICAgICAgICAgICAgICA8UmFuZ2VTbGlkZXJcbiAgICAgICAgICAgICAgICAgICAgey4uLk9QQUNJVFlfU0xJREVSX1BST1BTfVxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTE9e2NvbG9yU2V0c1tlZGl0aW5nIGFzIG51bWJlcl0uc2VsZWN0ZWRDb2xvclszXSAvIDI1NX1cbiAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMuX29uU2VsZWN0T3BhY2l0eX1cbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgPC9PcGFjaXR5U2xpZGVyV3JhcHBlcj5cbiAgICAgICAgICAgICAgKSA6IG51bGx9XG4gICAgICAgICAgICA8L1N0eWxlZFBhbmVsRHJvcGRvd24+XG4gICAgICAgICAgKSA6IG51bGx9XG4gICAgICAgIDwvZGl2PlxuICAgICAgKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG9uQ2xpY2tPdXRzaWRlKENvbG9yU2VsZWN0b3IpIGFzIENvbXBvbmVudFR5cGU8Q29sb3JTZWxlY3RvclByb3BzPjtcbn1cblxuZXhwb3J0IGRlZmF1bHQgQ29sb3JTZWxlY3RvckZhY3Rvcnk7XG4iXX0=
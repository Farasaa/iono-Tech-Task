"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _assertThisInitialized2 = _interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _taggedTemplateLiteral2 = _interopRequireDefault(require("@babel/runtime/helpers/taggedTemplateLiteral"));

var _react = _interopRequireWildcard(require("react"));

var _styledComponents = _interopRequireDefault(require("styled-components"));

var _classnames = _interopRequireDefault(require("classnames"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _constants = require("@kepler.gl/constants");

var _effectPanelHeader = _interopRequireDefault(require("./effect-panel-header"));

var _effectConfigurator = _interopRequireDefault(require("./effect-configurator"));

var _templateObject;

function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = (0, _getPrototypeOf2["default"])(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2["default"])(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2["default"])(this, result); }; }

function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }

var PanelWrapper = _styledComponents["default"].div(_templateObject || (_templateObject = (0, _taggedTemplateLiteral2["default"])(["\n  font-size: 12px;\n  border-radius: 1px;\n  z-index: 1000;\n  &.dragging {\n    cursor: move;\n  }\n  margin: 3px auto 3px 25px;\n  max-width: 295px;\n"])));

EffectPanelFactory.deps = [_effectPanelHeader["default"], _effectConfigurator["default"]];

function EffectPanelFactory(EffectPanelHeader, EffectConfigurator) {
  var EffectPanel = /*#__PURE__*/function (_Component) {
    (0, _inherits2["default"])(EffectPanel, _Component);

    var _super = _createSuper(EffectPanel);

    function EffectPanel() {
      var _this;

      (0, _classCallCheck2["default"])(this, EffectPanel);

      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }

      _this = _super.call.apply(_super, [this].concat(args));
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "_toggleEnabled", function (event) {
        event === null || event === void 0 ? void 0 : event.stopPropagation();

        _this.props.updateEffect(_this.props.effect.id, {
          isEnabled: !_this.props.effect.isEnabled
        });
      });
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "_toggleConfigActive", function (event) {
        event === null || event === void 0 ? void 0 : event.stopPropagation();

        _this.props.updateEffect(_this.props.effect.id, {
          isConfigActive: !_this.props.effect.isConfigActive
        });
      });
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "_removeEffect", function (event) {
        event === null || event === void 0 ? void 0 : event.stopPropagation();

        _this.props.removeEffect(_this.props.effect.id);
      });
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "_updateEffectConfig", function (event, id, props) {
        event === null || event === void 0 ? void 0 : event.stopPropagation();

        _this.props.updateEffect(id, props);
      });
      return _this;
    }

    (0, _createClass2["default"])(EffectPanel, [{
      key: "render",
      value: function render() {
        var _this$props = this.props,
            effect = _this$props.effect,
            isDraggable = _this$props.isDraggable,
            listeners = _this$props.listeners;
        var id = effect.id,
            type = effect.type,
            isConfigActive = effect.isConfigActive,
            isJsonEditorActive = effect.isJsonEditorActive,
            isEnabled = effect.isEnabled;
        var sortingAllowed = type !== _constants.LIGHT_AND_SHADOW_EFFECT.type;
        return /*#__PURE__*/_react["default"].createElement(PanelWrapper, {
          active: false,
          className: (0, _classnames["default"])('effect-panel', this.props.className),
          "data-testid": _constants.dataTestIds.effectPanel,
          style: this.props.style,
          onMouseDown: this.props.onMouseDown,
          onTouchStart: this.props.onTouchStart
        }, /*#__PURE__*/_react["default"].createElement(EffectPanelHeader, {
          isConfigActive: isConfigActive,
          effectId: id,
          type: type,
          isEnabled: isEnabled,
          isJsonEditorActive: isJsonEditorActive,
          onToggleEnabled: this._toggleEnabled,
          onRemoveEffect: this._removeEffect,
          onToggleEnableConfig: this._toggleConfigActive,
          isDragNDropEnabled: isDraggable && sortingAllowed,
          listeners: listeners,
          showSortHandle: type !== _constants.LIGHT_AND_SHADOW_EFFECT.type
        }), isConfigActive && /*#__PURE__*/_react["default"].createElement(EffectConfigurator, {
          key: "effect-configurator-".concat(id),
          effect: effect,
          updateEffectConfig: this._updateEffectConfig
        }));
      }
    }]);
    return EffectPanel;
  }(_react.Component); // @ts-expect-error fix The types of 'propTypes.isDraggable[nominalTypeHack]' are incompatible between these types.


  (0, _defineProperty2["default"])(EffectPanel, "propTypes", {
    effect: _propTypes["default"].object.isRequired,
    removeEffect: _propTypes["default"].func.isRequired,
    updateEffect: _propTypes["default"].func.isRequired,
    isDraggable: _propTypes["default"].bool
  });
  return EffectPanel;
}

var _default = EffectPanelFactory;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9lZmZlY3RzL2VmZmVjdC1wYW5lbC50c3giXSwibmFtZXMiOlsiUGFuZWxXcmFwcGVyIiwic3R5bGVkIiwiZGl2IiwiRWZmZWN0UGFuZWxGYWN0b3J5IiwiZGVwcyIsIkVmZmVjdFBhbmVsSGVhZGVyRmFjdG9yeSIsIkVmZmVjdENvbmZpZ3VyYXRvckZhY3RvcnkiLCJFZmZlY3RQYW5lbEhlYWRlciIsIkVmZmVjdENvbmZpZ3VyYXRvciIsIkVmZmVjdFBhbmVsIiwiZXZlbnQiLCJzdG9wUHJvcGFnYXRpb24iLCJwcm9wcyIsInVwZGF0ZUVmZmVjdCIsImVmZmVjdCIsImlkIiwiaXNFbmFibGVkIiwiaXNDb25maWdBY3RpdmUiLCJyZW1vdmVFZmZlY3QiLCJpc0RyYWdnYWJsZSIsImxpc3RlbmVycyIsInR5cGUiLCJpc0pzb25FZGl0b3JBY3RpdmUiLCJzb3J0aW5nQWxsb3dlZCIsIkxJR0hUX0FORF9TSEFET1dfRUZGRUNUIiwiY2xhc3NOYW1lIiwiZGF0YVRlc3RJZHMiLCJlZmZlY3RQYW5lbCIsInN0eWxlIiwib25Nb3VzZURvd24iLCJvblRvdWNoU3RhcnQiLCJfdG9nZ2xlRW5hYmxlZCIsIl9yZW1vdmVFZmZlY3QiLCJfdG9nZ2xlQ29uZmlnQWN0aXZlIiwiX3VwZGF0ZUVmZmVjdENvbmZpZyIsIkNvbXBvbmVudCIsIlByb3BUeXBlcyIsIm9iamVjdCIsImlzUmVxdWlyZWQiLCJmdW5jIiwiYm9vbCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBR0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRUE7O0FBSUE7O0FBQ0E7Ozs7Ozs7O0FBbUJBLElBQU1BLFlBQVksR0FBR0MsNkJBQU9DLEdBQVYsZ1BBQWxCOztBQVdBQyxrQkFBa0IsQ0FBQ0MsSUFBbkIsR0FBMEIsQ0FBQ0MsNkJBQUQsRUFBMkJDLDhCQUEzQixDQUExQjs7QUFFQSxTQUFTSCxrQkFBVCxDQUNFSSxpQkFERixFQUVFQyxrQkFGRixFQUdtQztB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RSxVQUFBLG9CQUFvQixFQUFFLEtBQUtDLG1CQVI3QjtBQVNFLFVBQUEsa0JBQWtCLEVBQUVkLFdBQVcsSUFBSUksY0FUckM7QUFVRSxVQUFBLFNBQVMsRUFBRUgsU0FWYjtBQVdFLFVBQUEsY0FBYyxFQUFFQyxJQUFJLEtBQUtHLG1DQUF3Qkg7QUFYbkQsVUFSRixFQXFCR0osY0FBYyxpQkFDYixnQ0FBQyxrQkFBRDtBQUNFLFVBQUEsR0FBRyxnQ0FBeUJGLEVBQXpCLENBREw7QUFFRSxVQUFBLE1BQU0sRUFBRUQsTUFGVjtBQUdFLFVBQUEsa0JBQWtCLEVBQUUsS0FBS29CO0FBSDNCLFVBdEJKLENBREY7QUErQkQ7QUF0RThCO0FBQUE7QUFBQSxJQUNQQyxnQkFETyxHQXlFakM7OztBQXpFaUMsbUNBQzNCMUIsV0FEMkIsZUFFWjtBQUNqQkssSUFBQUEsTUFBTSxFQUFFc0Isc0JBQVVDLE1BQVYsQ0FBaUJDLFVBRFI7QUFFakJwQixJQUFBQSxZQUFZLEVBQUVrQixzQkFBVUcsSUFBVixDQUFlRCxVQUZaO0FBR2pCekIsSUFBQUEsWUFBWSxFQUFFdUIsc0JBQVVHLElBQVYsQ0FBZUQsVUFIWjtBQUlqQm5CLElBQUFBLFdBQVcsRUFBRWlCLHNCQUFVSTtBQUpOLEdBRlk7QUEwRWpDLFNBQU8vQixXQUFQO0FBQ0Q7O2VBRWNOLGtCIiwic291cmNlc0NvbnRlbnQiOlsiLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVFxuLy8gQ29weXJpZ2h0IGNvbnRyaWJ1dG9ycyB0byB0aGUga2VwbGVyLmdsIHByb2plY3RcblxuaW1wb3J0IFJlYWN0LCB7Q29tcG9uZW50LCBDb21wb25lbnRUeXBlfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgc3R5bGVkIGZyb20gJ3N0eWxlZC1jb21wb25lbnRzJztcbmltcG9ydCBjbGFzc25hbWVzIGZyb20gJ2NsYXNzbmFtZXMnO1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJztcblxuaW1wb3J0IHtkYXRhVGVzdElkcywgTElHSFRfQU5EX1NIQURPV19FRkZFQ1R9IGZyb20gJ0BrZXBsZXIuZ2wvY29uc3RhbnRzJztcbmltcG9ydCB7cmVtb3ZlRWZmZWN0LCB1cGRhdGVFZmZlY3R9IGZyb20gJ0BrZXBsZXIuZ2wvYWN0aW9ucyc7XG5pbXBvcnQge0VmZmVjdH0gZnJvbSAnQGtlcGxlci5nbC90eXBlcyc7XG5cbmltcG9ydCBFZmZlY3RQYW5lbEhlYWRlckZhY3RvcnkgZnJvbSAnLi9lZmZlY3QtcGFuZWwtaGVhZGVyJztcbmltcG9ydCBFZmZlY3RDb25maWd1cmF0b3JGYWN0b3J5IGZyb20gJy4vZWZmZWN0LWNvbmZpZ3VyYXRvcic7XG5cbmV4cG9ydCB0eXBlIEVmZmVjdFBhbmVsUHJvcHMgPSB7XG4gIGNsYXNzTmFtZTogc3RyaW5nO1xuICBlZmZlY3Q6IEVmZmVjdDtcbiAgaXNEcmFnZ2FibGU6IGJvb2xlYW47XG4gIGxpc3RlbmVyczogYW55O1xuICByZW1vdmVFZmZlY3Q6IHR5cGVvZiByZW1vdmVFZmZlY3Q7XG4gIHVwZGF0ZUVmZmVjdDogdHlwZW9mIHVwZGF0ZUVmZmVjdDtcblxuICBzdHlsZT86IFJlYWN0LkNTU1Byb3BlcnRpZXM7XG4gIG9uTW91c2VEb3duOiBSZWFjdC5Nb3VzZUV2ZW50SGFuZGxlcjxIVE1MRGl2RWxlbWVudD47XG4gIG9uVG91Y2hTdGFydDogUmVhY3QuVG91Y2hFdmVudEhhbmRsZXI8SFRNTERpdkVsZW1lbnQ+O1xufTtcblxuZXhwb3J0IHR5cGUgUGFuZWxXcmFwcGVyUHJvcHMgPSB7XG4gIGFjdGl2ZTogYm9vbGVhbjtcbn07XG5cbmNvbnN0IFBhbmVsV3JhcHBlciA9IHN0eWxlZC5kaXY8UGFuZWxXcmFwcGVyUHJvcHM+YFxuICBmb250LXNpemU6IDEycHg7XG4gIGJvcmRlci1yYWRpdXM6IDFweDtcbiAgei1pbmRleDogMTAwMDtcbiAgJi5kcmFnZ2luZyB7XG4gICAgY3Vyc29yOiBtb3ZlO1xuICB9XG4gIG1hcmdpbjogM3B4IGF1dG8gM3B4IDI1cHg7XG4gIG1heC13aWR0aDogMjk1cHg7XG5gO1xuXG5FZmZlY3RQYW5lbEZhY3RvcnkuZGVwcyA9IFtFZmZlY3RQYW5lbEhlYWRlckZhY3RvcnksIEVmZmVjdENvbmZpZ3VyYXRvckZhY3RvcnldO1xuXG5mdW5jdGlvbiBFZmZlY3RQYW5lbEZhY3RvcnkoXG4gIEVmZmVjdFBhbmVsSGVhZGVyOiBSZXR1cm5UeXBlPHR5cGVvZiBFZmZlY3RQYW5lbEhlYWRlckZhY3Rvcnk+LFxuICBFZmZlY3RDb25maWd1cmF0b3I6IFJldHVyblR5cGU8dHlwZW9mIEVmZmVjdENvbmZpZ3VyYXRvckZhY3Rvcnk+XG4pOiBDb21wb25lbnRUeXBlPEVmZmVjdFBhbmVsUHJvcHM+IHtcbiAgY2xhc3MgRWZmZWN0UGFuZWwgZXh0ZW5kcyBDb21wb25lbnQ8RWZmZWN0UGFuZWxQcm9wcz4ge1xuICAgIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgICBlZmZlY3Q6IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcbiAgICAgIHJlbW92ZUVmZmVjdDogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgICAgIHVwZGF0ZUVmZmVjdDogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgICAgIGlzRHJhZ2dhYmxlOiBQcm9wVHlwZXMuYm9vbFxuICAgIH07XG5cbiAgICBfdG9nZ2xlRW5hYmxlZCA9IChldmVudD86IEV2ZW50KSA9PiB7XG4gICAgICBldmVudD8uc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICB0aGlzLnByb3BzLnVwZGF0ZUVmZmVjdCh0aGlzLnByb3BzLmVmZmVjdC5pZCwge1xuICAgICAgICBpc0VuYWJsZWQ6ICF0aGlzLnByb3BzLmVmZmVjdC5pc0VuYWJsZWRcbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICBfdG9nZ2xlQ29uZmlnQWN0aXZlID0gKGV2ZW50PzogRXZlbnQpID0+IHtcbiAgICAgIGV2ZW50Py5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIHRoaXMucHJvcHMudXBkYXRlRWZmZWN0KHRoaXMucHJvcHMuZWZmZWN0LmlkLCB7XG4gICAgICAgIGlzQ29uZmlnQWN0aXZlOiAhdGhpcy5wcm9wcy5lZmZlY3QuaXNDb25maWdBY3RpdmVcbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICBfcmVtb3ZlRWZmZWN0ID0gKGV2ZW50PzogRXZlbnQpID0+IHtcbiAgICAgIGV2ZW50Py5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIHRoaXMucHJvcHMucmVtb3ZlRWZmZWN0KHRoaXMucHJvcHMuZWZmZWN0LmlkKTtcbiAgICB9O1xuXG4gICAgX3VwZGF0ZUVmZmVjdENvbmZpZyA9IChldmVudCwgaWQsIHByb3BzKSA9PiB7XG4gICAgICBldmVudD8uc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICB0aGlzLnByb3BzLnVwZGF0ZUVmZmVjdChpZCwgcHJvcHMpO1xuICAgIH07XG5cbiAgICByZW5kZXIoKSB7XG4gICAgICBjb25zdCB7ZWZmZWN0LCBpc0RyYWdnYWJsZSwgbGlzdGVuZXJzfSA9IHRoaXMucHJvcHM7XG4gICAgICBjb25zdCB7aWQsIHR5cGUsIGlzQ29uZmlnQWN0aXZlLCBpc0pzb25FZGl0b3JBY3RpdmUsIGlzRW5hYmxlZH0gPSBlZmZlY3Q7XG5cbiAgICAgIGNvbnN0IHNvcnRpbmdBbGxvd2VkID0gdHlwZSAhPT0gTElHSFRfQU5EX1NIQURPV19FRkZFQ1QudHlwZTtcblxuICAgICAgcmV0dXJuIChcbiAgICAgICAgPFBhbmVsV3JhcHBlclxuICAgICAgICAgIGFjdGl2ZT17ZmFsc2V9XG4gICAgICAgICAgY2xhc3NOYW1lPXtjbGFzc25hbWVzKCdlZmZlY3QtcGFuZWwnLCB0aGlzLnByb3BzLmNsYXNzTmFtZSl9XG4gICAgICAgICAgZGF0YS10ZXN0aWQ9e2RhdGFUZXN0SWRzLmVmZmVjdFBhbmVsfVxuICAgICAgICAgIHN0eWxlPXt0aGlzLnByb3BzLnN0eWxlfVxuICAgICAgICAgIG9uTW91c2VEb3duPXt0aGlzLnByb3BzLm9uTW91c2VEb3dufVxuICAgICAgICAgIG9uVG91Y2hTdGFydD17dGhpcy5wcm9wcy5vblRvdWNoU3RhcnR9XG4gICAgICAgID5cbiAgICAgICAgICA8RWZmZWN0UGFuZWxIZWFkZXJcbiAgICAgICAgICAgIGlzQ29uZmlnQWN0aXZlPXtpc0NvbmZpZ0FjdGl2ZX1cbiAgICAgICAgICAgIGVmZmVjdElkPXtpZH1cbiAgICAgICAgICAgIHR5cGU9e3R5cGV9XG4gICAgICAgICAgICBpc0VuYWJsZWQ9e2lzRW5hYmxlZH1cbiAgICAgICAgICAgIGlzSnNvbkVkaXRvckFjdGl2ZT17aXNKc29uRWRpdG9yQWN0aXZlfVxuICAgICAgICAgICAgb25Ub2dnbGVFbmFibGVkPXt0aGlzLl90b2dnbGVFbmFibGVkfVxuICAgICAgICAgICAgb25SZW1vdmVFZmZlY3Q9e3RoaXMuX3JlbW92ZUVmZmVjdH1cbiAgICAgICAgICAgIG9uVG9nZ2xlRW5hYmxlQ29uZmlnPXt0aGlzLl90b2dnbGVDb25maWdBY3RpdmV9XG4gICAgICAgICAgICBpc0RyYWdORHJvcEVuYWJsZWQ9e2lzRHJhZ2dhYmxlICYmIHNvcnRpbmdBbGxvd2VkfVxuICAgICAgICAgICAgbGlzdGVuZXJzPXtsaXN0ZW5lcnN9XG4gICAgICAgICAgICBzaG93U29ydEhhbmRsZT17dHlwZSAhPT0gTElHSFRfQU5EX1NIQURPV19FRkZFQ1QudHlwZX1cbiAgICAgICAgICAvPlxuICAgICAgICAgIHtpc0NvbmZpZ0FjdGl2ZSAmJiAoXG4gICAgICAgICAgICA8RWZmZWN0Q29uZmlndXJhdG9yXG4gICAgICAgICAgICAgIGtleT17YGVmZmVjdC1jb25maWd1cmF0b3ItJHtpZH1gfVxuICAgICAgICAgICAgICBlZmZlY3Q9e2VmZmVjdH1cbiAgICAgICAgICAgICAgdXBkYXRlRWZmZWN0Q29uZmlnPXt0aGlzLl91cGRhdGVFZmZlY3RDb25maWd9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICl9XG4gICAgICAgIDwvUGFuZWxXcmFwcGVyPlxuICAgICAgKTtcbiAgICB9XG4gIH1cblxuICAvLyBAdHMtZXhwZWN0LWVycm9yIGZpeCBUaGUgdHlwZXMgb2YgJ3Byb3BUeXBlcy5pc0RyYWdnYWJsZVtub21pbmFsVHlwZUhhY2tdJyBhcmUgaW5jb21wYXRpYmxlIGJldHdlZW4gdGhlc2UgdHlwZXMuXG4gIHJldHVybiBFZmZlY3RQYW5lbDtcbn1cblxuZXhwb3J0IGRlZmF1bHQgRWZmZWN0UGFuZWxGYWN0b3J5O1xuIl19
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.isStyleUsingMapboxTiles = isStyleUsingMapboxTiles;
exports.transformRequest = void 0;

// SPDX-License-Identifier: MIT
// Copyright contributors to the kepler.gl project

/**
 * Determines whether a Map Style is using Mapbox Tiles
 * @param {any} mapStyle the mapStyle to check
 * @returns true if the style is using Mapbox tiles
 */
function isStyleUsingMapboxTiles(mapStyle) {
  var _mapStyle$stylesheet;

  var sources = ((_mapStyle$stylesheet = mapStyle.stylesheet) === null || _mapStyle$stylesheet === void 0 ? void 0 : _mapStyle$stylesheet.sources) || {};
  return Object.keys(sources).some(function (sourceId) {
    var _ref = sources[sourceId] || {},
        url = _ref.url,
        tiles = _ref.tiles;

    if (url) {
      return url.toLowerCase().startsWith('mapbox://');
    }

    if (tiles) {
      return tiles.some(function (tileUrl) {
        return tileUrl.toLowerCase().startsWith('mapbox://');
      });
    }

    return false;
  });
}

var transformRequest = function transformRequest(url) {
  var isMapboxRequest = url.slice(8, 22) === 'api.mapbox.com' || url.slice(10, 26) === 'tiles.mapbox.com';
  return {
    url: isMapboxRequest ? url.replace('?', '?pluginName=Keplergl&') : url
  };
};

exports.transformRequest = transformRequest;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9tYXAtc3R5bGUtdXRpbHMvbWFwYm94LXV0aWxzLnRzIl0sIm5hbWVzIjpbImlzU3R5bGVVc2luZ01hcGJveFRpbGVzIiwibWFwU3R5bGUiLCJzb3VyY2VzIiwic3R5bGVzaGVldCIsIk9iamVjdCIsImtleXMiLCJzb21lIiwic291cmNlSWQiLCJ1cmwiLCJ0aWxlcyIsInRvTG93ZXJDYXNlIiwic3RhcnRzV2l0aCIsInRpbGVVcmwiLCJ0cmFuc2Zvcm1SZXF1ZXN0IiwiaXNNYXBib3hSZXF1ZXN0Iiwic2xpY2UiLCJyZXBsYWNlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPLFNBQVNBLHVCQUFULENBQWlDQyxRQUFqQyxFQUEyQztBQUFBOztBQUNoRCxNQUFNQyxPQUFPLEdBQUcseUJBQUFELFFBQVEsQ0FBQ0UsVUFBVCw4RUFBcUJELE9BQXJCLEtBQWdDLEVBQWhEO0FBRUEsU0FBT0UsTUFBTSxDQUFDQyxJQUFQLENBQVlILE9BQVosRUFBcUJJLElBQXJCLENBQTBCLFVBQUFDLFFBQVEsRUFBSTtBQUFBLGVBQ3RCTCxPQUFPLENBQUNLLFFBQUQsQ0FBUCxJQUFxQixFQURDO0FBQUEsUUFDcENDLEdBRG9DLFFBQ3BDQSxHQURvQztBQUFBLFFBQy9CQyxLQUQrQixRQUMvQkEsS0FEK0I7O0FBRzNDLFFBQUlELEdBQUosRUFBUztBQUNQLGFBQU9BLEdBQUcsQ0FBQ0UsV0FBSixHQUFrQkMsVUFBbEIsQ0FBNkIsV0FBN0IsQ0FBUDtBQUNEOztBQUVELFFBQUlGLEtBQUosRUFBVztBQUNULGFBQU9BLEtBQUssQ0FBQ0gsSUFBTixDQUFXLFVBQUFNLE9BQU87QUFBQSxlQUFJQSxPQUFPLENBQUNGLFdBQVIsR0FBc0JDLFVBQXRCLENBQWlDLFdBQWpDLENBQUo7QUFBQSxPQUFsQixDQUFQO0FBQ0Q7O0FBRUQsV0FBTyxLQUFQO0FBQ0QsR0FaTSxDQUFQO0FBYUQ7O0FBRU0sSUFBTUUsZ0JBQWdCLEdBQUcsU0FBbkJBLGdCQUFtQixDQUFDTCxHQUFELEVBQWdDO0FBQzlELE1BQU1NLGVBQWUsR0FDbkJOLEdBQUcsQ0FBQ08sS0FBSixDQUFVLENBQVYsRUFBYSxFQUFiLE1BQXFCLGdCQUFyQixJQUF5Q1AsR0FBRyxDQUFDTyxLQUFKLENBQVUsRUFBVixFQUFjLEVBQWQsTUFBc0Isa0JBRGpFO0FBR0EsU0FBTztBQUNMUCxJQUFBQSxHQUFHLEVBQUVNLGVBQWUsR0FBR04sR0FBRyxDQUFDUSxPQUFKLENBQVksR0FBWixFQUFpQix1QkFBakIsQ0FBSCxHQUErQ1I7QUFEOUQsR0FBUDtBQUdELENBUE0iLCJzb3VyY2VzQ29udGVudCI6WyIvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogTUlUXG4vLyBDb3B5cmlnaHQgY29udHJpYnV0b3JzIHRvIHRoZSBrZXBsZXIuZ2wgcHJvamVjdFxuXG4vKipcbiAqIERldGVybWluZXMgd2hldGhlciBhIE1hcCBTdHlsZSBpcyB1c2luZyBNYXBib3ggVGlsZXNcbiAqIEBwYXJhbSB7YW55fSBtYXBTdHlsZSB0aGUgbWFwU3R5bGUgdG8gY2hlY2tcbiAqIEByZXR1cm5zIHRydWUgaWYgdGhlIHN0eWxlIGlzIHVzaW5nIE1hcGJveCB0aWxlc1xuICovXG5leHBvcnQgZnVuY3Rpb24gaXNTdHlsZVVzaW5nTWFwYm94VGlsZXMobWFwU3R5bGUpIHtcbiAgY29uc3Qgc291cmNlcyA9IG1hcFN0eWxlLnN0eWxlc2hlZXQ/LnNvdXJjZXMgfHwge307XG5cbiAgcmV0dXJuIE9iamVjdC5rZXlzKHNvdXJjZXMpLnNvbWUoc291cmNlSWQgPT4ge1xuICAgIGNvbnN0IHt1cmwsIHRpbGVzfSA9IHNvdXJjZXNbc291cmNlSWRdIHx8IHt9O1xuXG4gICAgaWYgKHVybCkge1xuICAgICAgcmV0dXJuIHVybC50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgoJ21hcGJveDovLycpO1xuICAgIH1cblxuICAgIGlmICh0aWxlcykge1xuICAgICAgcmV0dXJuIHRpbGVzLnNvbWUodGlsZVVybCA9PiB0aWxlVXJsLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aCgnbWFwYm94Oi8vJykpO1xuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbiAgfSk7XG59XG5cbmV4cG9ydCBjb25zdCB0cmFuc2Zvcm1SZXF1ZXN0ID0gKHVybDogc3RyaW5nKToge3VybDogc3RyaW5nfSA9PiB7XG4gIGNvbnN0IGlzTWFwYm94UmVxdWVzdCA9XG4gICAgdXJsLnNsaWNlKDgsIDIyKSA9PT0gJ2FwaS5tYXBib3guY29tJyB8fCB1cmwuc2xpY2UoMTAsIDI2KSA9PT0gJ3RpbGVzLm1hcGJveC5jb20nO1xuXG4gIHJldHVybiB7XG4gICAgdXJsOiBpc01hcGJveFJlcXVlc3QgPyB1cmwucmVwbGFjZSgnPycsICc/cGx1Z2luTmFtZT1LZXBsZXJnbCYnKSA6IHVybFxuICB9O1xufTtcbiJdfQ==
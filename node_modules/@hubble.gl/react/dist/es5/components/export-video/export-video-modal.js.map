{"version":3,"sources":["../../../../src/components/export-video/export-video-modal.js"],"names":["ModalContainer","styled","div","ExportVideoModal","showSettingsSelector","showSettings","theme","props","defaultSettingsPos","bottomBuffer","settingsHeight","root","current","sidePanelInnerPadding","sidePanel","sidePanelScrollBarWidth","sidePanelLeft","margin","left","offsetX","bounding","getBoundingClientRect","x","y","width","top","window","innerHeight","themeSelector","settingsPosSelector","settingsPos","content","right","SIDEPANEL_WIDTH","bottom","transform","padding","border","backgroundColor","sidePanelBg","borderRadius","panelBorderRadius","overlay","zIndex","modalOverLayZ","isOpen","children","modalStyles","modalStylesSelector","removeChild","appendChild","Component"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AAqBA;;AACA;;AACA;;AACA;;AACA;;;;;;;;;;;;;;;;AAEA,IAAMA,cAAc,GAAGC,6BAAOC,GAAV,mBAApB;;IAIMC,gB;;;;;;;;;;;;;;;6FAMG,uB;4GASe,8BAAe,MAAKC,oBAApB,EAA0C,UAACC,YAAD,EAA8B;AAAA,UAAfC,KAAe,uEAAP,EAAO;AAAA,wBACjC,MAAKC,KAD4B;AAAA,UACrFC,kBADqF,eACrFA,kBADqF;AAAA,UACjEC,YADiE,eACjEA,YADiE;AAAA,UACnDC,cADmD,eACnDA,cADmD;AAE5F,UAAIL,YAAY,KAAK,KAAjB,IAA0B,CAAC,MAAKM,IAAhC,IAAwC,CAAC,MAAKA,IAAL,CAAUC,OAAvD,EAAgE,OAAOJ,kBAAP;AAF4B,kCAGTF,KAHS,CAGrFO,qBAHqF;AAAA,UAGrFA,qBAHqF,sCAG7D,EAH6D;AAAA,6BAGTP,KAHS,CAGzDQ,SAHyD;AAAA,UAGzDA,SAHyD,iCAG7C,EAH6C;AAAA,kCAGTR,KAHS,CAGzCS,uBAHyC;AAAA,UAGzCA,uBAHyC,sCAGf,EAHe;AAI5F,UAAMC,aAAa,GAAG,CAACF,SAAS,CAACG,MAAV,IAAoB,EAArB,EAAyBC,IAAzB,IAAiC,EAAvD;AACA,UAAMC,OAAO,GAAGN,qBAAqB,GAAGG,aAAxB,GAAwCD,uBAAxD;;AAEA,UAAMK,QAAQ,GAAG,MAAKT,IAAL,CAAUC,OAAV,CAAkBS,qBAAlB,EAAjB;;AAP4F,UAQrFC,CARqF,GAQtEF,QARsE,CAQrFE,CARqF;AAAA,UAQlFC,CARkF,GAQtEH,QARsE,CAQlFG,CARkF;AAAA,UAQ/EC,KAR+E,GAQtEJ,QARsE,CAQ/EI,KAR+E;AAW5F,UAAMC,GAAG,GACPF,CAAC,GAAGb,cAAJ,IAAsBgB,MAAM,CAACC,WAAP,GAAqBlB,YAA3C,GACIc,CADJ,GAEIG,MAAM,CAACC,WAAP,GAAqBlB,YAArB,GAAoCC,cAH1C;AAKA,aAAO;AAACe,QAAAA,GAAG,YAAKA,GAAL,OAAJ;AAAkBP,QAAAA,IAAI,YAAKI,CAAC,GAAGE,KAAJ,GAAYL,OAAjB;AAAtB,OAAP;AACD,KAjBqB,C;4GAmBA,8BACpB,MAAKS,aADe,EAEpB,MAAKC,mBAFe,EAGpB,UAACvB,KAAD,EAAQwB,WAAR;AAAA,aAAyB;AACvBC,QAAAA,OAAO,EAAE;AACPN,UAAAA,GAAG,EAAE,MADE;AAEPP,UAAAA,IAAI,EAAE,MAFC;AAGPc,UAAAA,KAAK,uBAAgBC,6BAAkB,CAAlC,QAHE;AAIPC,UAAAA,MAAM,EAAE,KAJD;AAKPC,UAAAA,SAAS,EAAE,qBALJ;AAMPC,UAAAA,OAAO,EAAE,iBANF;AAOPC,UAAAA,MAAM,EAAE,CAPD;AAQPC,UAAAA,eAAe,EAAEhC,KAAK,CAACiC,WARhB;AASPC,UAAAA,YAAY,EAAElC,KAAK,CAACmC,iBAAN,IAA2B;AATlC,SADc;AAYvBC,QAAAA,OAAO,EAAE;AACPJ,UAAAA,eAAe,EAAE,mBADV;AAEPK,UAAAA,MAAM,EAAG,MAAKpC,KAAL,CAAWD,KAAX,IAAoB,MAAKC,KAAL,CAAWD,KAAX,CAAiBsC,aAAtC,IAAwD;AAFzD;AAZc,OAAzB;AAAA,KAHoB,C;;;;;;yCAzBDrC,K,EAAO;AAC1B,aAAOA,KAAK,CAACF,YAAb;AACD;;;kCACaE,K,EAAO;AACnB,aAAOA,KAAK,CAACD,KAAb;AACD;;;6BA0CQ;AAAA;;AAAA,yBAC2B,KAAKC,KADhC;AAAA,UACAsC,MADA,gBACAA,MADA;AAAA,UACQvC,KADR,gBACQA,KADR;AAAA,UACewC,QADf,gBACeA,QADf;AAGP,UAAMC,WAAW,GAAG,KAAKC,mBAAL,CAAyB,KAAKzC,KAA9B,CAApB;AACA,aACE,gCAAC,+BAAD;AAAe,QAAA,KAAK,EAAED;AAAtB,SACE,gCAAC,cAAD;AAAgB,QAAA,SAAS,EAAC,oBAA1B;AAA+C,QAAA,GAAG,EAAE,KAAKK;AAAzD,SACG,KAAKA,IAAL,CAAUC,OAAV,GACC,gCAAC,sBAAD;AACE,QAAA,MAAM,EAAEiC,MADV;AAEE,QAAA,KAAK,EAAEE,WAFT;AAGE,QAAA,WAAW,EAAE,KAHf;AAIE,QAAA,cAAc,EAAE,0BAAM;AACpB,iBACE,MAAI,CAACpC,IAAL,CAAUC,OAAV,IAAqB;AACnBqC,YAAAA,WAAW,EAAE,uBAAM,CAAE,CADF;AAEnBC,YAAAA,WAAW,EAAE,uBAAM,CAAE;AAFF,WADvB;AAMD;AAXH,SAaGJ,QAbH,CADD,GAgBG,IAjBN,CADF,CADF;AAuBD;;;EAnF4BK,gB;;iCAAzBhD,gB,kBACkB;AACpBK,EAAAA,kBAAkB,EAAE;AAACiB,IAAAA,GAAG,EAAE,OAAN;AAAeP,IAAAA,IAAI,EAAE;AAArB,GADA;AAEpBT,EAAAA,YAAY,EAAE;AAFM,C;eAqFTN,gB","sourcesContent":["// Copyright (c) 2020 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\n/* eslint-disable no-invalid-this */\nimport React, {Component, createRef} from 'react';\nimport Modal from 'react-modal';\nimport styled, {ThemeProvider} from 'styled-components';\nimport {createSelector} from 'reselect';\nimport {SIDEPANEL_WIDTH} from './constants';\n\nconst ModalContainer = styled.div`\n  position: relative;\n`;\n\nclass ExportVideoModal extends Component {\n  static defaultProps = {\n    defaultSettingsPos: {top: '320px', left: '320px'},\n    bottomBuffer: 212\n  };\n\n  root = createRef();\n\n  // derive settings position based on root component\n  showSettingsSelector(props) {\n    return props.showSettings;\n  }\n  themeSelector(props) {\n    return props.theme;\n  }\n  settingsPosSelector = createSelector(this.showSettingsSelector, (showSettings, theme = {}) => {\n    const {defaultSettingsPos, bottomBuffer, settingsHeight} = this.props;\n    if (showSettings === false || !this.root || !this.root.current) return defaultSettingsPos;\n    const {sidePanelInnerPadding = 16, sidePanel = {}, sidePanelScrollBarWidth = 10} = theme;\n    const sidePanelLeft = (sidePanel.margin || {}).left || 20;\n    const offsetX = sidePanelInnerPadding + sidePanelLeft + sidePanelScrollBarWidth;\n    // find component Root position\n    const bounding = this.root.current.getBoundingClientRect();\n    const {x, y, width} = bounding;\n\n    // set the top so it won't collide with bottom widget\n    const top =\n      y + settingsHeight <= window.innerHeight - bottomBuffer\n        ? y\n        : window.innerHeight - bottomBuffer - settingsHeight;\n\n    return {top: `${top}px`, left: `${x + width + offsetX}px`};\n  });\n\n  modalStylesSelector = createSelector(\n    this.themeSelector,\n    this.settingsPosSelector,\n    (theme, settingsPos) => ({\n      content: {\n        top: 'auto',\n        left: 'auto',\n        right: `calc(50% - ${SIDEPANEL_WIDTH / 2}px)`,\n        bottom: '50%',\n        transform: 'translate(50%, 50%)',\n        padding: '0px 0px 0px 0px',\n        border: 0,\n        backgroundColor: theme.sidePanelBg,\n        borderRadius: theme.panelBorderRadius || '2px'\n      },\n      overlay: {\n        backgroundColor: 'rgba(0, 0, 0, .5)',\n        zIndex: (this.props.theme && this.props.theme.modalOverLayZ) || 1000\n      }\n    })\n  );\n\n  render() {\n    const {isOpen, theme, children} = this.props;\n\n    const modalStyles = this.modalStylesSelector(this.props);\n    return (\n      <ThemeProvider theme={theme}>\n        <ModalContainer className=\"export-video-modal\" ref={this.root}>\n          {this.root.current ? (\n            <Modal\n              isOpen={isOpen}\n              style={modalStyles}\n              ariaHideApp={false}\n              parentSelector={() => {\n                return (\n                  this.root.current || {\n                    removeChild: () => {},\n                    appendChild: () => {}\n                  }\n                );\n              }}\n            >\n              {children}\n            </Modal>\n          ) : null}\n        </ModalContainer>\n      </ThemeProvider>\n    );\n  }\n}\n\nexport default ExportVideoModal;\n"],"file":"export-video-modal.js"}
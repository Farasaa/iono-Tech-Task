{"version":3,"file":"arrow-like-table.js","names":["ArrowLikeSchema","deduceTableSchema","getTableCell","getTableLength","getTableNumCols","ArrowLikeVector","constructor","table","columnName","get","rowIndex","toArray","_arrowTable$getChild","shape","arrowTable","data","getChild","Error","ArrowLikeTable","schema","fields","metadata","features","numCols","length"],"sources":["../../../../src/lib/table/arrow-api/arrow-like-table.ts"],"sourcesContent":["// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\n\nimport {Table} from '../../../types/category-table';\n\nimport {ArrowLikeSchema} from './arrow-like-schema';\n\nimport {deduceTableSchema} from '../simple-table/table-schema';\n\nimport {\n  getTableCell,\n  getTableLength,\n  getTableNumCols\n  // getTableCell,\n  // getTableRowShape,\n  // getTableColumnIndex,\n  // getTableColumnName,\n  // getTableRowAsObject,\n  // getTableRowAsArray\n} from '../simple-table/table-accessors';\n\nclass ArrowLikeVector {\n  table: Table;\n  columnName: string;\n\n  constructor(table: Table, columnName: string) {\n    this.table = table;\n    this.columnName = columnName;\n  }\n\n  get(rowIndex: number): unknown {\n    return getTableCell(this.table, rowIndex, this.columnName);\n  }\n\n  toArray(): ArrayLike<unknown> {\n    switch (this.table.shape) {\n      case 'arrow-table':\n        const arrowTable = this.table.data as any;\n        return arrowTable.getChild(this.columnName)?.toArray();\n      case 'columnar-table':\n        return this.table.data[this.columnName];\n      default:\n        throw new Error(this.table.shape);\n    }\n  }\n}\n\n/**\n * Class that provides an API similar to Apache Arrow Table class\n * Forwards methods directly if the underlying table is Arrow, otherwise calls accessor functions\n */\nexport class ArrowLikeTable {\n  schema: ArrowLikeSchema;\n  table: Table;\n\n  constructor(table: Table) {\n    const schema = table.schema || deduceTableSchema(table);\n    this.schema = new ArrowLikeSchema(schema.fields, schema.metadata);\n    this.table = {...table, schema};\n  }\n\n  // get schema() {\n  //   return this.table.schema;\n  // }\n\n  get data() {\n    return this.table.shape === 'geojson-table' ? this.table.features : this.table.data;\n  }\n\n  get numCols(): number {\n    return getTableNumCols(this.table);\n  }\n\n  get length(): number {\n    return getTableLength(this.table);\n  }\n\n  getChild(columnName: string): ArrowLikeVector {\n    return new ArrowLikeVector(this.table, columnName);\n  }\n\n  // getChildAt(columnIndex: number): ArrowLikeVector {\n  //   return\n  // }\n}\n"],"mappings":"SAMQA,eAAe;AAAA,SAEfC,iBAAiB;AAAA,SAGvBC,YAAY,EACZC,cAAc,EACdC,eAAe;AASjB,MAAMC,eAAe,CAAC;EAIpBC,WAAWA,CAACC,KAAY,EAAEC,UAAkB,EAAE;IAAA,KAH9CD,KAAK;IAAA,KACLC,UAAU;IAGR,IAAI,CAACD,KAAK,GAAGA,KAAK;IAClB,IAAI,CAACC,UAAU,GAAGA,UAAU;EAC9B;EAEAC,GAAGA,CAACC,QAAgB,EAAW;IAC7B,OAAOR,YAAY,CAAC,IAAI,CAACK,KAAK,EAAEG,QAAQ,EAAE,IAAI,CAACF,UAAU,CAAC;EAC5D;EAEAG,OAAOA,CAAA,EAAuB;IAAA,IAAAC,oBAAA;IAC5B,QAAQ,IAAI,CAACL,KAAK,CAACM,KAAK;MACtB,KAAK,aAAa;QAChB,MAAMC,UAAU,GAAG,IAAI,CAACP,KAAK,CAACQ,IAAW;QACzC,QAAAH,oBAAA,GAAOE,UAAU,CAACE,QAAQ,CAAC,IAAI,CAACR,UAAU,CAAC,cAAAI,oBAAA,uBAApCA,oBAAA,CAAsCD,OAAO,CAAC,CAAC;MACxD,KAAK,gBAAgB;QACnB,OAAO,IAAI,CAACJ,KAAK,CAACQ,IAAI,CAAC,IAAI,CAACP,UAAU,CAAC;MACzC;QACE,MAAM,IAAIS,KAAK,CAAC,IAAI,CAACV,KAAK,CAACM,KAAK,CAAC;IACrC;EACF;AACF;AAMA,OAAO,MAAMK,cAAc,CAAC;EAI1BZ,WAAWA,CAACC,KAAY,EAAE;IAAA,KAH1BY,MAAM;IAAA,KACNZ,KAAK;IAGH,MAAMY,MAAM,GAAGZ,KAAK,CAACY,MAAM,IAAIlB,iBAAiB,CAACM,KAAK,CAAC;IACvD,IAAI,CAACY,MAAM,GAAG,IAAInB,eAAe,CAACmB,MAAM,CAACC,MAAM,EAAED,MAAM,CAACE,QAAQ,CAAC;IACjE,IAAI,CAACd,KAAK,GAAG;MAAC,GAAGA,KAAK;MAAEY;IAAM,CAAC;EACjC;EAMA,IAAIJ,IAAIA,CAAA,EAAG;IACT,OAAO,IAAI,CAACR,KAAK,CAACM,KAAK,KAAK,eAAe,GAAG,IAAI,CAACN,KAAK,CAACe,QAAQ,GAAG,IAAI,CAACf,KAAK,CAACQ,IAAI;EACrF;EAEA,IAAIQ,OAAOA,CAAA,EAAW;IACpB,OAAOnB,eAAe,CAAC,IAAI,CAACG,KAAK,CAAC;EACpC;EAEA,IAAIiB,MAAMA,CAAA,EAAW;IACnB,OAAOrB,cAAc,CAAC,IAAI,CAACI,KAAK,CAAC;EACnC;EAEAS,QAAQA,CAACR,UAAkB,EAAmB;IAC5C,OAAO,IAAIH,eAAe,CAAC,IAAI,CAACE,KAAK,EAAEC,UAAU,CAAC;EACpD;AAKF"}
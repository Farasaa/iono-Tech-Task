"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = EditorFactory;

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _assertThisInitialized2 = _interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _taggedTemplateLiteral2 = _interopRequireDefault(require("@babel/runtime/helpers/taggedTemplateLiteral"));

var _react = _interopRequireWildcard(require("react"));

var _reactDom = require("react-dom");

var _styledComponents = _interopRequireDefault(require("styled-components"));

var _window = _interopRequireDefault(require("global/window"));

var _classnames = _interopRequireDefault(require("classnames"));

var _lodash = _interopRequireDefault(require("lodash.get"));

var _reselect = require("reselect");

var _featureActionPanel = _interopRequireDefault(require("./feature-action-panel"));

var _constants = require("@kepler.gl/constants");

var _layers = require("@kepler.gl/layers");

var _context = require("../context");

var _templateObject;

function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = (0, _getPrototypeOf2["default"])(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2["default"])(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2["default"])(this, result); }; }

function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }

var DECKGL_RENDER_LAYER = 'default-deckgl-overlay-wrapper';

var StyledWrapper = _styledComponents["default"].div(_templateObject || (_templateObject = (0, _taggedTemplateLiteral2["default"])(["\n  position: relative;\n"])));

var editorLayerFilter = function editorLayerFilter(layer) {
  return _constants.EDITOR_AVAILABLE_LAYERS.includes(layer.type);
};

EditorFactory.deps = [_featureActionPanel["default"]];

function EditorFactory(FeatureActionPanel) {
  var PortalEditor = function PortalEditor(_ref) {
    var visiblePanel = _ref.visiblePanel,
        className = _ref.className,
        style = _ref.style,
        selectedFeature = _ref.selectedFeature,
        datasets = _ref.datasets,
        layers = _ref.layers,
        currentFilter = _ref.currentFilter,
        onClose = _ref.onClose,
        onDeleteFeature = _ref.onDeleteFeature,
        onToggleLayer = _ref.onToggleLayer,
        position = _ref.position;
    return /*#__PURE__*/_react["default"].createElement(_context.RootContext.Consumer, null, function (context) {
      var _context$current;

      return /*#__PURE__*/_react["default"].createElement(_react["default"].Fragment, null, /*#__PURE__*/(0, _reactDom.createPortal)( /*#__PURE__*/_react["default"].createElement(StyledWrapper, {
        className: (0, _classnames["default"])('editor', className),
        style: style
      }, visiblePanel ? /*#__PURE__*/_react["default"].createElement(FeatureActionPanel, {
        selectedFeature: selectedFeature,
        datasets: datasets,
        layers: layers,
        currentFilter: currentFilter,
        onClose: onClose,
        onDeleteFeature: onDeleteFeature,
        onToggleLayer: onToggleLayer,
        position: position || null
      }) : null), (_context$current = context === null || context === void 0 ? void 0 : context.current) !== null && _context$current !== void 0 ? _context$current : document.body));
    });
  };

  var EditorUnmemoized = /*#__PURE__*/function (_Component) {
    (0, _inherits2["default"])(EditorUnmemoized, _Component);

    var _super = _createSuper(EditorUnmemoized);

    function EditorUnmemoized() {
      var _this;

      (0, _classCallCheck2["default"])(this, EditorUnmemoized);

      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }

      _this = _super.call.apply(_super, [this].concat(args));
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "state", {});
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "layerSelector", function (props) {
        return props.layers;
      });
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "filterSelector", function (props) {
        return props.filters;
      });
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "selectedFeatureIdSelector", function (props) {
        return (0, _lodash["default"])(props, ['editor', 'selectedFeature', 'id']);
      });
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "editorFeatureSelector", function (props) {
        return (0, _lodash["default"])(props, ['editor', 'features']);
      });
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "currentFilterSelector", (0, _reselect.createSelector)(_this.filterSelector, _this.selectedFeatureIdSelector, function (filters, selectedFeatureId) {
        return filters.find(function (f) {
          return f.value && f.value.id === selectedFeatureId;
        });
      }));
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "availableLayersSelector", (0, _reselect.createSelector)(_this.layerSelector, function (layers) {
        return layers.filter(editorLayerFilter).filter(function (layer) {
          var _layer$config;

          return ((_layer$config = layer.config) === null || _layer$config === void 0 ? void 0 : _layer$config.isVisible) && layer.id !== _constants.GEOCODER_LAYER_ID;
        });
      }));
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "allFeaturesSelector", (0, _reselect.createSelector)(_this.filterSelector, _this.editorFeatureSelector, function (filters, editorFeatures) {
        return filters.filter(function (f) {
          return f.type === _constants.FILTER_TYPES.polygon;
        }).map(function (f) {
          return f.value;
        }).concat(editorFeatures);
      }));
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "isInFocus", function () {
        var _document$activeEleme;

        return ((_document$activeEleme = document.activeElement) === null || _document$activeEleme === void 0 ? void 0 : _document$activeEleme.id) === DECKGL_RENDER_LAYER;
      });
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "_onKeyPressed", function (event) {
        if (_this.isInFocus()) {
          switch (event.keyCode) {
            case _constants.KeyEvent.DOM_VK_DELETE:
            case _constants.KeyEvent.DOM_VK_BACK_SPACE:
              _this._onDeleteSelectedFeature();

              break;

            case _constants.KeyEvent.DOM_VK_ESCAPE:
              // reset active drawing
              if (_layers.EditorLayerUtils.isDrawingActive(true, _this.props.editor.mode)) {
                _this.props.onSetEditorMode(_constants.EDITOR_MODES.EDIT);
              }

              _this.props.onSelect(null);

              break;

            default:
              break;
          }
        }
      });
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "_onDeleteSelectedFeature", function () {
        var editor = _this.props.editor;
        var selectedFeature = editor.selectedFeature;

        if (selectedFeature) {
          _this.props.onDeleteFeature(selectedFeature);
        }
      });
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "_closeFeatureAction", function () {
        // reset selection context
        var selectedFeature = _this.props.editor.selectedFeature;

        _this.props.onSelect(selectedFeature);
      });
      (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "_togglePolygonFilter", function (layer) {
        var selectedFeature = _this.props.editor.selectedFeature;

        if (selectedFeature) {
          _this.props.onTogglePolygonFilter(layer, selectedFeature);
        }
      });
      return _this;
    }

    (0, _createClass2["default"])(EditorUnmemoized, [{
      key: "componentDidMount",
      value: function componentDidMount() {
        _window["default"].addEventListener('keydown', this._onKeyPressed);
      }
    }, {
      key: "componentWillUnmount",
      value: function componentWillUnmount() {
        _window["default"].removeEventListener('keydown', this._onKeyPressed);
      }
    }, {
      key: "render",
      value: function render() {
        var _this$props = this.props,
            className = _this$props.className,
            datasets = _this$props.datasets,
            editor = _this$props.editor,
            style = _this$props.style,
            index = _this$props.index;
        var selectedFeature = editor.selectedFeature,
            selectionContext = editor.selectionContext;
        var currentFilter = this.currentFilterSelector(this.props);
        var availableLayers = this.availableLayersSelector(this.props);

        var _ref2 = selectionContext || {},
            rightClick = _ref2.rightClick,
            position = _ref2.position,
            mapIndex = _ref2.mapIndex;

        return /*#__PURE__*/_react["default"].createElement(PortalEditor, {
          selectedFeature: selectedFeature,
          visiblePanel: Boolean(rightClick) && selectedFeature && index === mapIndex,
          datasets: datasets,
          layers: availableLayers,
          currentFilter: currentFilter,
          onClose: this._closeFeatureAction,
          onDeleteFeature: this._onDeleteSelectedFeature,
          onToggleLayer: this._togglePolygonFilter,
          position: position || null,
          className: className,
          style: style
        });
      }
    }]);
    return EditorUnmemoized;
  }(_react.Component);

  (0, _defineProperty2["default"])(EditorUnmemoized, "defaultProps", {});
  (0, _defineProperty2["default"])(EditorUnmemoized, "displayName", 'Editor');

  var Editor = /*#__PURE__*/_react["default"].memo(EditorUnmemoized);

  Editor.displayName = 'Editor';
  return Editor;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9lZGl0b3IvZWRpdG9yLnRzeCJdLCJuYW1lcyI6WyJERUNLR0xfUkVOREVSX0xBWUVSIiwiU3R5bGVkV3JhcHBlciIsInN0eWxlZCIsImRpdiIsImVkaXRvckxheWVyRmlsdGVyIiwibGF5ZXIiLCJFRElUT1JfQVZBSUxBQkxFX0xBWUVSUyIsImluY2x1ZGVzIiwidHlwZSIsIkVkaXRvckZhY3RvcnkiLCJkZXBzIiwiRmVhdHVyZUFjdGlvblBhbmVsRmFjdG9yeSIsIkZlYXR1cmVBY3Rpb25QYW5lbCIsIlBvcnRhbEVkaXRvciIsInZpc2libGVQYW5lbCIsImNsYXNzTmFtZSIsInN0eWxlIiwic2VsZWN0ZWRGZWF0dXJlIiwiZGF0YXNldHMiLCJsYXllcnMiLCJjdXJyZW50RmlsdGVyIiwib25DbG9zZSIsIm9uRGVsZXRlRmVhdHVyZSIsIm9uVG9nZ2xlTGF5ZXIiLCJwb3NpdGlvbiIsImNvbnRleHQiLCJjdXJyZW50IiwiZG9jdW1lbnQiLCJib2R5IiwiRWRpdG9yVW5tZW1vaXplZCIsInByb3BzIiwiZmlsdGVycyIsImZpbHRlclNlbGVjdG9yIiwic2VsZWN0ZWRGZWF0dXJlSWRTZWxlY3RvciIsInNlbGVjdGVkRmVhdHVyZUlkIiwiZmluZCIsImYiLCJ2YWx1ZSIsImlkIiwibGF5ZXJTZWxlY3RvciIsImZpbHRlciIsImNvbmZpZyIsImlzVmlzaWJsZSIsIkdFT0NPREVSX0xBWUVSX0lEIiwiZWRpdG9yRmVhdHVyZVNlbGVjdG9yIiwiZWRpdG9yRmVhdHVyZXMiLCJGSUxURVJfVFlQRVMiLCJwb2x5Z29uIiwibWFwIiwiY29uY2F0IiwiYWN0aXZlRWxlbWVudCIsImV2ZW50IiwiaXNJbkZvY3VzIiwia2V5Q29kZSIsIktleUV2ZW50IiwiRE9NX1ZLX0RFTEVURSIsIkRPTV9WS19CQUNLX1NQQUNFIiwiX29uRGVsZXRlU2VsZWN0ZWRGZWF0dXJlIiwiRE9NX1ZLX0VTQ0FQRSIsIkVkaXRvckxheWVyVXRpbHMiLCJpc0RyYXdpbmdBY3RpdmUiLCJlZGl0b3IiLCJtb2RlIiwib25TZXRFZGl0b3JNb2RlIiwiRURJVE9SX01PREVTIiwiRURJVCIsIm9uU2VsZWN0Iiwib25Ub2dnbGVQb2x5Z29uRmlsdGVyIiwid2luZG93IiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9vbktleVByZXNzZWQiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiaW5kZXgiLCJzZWxlY3Rpb25Db250ZXh0IiwiY3VycmVudEZpbHRlclNlbGVjdG9yIiwiYXZhaWxhYmxlTGF5ZXJzIiwiYXZhaWxhYmxlTGF5ZXJzU2VsZWN0b3IiLCJyaWdodENsaWNrIiwibWFwSW5kZXgiLCJCb29sZWFuIiwiX2Nsb3NlRmVhdHVyZUFjdGlvbiIsIl90b2dnbGVQb2x5Z29uRmlsdGVyIiwiQ29tcG9uZW50IiwiRWRpdG9yIiwiUmVhY3QiLCJtZW1vIiwiZGlzcGxheU5hbWUiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUdBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQU9BOztBQUtBOzs7Ozs7OztBQUVBLElBQU1BLG1CQUFtQixHQUFHLGdDQUE1Qjs7QUFFQSxJQUFNQyxhQUFhLEdBQUdDLDZCQUFPQyxHQUFWLCtHQUFuQjs7QUFJQSxJQUFNQyxpQkFBaUIsR0FBRyxTQUFwQkEsaUJBQW9CLENBQUNDLEtBQUQ7QUFBQSxTQUFrQkMsbUNBQXdCQyxRQUF4QixDQUFpQ0YsS0FBSyxDQUFDRyxJQUF2QyxDQUFsQjtBQUFBLENBQTFCOztBQUVBQyxhQUFhLENBQUNDLElBQWQsR0FBcUIsQ0FBQ0MsOEJBQUQsQ0FBckI7O0FBcUJlLFNBQVNGLGFBQVQsQ0FDYkcsa0JBRGEsRUFFc0I7QUFDbkMsTUFBTUMsWUFBeUMsR0FBRyxTQUE1Q0EsWUFBNEMsT0FZNUM7QUFBQSxRQVhKQyxZQVdJLFFBWEpBLFlBV0k7QUFBQSxRQVZKQyxTQVVJLFFBVkpBLFNBVUk7QUFBQSxRQVRKQyxLQVNJLFFBVEpBLEtBU0k7QUFBQSxRQVJK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QUksRUFOdEQ7QUFBQSxZQU1BSSxVQU5BLFNBTUFBLFVBTkE7QUFBQSxZQU1ZckQsUUFOWixTQU1ZQSxRQU5aO0FBQUEsWUFNc0JzRCxRQU50QixTQU1zQkEsUUFOdEI7O0FBUVAsNEJBQ0UsZ0NBQUMsWUFBRDtBQUNFLFVBQUEsZUFBZSxFQUFFN0QsZUFEbkI7QUFFRSxVQUFBLFlBQVksRUFBRThELE9BQU8sQ0FBQ0YsVUFBRCxDQUFQLElBQXVCNUQsZUFBdkIsSUFBMEN1RCxLQUFLLEtBQUtNLFFBRnBFO0FBR0UsVUFBQSxRQUFRLEVBQUU1RCxRQUhaO0FBSUUsVUFBQSxNQUFNLEVBQUV5RCxlQUpWO0FBS0UsVUFBQSxhQUFhLEVBQUV2RCxhQUxqQjtBQU1FLFVBQUEsT0FBTyxFQUFFLEtBQUs0RCxtQkFOaEI7QUFPRSxVQUFBLGVBQWUsRUFBRSxLQUFLdkIsd0JBUHhCO0FBUUUsVUFBQSxhQUFhLEVBQUUsS0FBS3dCLG9CQVJ0QjtBQVNFLFVBQUEsUUFBUSxFQUFFekQsUUFBUSxJQUFJLElBVHhCO0FBVUUsVUFBQSxTQUFTLEVBQUVULFNBVmI7QUFXRSxVQUFBLEtBQUssRUFBRUM7QUFYVCxVQURGO0FBZUQ7QUF0SmdDO0FBQUE7QUFBQSxJQXdDSmtFLGdCQXhDSTs7QUFBQSxtQ0F3QzdCckQsZ0JBeEM2QixrQkF5Q1gsRUF6Q1c7QUFBQSxtQ0F3QzdCQSxnQkF4QzZCLGlCQTJDWixRQTNDWTs7QUF5Sm5DLE1BQU1zRCxNQUFNLGdCQUFJQyxrQkFBTUMsSUFBTixDQUFXeEQsZ0JBQVgsQ0FBaEI7O0FBQ0FzRCxFQUFBQSxNQUFNLENBQUNHLFdBQVAsR0FBcUIsUUFBckI7QUFDQSxTQUFPSCxNQUFQO0FBQ0QiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogTUlUXG4vLyBDb3B5cmlnaHQgY29udHJpYnV0b3JzIHRvIHRoZSBrZXBsZXIuZ2wgcHJvamVjdFxuXG5pbXBvcnQgUmVhY3QsIHtDb21wb25lbnQsIENTU1Byb3BlcnRpZXMsIEtleWJvYXJkRXZlbnR9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7Y3JlYXRlUG9ydGFsfSBmcm9tICdyZWFjdC1kb20nO1xuaW1wb3J0IHN0eWxlZCBmcm9tICdzdHlsZWQtY29tcG9uZW50cyc7XG5pbXBvcnQgd2luZG93IGZyb20gJ2dsb2JhbC93aW5kb3cnO1xuaW1wb3J0IGNsYXNzbmFtZXMgZnJvbSAnY2xhc3NuYW1lcyc7XG5pbXBvcnQgZ2V0IGZyb20gJ2xvZGFzaC5nZXQnO1xuaW1wb3J0IHtjcmVhdGVTZWxlY3Rvcn0gZnJvbSAncmVzZWxlY3QnO1xuaW1wb3J0IEZlYXR1cmVBY3Rpb25QYW5lbEZhY3RvcnksIHtGZWF0dXJlQWN0aW9uUGFuZWxQcm9wc30gZnJvbSAnLi9mZWF0dXJlLWFjdGlvbi1wYW5lbCc7XG5pbXBvcnQge1xuICBFRElUT1JfQVZBSUxBQkxFX0xBWUVSUyxcbiAgRklMVEVSX1RZUEVTLFxuICBFRElUT1JfTU9ERVMsXG4gIEdFT0NPREVSX0xBWUVSX0lELFxuICBLZXlFdmVudFxufSBmcm9tICdAa2VwbGVyLmdsL2NvbnN0YW50cyc7XG5pbXBvcnQge0xheWVyLCBFZGl0b3JMYXllclV0aWxzfSBmcm9tICdAa2VwbGVyLmdsL2xheWVycyc7XG5pbXBvcnQge0ZpbHRlciwgRmVhdHVyZVNlbGVjdGlvbkNvbnRleHQsIEZlYXR1cmV9IGZyb20gJ0BrZXBsZXIuZ2wvdHlwZXMnO1xuaW1wb3J0IHtGZWF0dXJlT2YsIFBvbHlnb259IGZyb20gJ0BuZWJ1bGEuZ2wvZWRpdC1tb2Rlcyc7XG5pbXBvcnQge0RhdGFzZXRzfSBmcm9tICdAa2VwbGVyLmdsL3RhYmxlJztcblxuaW1wb3J0IHtSb290Q29udGV4dH0gZnJvbSAnLi4vY29udGV4dCc7XG5cbmNvbnN0IERFQ0tHTF9SRU5ERVJfTEFZRVIgPSAnZGVmYXVsdC1kZWNrZ2wtb3ZlcmxheS13cmFwcGVyJztcblxuY29uc3QgU3R5bGVkV3JhcHBlciA9IHN0eWxlZC5kaXZgXG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcbmA7XG5cbmNvbnN0IGVkaXRvckxheWVyRmlsdGVyID0gKGxheWVyOiBMYXllcikgPT4gRURJVE9SX0FWQUlMQUJMRV9MQVlFUlMuaW5jbHVkZXMobGF5ZXIudHlwZSEpO1xuXG5FZGl0b3JGYWN0b3J5LmRlcHMgPSBbRmVhdHVyZUFjdGlvblBhbmVsRmFjdG9yeV07XG5cbmludGVyZmFjZSBFZGl0b3JQcm9wcyB7XG4gIGZpbHRlcnM6IEZpbHRlcltdO1xuICBsYXllcnM6IExheWVyW107XG4gIGRhdGFzZXRzOiBEYXRhc2V0cztcbiAgZWRpdG9yOiB7c2VsZWN0ZWRGZWF0dXJlOiBGZWF0dXJlOyBtb2RlOiBzdHJpbmc7IHNlbGVjdGlvbkNvbnRleHQ/OiBGZWF0dXJlU2VsZWN0aW9uQ29udGV4dH07XG4gIGluZGV4OiBudW1iZXI7XG4gIGNsYXNzTmFtZT86IHN0cmluZztcbiAgc3R5bGU6IENTU1Byb3BlcnRpZXM7XG4gIG9uU2VsZWN0OiAoZjogRmVhdHVyZSB8IG51bGwpID0+IGFueTtcbiAgb25TZXRFZGl0b3JNb2RlOiAobTogYW55KSA9PiB2b2lkO1xuICBvbkRlbGV0ZUZlYXR1cmU6IChmOiBGZWF0dXJlKSA9PiBhbnk7XG4gIG9uVG9nZ2xlUG9seWdvbkZpbHRlcjogKGw6IExheWVyLCBmOiBGZWF0dXJlKSA9PiBhbnk7XG59XG5cbmV4cG9ydCB0eXBlIFBvcnRhbEVkaXRvclByb3BzID0gRmVhdHVyZUFjdGlvblBhbmVsUHJvcHMgJiB7XG4gIHZpc2libGVQYW5lbDogYm9vbGVhbjtcbiAgc3R5bGU/OiBSZWFjdC5DU1NQcm9wZXJ0aWVzO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gRWRpdG9yRmFjdG9yeShcbiAgRmVhdHVyZUFjdGlvblBhbmVsOiBSZWFjdC5GQzxGZWF0dXJlQWN0aW9uUGFuZWxQcm9wcz5cbik6IFJlYWN0LkNvbXBvbmVudENsYXNzPEVkaXRvclByb3BzPiB7XG4gIGNvbnN0IFBvcnRhbEVkaXRvcjogUmVhY3QuRkM8UG9ydGFsRWRpdG9yUHJvcHM+ID0gKHtcbiAgICB2aXNpYmxlUGFuZWwsXG4gICAgY2xhc3NOYW1lLFxuICAgIHN0eWxlLFxuICAgIHNlbGVjdGVkRmVhdHVyZSxcbiAgICBkYXRhc2V0cyxcbiAgICBsYXllcnMsXG4gICAgY3VycmVudEZpbHRlcixcbiAgICBvbkNsb3NlLFxuICAgIG9uRGVsZXRlRmVhdHVyZSxcbiAgICBvblRvZ2dsZUxheWVyLFxuICAgIHBvc2l0aW9uXG4gIH0pID0+IHtcbiAgICByZXR1cm4gKFxuICAgICAgPFJvb3RDb250ZXh0LkNvbnN1bWVyPlxuICAgICAgICB7Y29udGV4dCA9PiAoXG4gICAgICAgICAgPD5cbiAgICAgICAgICAgIHtjcmVhdGVQb3J0YWwoXG4gICAgICAgICAgICAgIDxTdHlsZWRXcmFwcGVyIGNsYXNzTmFtZT17Y2xhc3NuYW1lcygnZWRpdG9yJywgY2xhc3NOYW1lKX0gc3R5bGU9e3N0eWxlfT5cbiAgICAgICAgICAgICAgICB7dmlzaWJsZVBhbmVsID8gKFxuICAgICAgICAgICAgICAgICAgPEZlYXR1cmVBY3Rpb25QYW5lbFxuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZEZlYXR1cmU9e3NlbGVjdGVkRmVhdHVyZSBhcyBGZWF0dXJlT2Y8UG9seWdvbj59XG4gICAgICAgICAgICAgICAgICAgIGRhdGFzZXRzPXtkYXRhc2V0c31cbiAgICAgICAgICAgICAgICAgICAgbGF5ZXJzPXtsYXllcnN9XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRGaWx0ZXI9e2N1cnJlbnRGaWx0ZXJ9XG4gICAgICAgICAgICAgICAgICAgIG9uQ2xvc2U9e29uQ2xvc2V9XG4gICAgICAgICAgICAgICAgICAgIG9uRGVsZXRlRmVhdHVyZT17b25EZWxldGVGZWF0dXJlfVxuICAgICAgICAgICAgICAgICAgICBvblRvZ2dsZUxheWVyPXtvblRvZ2dsZUxheWVyfVxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbj17cG9zaXRpb24gfHwgbnVsbH1cbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgKSA6IG51bGx9XG4gICAgICAgICAgICAgIDwvU3R5bGVkV3JhcHBlcj4sXG4gICAgICAgICAgICAgIGNvbnRleHQ/LmN1cnJlbnQgPz8gZG9jdW1lbnQuYm9keVxuICAgICAgICAgICAgKX1cbiAgICAgICAgICA8Lz5cbiAgICAgICAgKX1cbiAgICAgIDwvUm9vdENvbnRleHQuQ29uc3VtZXI+XG4gICAgKTtcbiAgfTtcbiAgY2xhc3MgRWRpdG9yVW5tZW1vaXplZCBleHRlbmRzIENvbXBvbmVudDxFZGl0b3JQcm9wcz4ge1xuICAgIHN0YXRpYyBkZWZhdWx0UHJvcHMgPSB7fTtcblxuICAgIHN0YXRpYyBkaXNwbGF5TmFtZSA9ICdFZGl0b3InO1xuXG4gICAgc3RhdGUgPSB7fTtcblxuICAgIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9vbktleVByZXNzZWQpO1xuICAgIH1cblxuICAgIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9vbktleVByZXNzZWQpO1xuICAgIH1cblxuICAgIGxheWVyU2VsZWN0b3IgPSAocHJvcHM6IEVkaXRvclByb3BzKSA9PiBwcm9wcy5sYXllcnM7XG4gICAgZmlsdGVyU2VsZWN0b3IgPSAocHJvcHM6IEVkaXRvclByb3BzKSA9PiBwcm9wcy5maWx0ZXJzO1xuICAgIHNlbGVjdGVkRmVhdHVyZUlkU2VsZWN0b3IgPSAocHJvcHM6IEVkaXRvclByb3BzKSA9PlxuICAgICAgZ2V0KHByb3BzLCBbJ2VkaXRvcicsICdzZWxlY3RlZEZlYXR1cmUnLCAnaWQnXSk7XG4gICAgZWRpdG9yRmVhdHVyZVNlbGVjdG9yID0gKHByb3BzOiBFZGl0b3JQcm9wcykgPT4gZ2V0KHByb3BzLCBbJ2VkaXRvcicsICdmZWF0dXJlcyddKTtcblxuICAgIGN1cnJlbnRGaWx0ZXJTZWxlY3RvciA9IGNyZWF0ZVNlbGVjdG9yKFxuICAgICAgdGhpcy5maWx0ZXJTZWxlY3RvcixcbiAgICAgIHRoaXMuc2VsZWN0ZWRGZWF0dXJlSWRTZWxlY3RvcixcbiAgICAgIChmaWx0ZXJzLCBzZWxlY3RlZEZlYXR1cmVJZCkgPT4gZmlsdGVycy5maW5kKGYgPT4gZi52YWx1ZSAmJiBmLnZhbHVlLmlkID09PSBzZWxlY3RlZEZlYXR1cmVJZClcbiAgICApO1xuXG4gICAgYXZhaWxhYmxlTGF5ZXJzU2VsZWN0b3IgPSBjcmVhdGVTZWxlY3Rvcih0aGlzLmxheWVyU2VsZWN0b3IsIGxheWVycyA9PlxuICAgICAgbGF5ZXJzXG4gICAgICAgIC5maWx0ZXIoZWRpdG9yTGF5ZXJGaWx0ZXIpXG4gICAgICAgIC5maWx0ZXIobGF5ZXIgPT4gbGF5ZXIuY29uZmlnPy5pc1Zpc2libGUgJiYgbGF5ZXIuaWQgIT09IEdFT0NPREVSX0xBWUVSX0lEKVxuICAgICk7XG5cbiAgICBhbGxGZWF0dXJlc1NlbGVjdG9yID0gY3JlYXRlU2VsZWN0b3IoXG4gICAgICB0aGlzLmZpbHRlclNlbGVjdG9yLFxuICAgICAgdGhpcy5lZGl0b3JGZWF0dXJlU2VsZWN0b3IsXG4gICAgICAoZmlsdGVycywgZWRpdG9yRmVhdHVyZXMpID0+XG4gICAgICAgIGZpbHRlcnNcbiAgICAgICAgICAuZmlsdGVyKGYgPT4gZi50eXBlID09PSBGSUxURVJfVFlQRVMucG9seWdvbilcbiAgICAgICAgICAubWFwKGYgPT4gZi52YWx1ZSlcbiAgICAgICAgICAuY29uY2F0KGVkaXRvckZlYXR1cmVzKVxuICAgICk7XG5cbiAgICBpc0luRm9jdXMgPSAoKSA9PiBkb2N1bWVudC5hY3RpdmVFbGVtZW50Py5pZCA9PT0gREVDS0dMX1JFTkRFUl9MQVlFUjtcblxuICAgIF9vbktleVByZXNzZWQgPSAoZXZlbnQ6IEtleWJvYXJkRXZlbnQpID0+IHtcbiAgICAgIGlmICh0aGlzLmlzSW5Gb2N1cygpKSB7XG4gICAgICAgIHN3aXRjaCAoZXZlbnQua2V5Q29kZSkge1xuICAgICAgICAgIGNhc2UgS2V5RXZlbnQuRE9NX1ZLX0RFTEVURTpcbiAgICAgICAgICBjYXNlIEtleUV2ZW50LkRPTV9WS19CQUNLX1NQQUNFOlxuICAgICAgICAgICAgdGhpcy5fb25EZWxldGVTZWxlY3RlZEZlYXR1cmUoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgS2V5RXZlbnQuRE9NX1ZLX0VTQ0FQRTpcbiAgICAgICAgICAgIC8vIHJlc2V0IGFjdGl2ZSBkcmF3aW5nXG4gICAgICAgICAgICBpZiAoRWRpdG9yTGF5ZXJVdGlscy5pc0RyYXdpbmdBY3RpdmUodHJ1ZSwgdGhpcy5wcm9wcy5lZGl0b3IubW9kZSkpIHtcbiAgICAgICAgICAgICAgdGhpcy5wcm9wcy5vblNldEVkaXRvck1vZGUoRURJVE9SX01PREVTLkVESVQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLnByb3BzLm9uU2VsZWN0KG51bGwpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcblxuICAgIF9vbkRlbGV0ZVNlbGVjdGVkRmVhdHVyZSA9ICgpID0+IHtcbiAgICAgIGNvbnN0IHtlZGl0b3J9ID0gdGhpcy5wcm9wcztcbiAgICAgIGNvbnN0IHtzZWxlY3RlZEZlYXR1cmV9ID0gZWRpdG9yO1xuICAgICAgaWYgKHNlbGVjdGVkRmVhdHVyZSkge1xuICAgICAgICB0aGlzLnByb3BzLm9uRGVsZXRlRmVhdHVyZShzZWxlY3RlZEZlYXR1cmUpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBfY2xvc2VGZWF0dXJlQWN0aW9uID0gKCkgPT4ge1xuICAgICAgLy8gcmVzZXQgc2VsZWN0aW9uIGNvbnRleHRcbiAgICAgIGNvbnN0IHtzZWxlY3RlZEZlYXR1cmV9ID0gdGhpcy5wcm9wcy5lZGl0b3I7XG4gICAgICB0aGlzLnByb3BzLm9uU2VsZWN0KHNlbGVjdGVkRmVhdHVyZSk7XG4gICAgfTtcblxuICAgIF90b2dnbGVQb2x5Z29uRmlsdGVyID0gKGxheWVyOiBMYXllcikgPT4ge1xuICAgICAgY29uc3Qge3NlbGVjdGVkRmVhdHVyZX0gPSB0aGlzLnByb3BzLmVkaXRvcjtcbiAgICAgIGlmIChzZWxlY3RlZEZlYXR1cmUpIHtcbiAgICAgICAgdGhpcy5wcm9wcy5vblRvZ2dsZVBvbHlnb25GaWx0ZXIobGF5ZXIsIHNlbGVjdGVkRmVhdHVyZSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIHJlbmRlcigpIHtcbiAgICAgIGNvbnN0IHtjbGFzc05hbWUsIGRhdGFzZXRzLCBlZGl0b3IsIHN0eWxlLCBpbmRleH0gPSB0aGlzLnByb3BzO1xuICAgICAgY29uc3Qge3NlbGVjdGVkRmVhdHVyZSwgc2VsZWN0aW9uQ29udGV4dH0gPSBlZGl0b3I7XG4gICAgICBjb25zdCBjdXJyZW50RmlsdGVyID0gdGhpcy5jdXJyZW50RmlsdGVyU2VsZWN0b3IodGhpcy5wcm9wcyk7XG4gICAgICBjb25zdCBhdmFpbGFibGVMYXllcnMgPSB0aGlzLmF2YWlsYWJsZUxheWVyc1NlbGVjdG9yKHRoaXMucHJvcHMpO1xuXG4gICAgICBjb25zdCB7cmlnaHRDbGljaywgcG9zaXRpb24sIG1hcEluZGV4fSA9IHNlbGVjdGlvbkNvbnRleHQgfHwge307XG5cbiAgICAgIHJldHVybiAoXG4gICAgICAgIDxQb3J0YWxFZGl0b3JcbiAgICAgICAgICBzZWxlY3RlZEZlYXR1cmU9e3NlbGVjdGVkRmVhdHVyZSBhcyBGZWF0dXJlT2Y8UG9seWdvbj59XG4gICAgICAgICAgdmlzaWJsZVBhbmVsPXtCb29sZWFuKHJpZ2h0Q2xpY2spICYmIHNlbGVjdGVkRmVhdHVyZSAmJiBpbmRleCA9PT0gbWFwSW5kZXh9XG4gICAgICAgICAgZGF0YXNldHM9e2RhdGFzZXRzfVxuICAgICAgICAgIGxheWVycz17YXZhaWxhYmxlTGF5ZXJzfVxuICAgICAgICAgIGN1cnJlbnRGaWx0ZXI9e2N1cnJlbnRGaWx0ZXJ9XG4gICAgICAgICAgb25DbG9zZT17dGhpcy5fY2xvc2VGZWF0dXJlQWN0aW9ufVxuICAgICAgICAgIG9uRGVsZXRlRmVhdHVyZT17dGhpcy5fb25EZWxldGVTZWxlY3RlZEZlYXR1cmV9XG4gICAgICAgICAgb25Ub2dnbGVMYXllcj17dGhpcy5fdG9nZ2xlUG9seWdvbkZpbHRlcn1cbiAgICAgICAgICBwb3NpdGlvbj17cG9zaXRpb24gfHwgbnVsbH1cbiAgICAgICAgICBjbGFzc05hbWU9e2NsYXNzTmFtZX1cbiAgICAgICAgICBzdHlsZT17c3R5bGV9XG4gICAgICAgIC8+XG4gICAgICApO1xuICAgIH1cbiAgfVxuXG4gIGNvbnN0IEVkaXRvciA9IChSZWFjdC5tZW1vKEVkaXRvclVubWVtb2l6ZWQpIGFzIHVua25vd24pIGFzIHR5cGVvZiBFZGl0b3JVbm1lbW9pemVkO1xuICBFZGl0b3IuZGlzcGxheU5hbWUgPSAnRWRpdG9yJztcbiAgcmV0dXJuIEVkaXRvcjtcbn1cbiJdfQ==
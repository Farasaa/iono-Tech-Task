"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));

var _objectWithoutProperties2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));

var _taggedTemplateLiteral2 = _interopRequireDefault(require("@babel/runtime/helpers/taggedTemplateLiteral"));

var _styledComponents = _interopRequireDefault(require("styled-components"));

var _react = _interopRequireWildcard(require("react"));

var _ = require("../");

var _react2 = _interopRequireDefault(require("@tippyjs/react"));

var _templateObject, _templateObject2;

var TippyArrow = _styledComponents["default"].div(_templateObject || (_templateObject = (0, _taggedTemplateLiteral2["default"])(["\n  position: absolute;\n  width: 15px;\n  height: 15px;\n  fill: ", ";\n  text-align: initial;\n\n  > svg {\n    position: absolute;\n  }\n"])), function (props) {
  return props.theme.tooltipBg;
});

var TippyTooltipContent = (0, _styledComponents["default"])(function (_ref) {
  var children = _ref.children,
      arrow = _ref.arrow,
      isLightTheme = _ref.isLightTheme,
      props = (0, _objectWithoutProperties2["default"])(_ref, ["children", "arrow", "isLightTheme"]);
  return /*#__PURE__*/_react["default"].createElement("div", props, children, arrow ? /*#__PURE__*/_react["default"].createElement(TippyArrow, {
    className: "svg-arrow",
    "data-popper-arrow": ""
  }, /*#__PURE__*/_react["default"].createElement("svg", {
    width: 15,
    height: 15
  }, /*#__PURE__*/_react["default"].createElement("path", {
    d: "M2,7.5 7.5,2 13,7.5Z"
  }))) : null);
})(_templateObject2 || (_templateObject2 = (0, _taggedTemplateLiteral2["default"])(["\n  font-family: ", ";\n  font-size: ", ";\n  font-weight: 400;\n  padding: 7px 18px;\n  box-shadow: ", ";\n  background-color: ", ";\n  color: ", ";\n  border-radius: ", ";\n  ", "\n"])), function (props) {
  return props.theme.fontFamily;
}, function (props) {
  return props.theme.tooltipFontSize;
}, function (props) {
  return props.isLightTheme ? props.theme.panelBoxShadow : props.theme.tooltipBoxShadow;
}, function (props) {
  return props.isLightTheme ? props.theme.tooltipBgLT : props.theme.tooltipBg;
}, function (props) {
  return props.isLightTheme ? props.theme.tooltipColorLT : props.theme.tooltipColor;
}, function (props) {
  return props.theme.primaryBtnRadius;
}, function (props) {
  return props.arrow ? "\n    &[data-placement^='top'] > .svg-arrow {\n      bottom: 0;\n      &::after,\n      > svg {\n        top: 7px;\n        transform: rotate(180deg);\n      }\n    }\n\n    &[data-placement^='bottom'] > .svg-arrow {\n      top: 0;\n      > svg {\n        bottom: 7px;\n      }\n    }\n\n    &[data-placement^='left'] > .svg-arrow {\n      right: 0;\n      &::after,\n      > svg {\n        transform: rotate(90deg);\n        left: 7px;\n      }\n    }\n\n    &[data-placement^='right'] > .svg-arrow {\n      left: 0;\n      &::after,\n      > svg {\n        transform: rotate(-90deg);\n        right: 7px;\n      }\n    }\n  " : '';
});

var TippyTooltip = function TippyTooltip(_ref2) {
  var children = _ref2.children,
      _render = _ref2.render,
      _ref2$duration = _ref2.duration,
      duration = _ref2$duration === void 0 ? 200 : _ref2$duration,
      _ref2$arrow = _ref2.arrow,
      arrow = _ref2$arrow === void 0 ? true : _ref2$arrow,
      _ref2$isLightTheme = _ref2.isLightTheme,
      isLightTheme = _ref2$isLightTheme === void 0 ? false : _ref2$isLightTheme,
      className = _ref2.className,
      rest = (0, _objectWithoutProperties2["default"])(_ref2, ["children", "render", "duration", "arrow", "isLightTheme", "className"]);

  var _useState = (0, _react.useState)(0),
      _useState2 = (0, _slicedToArray2["default"])(_useState, 2),
      opacity = _useState2[0],
      setOpacity = _useState2[1];

  var _useState3 = (0, _react.useState)(null),
      _useState4 = (0, _slicedToArray2["default"])(_useState3, 2),
      timer = _useState4[0],
      setTimer = _useState4[1];

  function onMount() {
    setOpacity(1);

    if (timer) {
      // @ts-ignore
      clearTimeout(timer);
    }
  }

  function onHide(instance) {
    var unmount = instance.unmount;
    var timeout = setTimeout(function () {
      var _instance$state;

      if (!((_instance$state = instance.state) !== null && _instance$state !== void 0 && _instance$state.isDestroyed)) {
        unmount();
      }
    }, duration[0] || duration); // @ts-ignore

    setTimer(timeout);
    setOpacity(0);
  }

  return /*#__PURE__*/_react["default"].createElement(_.RootContext.Consumer, null, function (context) {
    return /*#__PURE__*/_react["default"].createElement(_react2["default"], (0, _extends2["default"])({}, rest, {
      // Using document.body would result in the CSS styles not being applied
      // to the tooltip content when embedding the map widget as a Shadow DOM element.
      appendTo: (context === null || context === void 0 ? void 0 : context.current) || 'parent',
      animation: true,
      render: function render(attrs) {
        return /*#__PURE__*/_react["default"].createElement(TippyTooltipContent, (0, _extends2["default"])({}, attrs, {
          className: className,
          style: {
            opacity: opacity,
            transition: "opacity ".concat(duration, "ms")
          },
          arrow: arrow,
          isLightTheme: isLightTheme
        }), _render === null || _render === void 0 ? void 0 : _render(attrs));
      },
      onMount: onMount,
      onHide: onHide
    }), children);
  });
};

var _default = TippyTooltip;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9jb21tb24vdGlwcHktdG9vbHRpcC50c3giXSwibmFtZXMiOlsiVGlwcHlBcnJvdyIsInN0eWxlZCIsImRpdiIsInByb3BzIiwidGhlbWUiLCJ0b29sdGlwQmciLCJUaXBweVRvb2x0aXBDb250ZW50IiwiY2hpbGRyZW4iLCJhcnJvdyIsImlzTGlnaHRUaGVtZSIsImZvbnRGYW1pbHkiLCJ0b29sdGlwRm9udFNpemUiLCJwYW5lbEJveFNoYWRvdyIsInRvb2x0aXBCb3hTaGFkb3ciLCJ0b29sdGlwQmdMVCIsInRvb2x0aXBDb2xvckxUIiwidG9vbHRpcENvbG9yIiwicHJpbWFyeUJ0blJhZGl1cyIsIlRpcHB5VG9vbHRpcCIsInJlbmRlciIsImR1cmF0aW9uIiwiY2xhc3NOYW1lIiwicmVzdCIsIm9wYWNpdHkiLCJzZXRPcGFjaXR5IiwidGltZXIiLCJzZXRUaW1lciIsIm9uTW91bnQiLCJjbGVhclRpbWVvdXQiLCJvbkhpZGUiLCJpbnN0YW5jZSIsInVubW91bnQiLCJ0aW1lb3V0Iiwic2V0VGltZW91dCIsInN0YXRlIiwiaXNEZXN0cm95ZWQiLCJjb250ZXh0IiwiY3VycmVudCIsImF0dHJzIiwidHJhbnNpdGlvbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUdBOztBQUNBOztBQUNBOztBQUNBOzs7O0FBRUEsSUFBTUEsVUFBVSxHQUFHQyw2QkFBT0MsR0FBVixtT0FJTixVQUFBQyxLQUFLO0FBQUEsU0FBSUEsS0FBSyxDQUFDQyxLQUFOLENBQVlDLFNBQWhCO0FBQUEsQ0FKQyxDQUFoQjs7QUFZQSxJQUFNQyxtQkFBbUIsR0FBRyxrQ0FBTztBQUFBLE1BQUVDLFFBQUYsUUFBRUEsUUFBRjtBQUFBLE1BQVlDLEtBQVosUUFBWUEsS0FBWjtBQUFBLE1BQW1CQyxZQUFuQixRQUFtQkEsWUFBbkI7QUFBQSxNQUFvQ04sS0FBcEM7QUFBQSxzQkFDakMsdUNBQVNBLEtBQVQsRUFDR0ksUUFESCxFQUVHQyxLQUFLLGdCQUNK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VUFBQVksT0FBTztBQUFBLHdCQUNOLGdDQUFDLGtCQUFELGdDQUNNZCxJQUROO0FBRUU7QUFDQTtBQUNBLE1BQUEsUUFBUSxFQUFFLENBQUFjLE9BQU8sU0FBUCxJQUFBQSxPQUFPLFdBQVAsWUFBQUEsT0FBTyxDQUFFQyxPQUFULEtBQW9CLFFBSmhDO0FBS0UsTUFBQSxTQUFTLEVBQUUsSUFMYjtBQU1FLE1BQUEsTUFBTSxFQUFFLGdCQUFBQyxLQUFLO0FBQUEsNEJBQ1gsZ0NBQUMsbUJBQUQsZ0NBQ01BLEtBRE47QUFFRSxVQUFBLFNBQVMsRUFBRWpCLFNBRmI7QUFHRSxVQUFBLEtBQUssRUFBRTtBQUFDRSxZQUFBQSxPQUFPLEVBQVBBLE9BQUQ7QUFBVWdCLFlBQUFBLFVBQVUsb0JBQWFuQixRQUFiO0FBQXBCLFdBSFQ7QUFJRSxVQUFBLEtBQUssRUFBRVosS0FKVDtBQUtFLFVBQUEsWUFBWSxFQUFFQztBQUxoQixZQU9HVSxPQVBILGFBT0dBLE9BUEgsdUJBT0dBLE9BQU0sQ0FBR21CLEtBQUgsQ0FQVCxDQURXO0FBQUEsT0FOZjtBQWlCRSxNQUFBLE9BQU8sRUFBRVgsT0FqQlg7QUFrQkUsTUFBQSxNQUFNLEVBQUVFO0FBbEJWLFFBb0JHdEIsUUFwQkgsQ0FETTtBQUFBLEdBRFYsQ0FERjtBQTRCRCxDQTNERDs7ZUE2RGVXLFkiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogTUlUXG4vLyBDb3B5cmlnaHQgY29udHJpYnV0b3JzIHRvIHRoZSBrZXBsZXIuZ2wgcHJvamVjdFxuXG5pbXBvcnQgc3R5bGVkIGZyb20gJ3N0eWxlZC1jb21wb25lbnRzJztcbmltcG9ydCBSZWFjdCwge3VzZVN0YXRlfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQge1Jvb3RDb250ZXh0fSBmcm9tICcuLi8nO1xuaW1wb3J0IFRpcHB5LCB7VGlwcHlQcm9wc30gZnJvbSAnQHRpcHB5anMvcmVhY3QnO1xuXG5jb25zdCBUaXBweUFycm93ID0gc3R5bGVkLmRpdmBcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICB3aWR0aDogMTVweDtcbiAgaGVpZ2h0OiAxNXB4O1xuICBmaWxsOiAke3Byb3BzID0+IHByb3BzLnRoZW1lLnRvb2x0aXBCZ307XG4gIHRleHQtYWxpZ246IGluaXRpYWw7XG5cbiAgPiBzdmcge1xuICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgfVxuYDtcblxuY29uc3QgVGlwcHlUb29sdGlwQ29udGVudCA9IHN0eWxlZCgoe2NoaWxkcmVuLCBhcnJvdywgaXNMaWdodFRoZW1lLCAuLi5wcm9wc30pID0+IChcbiAgPGRpdiB7Li4ucHJvcHN9PlxuICAgIHtjaGlsZHJlbn1cbiAgICB7YXJyb3cgPyAoXG4gICAgICA8VGlwcHlBcnJvdyBjbGFzc05hbWU9XCJzdmctYXJyb3dcIiBkYXRhLXBvcHBlci1hcnJvdz1cIlwiPlxuICAgICAgICA8c3ZnIHdpZHRoPXsxNX0gaGVpZ2h0PXsxNX0+XG4gICAgICAgICAgPHBhdGggZD1cIk0yLDcuNSA3LjUsMiAxMyw3LjVaXCIgLz5cbiAgICAgICAgPC9zdmc+XG4gICAgICA8L1RpcHB5QXJyb3c+XG4gICAgKSA6IG51bGx9XG4gIDwvZGl2PlxuKSlgXG4gIGZvbnQtZmFtaWx5OiAke3Byb3BzID0+IHByb3BzLnRoZW1lLmZvbnRGYW1pbHl9O1xuICBmb250LXNpemU6ICR7cHJvcHMgPT4gcHJvcHMudGhlbWUudG9vbHRpcEZvbnRTaXplfTtcbiAgZm9udC13ZWlnaHQ6IDQwMDtcbiAgcGFkZGluZzogN3B4IDE4cHg7XG4gIGJveC1zaGFkb3c6ICR7cHJvcHMgPT5cbiAgICBwcm9wcy5pc0xpZ2h0VGhlbWUgPyBwcm9wcy50aGVtZS5wYW5lbEJveFNoYWRvdyA6IHByb3BzLnRoZW1lLnRvb2x0aXBCb3hTaGFkb3d9O1xuICBiYWNrZ3JvdW5kLWNvbG9yOiAke3Byb3BzID0+XG4gICAgcHJvcHMuaXNMaWdodFRoZW1lID8gcHJvcHMudGhlbWUudG9vbHRpcEJnTFQgOiBwcm9wcy50aGVtZS50b29sdGlwQmd9O1xuICBjb2xvcjogJHtwcm9wcyA9PiAocHJvcHMuaXNMaWdodFRoZW1lID8gcHJvcHMudGhlbWUudG9vbHRpcENvbG9yTFQgOiBwcm9wcy50aGVtZS50b29sdGlwQ29sb3IpfTtcbiAgYm9yZGVyLXJhZGl1czogJHtwcm9wcyA9PiBwcm9wcy50aGVtZS5wcmltYXJ5QnRuUmFkaXVzfTtcbiAgJHtwcm9wcyA9PlxuICAgIHByb3BzLmFycm93XG4gICAgICA/IGBcbiAgICAmW2RhdGEtcGxhY2VtZW50Xj0ndG9wJ10gPiAuc3ZnLWFycm93IHtcbiAgICAgIGJvdHRvbTogMDtcbiAgICAgICY6OmFmdGVyLFxuICAgICAgPiBzdmcge1xuICAgICAgICB0b3A6IDdweDtcbiAgICAgICAgdHJhbnNmb3JtOiByb3RhdGUoMTgwZGVnKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAmW2RhdGEtcGxhY2VtZW50Xj0nYm90dG9tJ10gPiAuc3ZnLWFycm93IHtcbiAgICAgIHRvcDogMDtcbiAgICAgID4gc3ZnIHtcbiAgICAgICAgYm90dG9tOiA3cHg7XG4gICAgICB9XG4gICAgfVxuXG4gICAgJltkYXRhLXBsYWNlbWVudF49J2xlZnQnXSA+IC5zdmctYXJyb3cge1xuICAgICAgcmlnaHQ6IDA7XG4gICAgICAmOjphZnRlcixcbiAgICAgID4gc3ZnIHtcbiAgICAgICAgdHJhbnNmb3JtOiByb3RhdGUoOTBkZWcpO1xuICAgICAgICBsZWZ0OiA3cHg7XG4gICAgICB9XG4gICAgfVxuXG4gICAgJltkYXRhLXBsYWNlbWVudF49J3JpZ2h0J10gPiAuc3ZnLWFycm93IHtcbiAgICAgIGxlZnQ6IDA7XG4gICAgICAmOjphZnRlcixcbiAgICAgID4gc3ZnIHtcbiAgICAgICAgdHJhbnNmb3JtOiByb3RhdGUoLTkwZGVnKTtcbiAgICAgICAgcmlnaHQ6IDdweDtcbiAgICAgIH1cbiAgICB9XG4gIGBcbiAgICAgIDogJyd9XG5gO1xuXG5jb25zdCBUaXBweVRvb2x0aXAgPSAoe1xuICBjaGlsZHJlbixcbiAgcmVuZGVyLFxuICBkdXJhdGlvbiA9IDIwMCxcbiAgYXJyb3cgPSB0cnVlLFxuICBpc0xpZ2h0VGhlbWUgPSBmYWxzZSxcbiAgY2xhc3NOYW1lLFxuICAuLi5yZXN0XG59OiBUaXBweVByb3BzICYge2lzTGlnaHRUaGVtZT86IGJvb2xlYW59KSA9PiB7XG4gIGNvbnN0IFtvcGFjaXR5LCBzZXRPcGFjaXR5XSA9IHVzZVN0YXRlKDApO1xuICBjb25zdCBbdGltZXIsIHNldFRpbWVyXSA9IHVzZVN0YXRlKG51bGwpO1xuICBmdW5jdGlvbiBvbk1vdW50KCkge1xuICAgIHNldE9wYWNpdHkoMSk7XG4gICAgaWYgKHRpbWVyKSB7XG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICBjbGVhclRpbWVvdXQodGltZXIpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIG9uSGlkZShpbnN0YW5jZSkge1xuICAgIGNvbnN0IHt1bm1vdW50fSA9IGluc3RhbmNlO1xuICAgIGNvbnN0IHRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIGlmICghaW5zdGFuY2Uuc3RhdGU/LmlzRGVzdHJveWVkKSB7XG4gICAgICAgIHVubW91bnQoKTtcbiAgICAgIH1cbiAgICB9LCBkdXJhdGlvblswXSB8fCBkdXJhdGlvbik7XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIHNldFRpbWVyKHRpbWVvdXQpO1xuICAgIHNldE9wYWNpdHkoMCk7XG4gIH1cblxuICByZXR1cm4gKFxuICAgIDxSb290Q29udGV4dC5Db25zdW1lcj5cbiAgICAgIHtjb250ZXh0ID0+IChcbiAgICAgICAgPFRpcHB5XG4gICAgICAgICAgey4uLnJlc3R9XG4gICAgICAgICAgLy8gVXNpbmcgZG9jdW1lbnQuYm9keSB3b3VsZCByZXN1bHQgaW4gdGhlIENTUyBzdHlsZXMgbm90IGJlaW5nIGFwcGxpZWRcbiAgICAgICAgICAvLyB0byB0aGUgdG9vbHRpcCBjb250ZW50IHdoZW4gZW1iZWRkaW5nIHRoZSBtYXAgd2lkZ2V0IGFzIGEgU2hhZG93IERPTSBlbGVtZW50LlxuICAgICAgICAgIGFwcGVuZFRvPXtjb250ZXh0Py5jdXJyZW50IHx8ICdwYXJlbnQnfVxuICAgICAgICAgIGFuaW1hdGlvbj17dHJ1ZX1cbiAgICAgICAgICByZW5kZXI9e2F0dHJzID0+IChcbiAgICAgICAgICAgIDxUaXBweVRvb2x0aXBDb250ZW50XG4gICAgICAgICAgICAgIHsuLi5hdHRyc31cbiAgICAgICAgICAgICAgY2xhc3NOYW1lPXtjbGFzc05hbWV9XG4gICAgICAgICAgICAgIHN0eWxlPXt7b3BhY2l0eSwgdHJhbnNpdGlvbjogYG9wYWNpdHkgJHtkdXJhdGlvbn1tc2B9fVxuICAgICAgICAgICAgICBhcnJvdz17YXJyb3d9XG4gICAgICAgICAgICAgIGlzTGlnaHRUaGVtZT17aXNMaWdodFRoZW1lfVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICB7cmVuZGVyPy4oYXR0cnMpfVxuICAgICAgICAgICAgPC9UaXBweVRvb2x0aXBDb250ZW50PlxuICAgICAgICAgICl9XG4gICAgICAgICAgb25Nb3VudD17b25Nb3VudH1cbiAgICAgICAgICBvbkhpZGU9e29uSGlkZX1cbiAgICAgICAgPlxuICAgICAgICAgIHtjaGlsZHJlbn1cbiAgICAgICAgPC9UaXBweT5cbiAgICAgICl9XG4gICAgPC9Sb290Q29udGV4dC5Db25zdW1lcj5cbiAgKTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IFRpcHB5VG9vbHRpcDtcbiJdfQ==